
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Many-body Hamiltonians, basic linear algebra and Second Quantization &#8212; Advanced Topics in Computational Physics</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Hartree-Fock methods" href="hartreefocktheory.html" />
    <link rel="prev" title="Textbooks and practicalities" href="textbooks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Advanced Topics in Computational Physics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Advanced Topics in Computational Physics: Computational Quantum Mechanics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About the course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="teachers.html">
   Instructor information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="textbooks.html">
   Textbooks and practicalities
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic Many-Body Physics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Many-body Hamiltonians, basic linear algebra and Second Quantization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hartreefocktheory.html">
   2. Hartree-Fock methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fcitheory.html">
   3. Full configuration interaction theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mbpt.html">
   4. Many-body perturbation theory
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Stochastic Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vmcdmc.html">
   5. Variational Monte Carlo methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gradientmethods.html">
   6. Gradient Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="resamplingmethods.html">
   7. Resampling Techniques, Bootstrap and Blocking
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computational Aspects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vectorization.html">
   8. Optimization and Vectorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parallelization.html">
   9. Parallelization with MPI and OpenMPI
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="linearregression.html">
   10. Linear Regression and more Advanced Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="logisticregression.html">
   11. Logistic Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="supportvectormachines.html">
   12. Support Vector Machines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neuralnetworks.html">
   13. Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boltzmannmachines.html">
   14. Boltzmann Machines
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Quantum Computing and Quantum Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="basicquantumcomputing.html">
   15. Quantum Computing
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/basicmanybody.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-notations">
   1.1. Definitions and notations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#brief-reminder-on-some-linear-algebra-properties">
     1.1.1. Brief reminder on some linear algebra properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#back-to-the-derivation-of-the-energy">
     1.1.2. Back to the derivation of the energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-for-later-studies-varying-the-coefficients-of-a-wave-function-expansion-and-orthogonal-transformations">
   1.2. Preparing for later studies: varying the coefficients of a wave function expansion and orthogonal transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-quantization">
   1.3. Second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-body-operators-in-second-quantization">
   1.4. One-body operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-body-operators-in-second-quantization">
   1.5. Two-body operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#particle-hole-formalism">
   1.6. Particle-hole formalism
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summarizing-and-defining-a-normal-ordered-hamiltonian">
   1.7. Summarizing and defining a normal-ordered Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operators-in-second-quantization">
   1.8. Operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-1-relation-between-basis-functions">
   1.9. Exercise 1: Relation between basis functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-2-matrix-elements">
   1.10. Exercise 2: Matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-3-normal-ordered-one-body-operator">
   1.11. Exercise 3: Normal-ordered one-body operator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-4-normal-ordered-two-body-operator">
   1.12. Exercise 4: Normal-ordered two-body operator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-5-matrix-elements-using-the-slater-condon-rule">
   1.13. Exercise 5: Matrix elements using the Slater-Condon rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-6-program-to-set-up-slater-determinants">
   1.14. Exercise 6: Program to set up Slater determinants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-7-using-sympy-to-compute-matrix-elements">
   1.15. Exercise 7: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-8-using-sympy-to-compute-matrix-elements">
   1.16. Exercise 8: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-9-using-sympy-to-compute-matrix-elements">
   1.17. Exercise 9: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-10-using-sympy-to-compute-matrix-elements">
   1.18. Exercise 10: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-11-using-sympy-to-compute-matrix-elements">
   1.19. Exercise 11: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-12-using-sympy-to-compute-matrix-elements">
   1.20. Exercise 12: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-13-using-sympy-to-compute-matrix-elements">
   1.21. Exercise 13: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations">
   1.22. Exercise 14: Diagrammatic representation of Hartree-Fock equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-15-derivation-of-hartree-fock-equations">
   1.23. Exercise 15: Derivation of Hartree-Fock equations
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Many-body Hamiltonians, basic linear algebra and Second Quantization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-notations">
   1.1. Definitions and notations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#brief-reminder-on-some-linear-algebra-properties">
     1.1.1. Brief reminder on some linear algebra properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#back-to-the-derivation-of-the-energy">
     1.1.2. Back to the derivation of the energy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-for-later-studies-varying-the-coefficients-of-a-wave-function-expansion-and-orthogonal-transformations">
   1.2. Preparing for later studies: varying the coefficients of a wave function expansion and orthogonal transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-quantization">
   1.3. Second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-body-operators-in-second-quantization">
   1.4. One-body operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-body-operators-in-second-quantization">
   1.5. Two-body operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#particle-hole-formalism">
   1.6. Particle-hole formalism
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summarizing-and-defining-a-normal-ordered-hamiltonian">
   1.7. Summarizing and defining a normal-ordered Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operators-in-second-quantization">
   1.8. Operators in second quantization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-1-relation-between-basis-functions">
   1.9. Exercise 1: Relation between basis functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-2-matrix-elements">
   1.10. Exercise 2: Matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-3-normal-ordered-one-body-operator">
   1.11. Exercise 3: Normal-ordered one-body operator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-4-normal-ordered-two-body-operator">
   1.12. Exercise 4: Normal-ordered two-body operator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-5-matrix-elements-using-the-slater-condon-rule">
   1.13. Exercise 5: Matrix elements using the Slater-Condon rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-6-program-to-set-up-slater-determinants">
   1.14. Exercise 6: Program to set up Slater determinants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-7-using-sympy-to-compute-matrix-elements">
   1.15. Exercise 7: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-8-using-sympy-to-compute-matrix-elements">
   1.16. Exercise 8: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-9-using-sympy-to-compute-matrix-elements">
   1.17. Exercise 9: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-10-using-sympy-to-compute-matrix-elements">
   1.18. Exercise 10: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-11-using-sympy-to-compute-matrix-elements">
   1.19. Exercise 11: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-12-using-sympy-to-compute-matrix-elements">
   1.20. Exercise 12: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-13-using-sympy-to-compute-matrix-elements">
   1.21. Exercise 13: Using sympy to compute matrix elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations">
   1.22. Exercise 14: Diagrammatic representation of Hartree-Fock equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-15-derivation-of-hartree-fock-equations">
   1.23. Exercise 15: Derivation of Hartree-Fock equations
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="many-body-hamiltonians-basic-linear-algebra-and-second-quantization">
<h1><span class="section-number">1. </span>Many-body Hamiltonians, basic linear algebra and Second Quantization<a class="headerlink" href="#many-body-hamiltonians-basic-linear-algebra-and-second-quantization" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definitions-and-notations">
<h2><span class="section-number">1.1. </span>Definitions and notations<a class="headerlink" href="#definitions-and-notations" title="Permalink to this headline">¶</a></h2>
<p>Before we proceed we need some definitions.
We will assume that the interacting part of the Hamiltonian
can be approximated by a two-body interaction.
This means that our Hamiltonian is written as the sum of some onebody part and a twobody part</p>
<!-- Equation labels as ordinary links -->
<div id="Hnuclei"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
    \hat{H} = \hat{H}_0 + \hat{H}_I 
    = \sum_{i=1}^A \hat{h}_0(x_i) + \sum_{i &lt; j}^A \hat{v}(r_{ij}),
\label{Hnuclei} \tag{1}
\end{equation}
\]</div>
<p>with</p>
<!-- Equation labels as ordinary links -->
<div id="hinuclei"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  H_0=\sum_{i=1}^A \hat{h}_0(x_i).
\label{hinuclei} \tag{2}
\end{equation}
\]</div>
<p>The onebody part <span class="math notranslate nohighlight">\(u_{\mathrm{ext}}(x_i)\)</span> is normally approximated by a harmonic oscillator potential or the Coulomb interaction an electron feels from the nucleus. However, other potentials are fully possible, such as
one derived from the self-consistent solution of the Hartree-Fock equations to be discussed here.</p>
<p>Our Hamiltonian is invariant under the permutation (interchange) of two particles.
Since we deal with fermions however, the total wave function is antisymmetric.
Let <span class="math notranslate nohighlight">\(\hat{P}\)</span> be an operator which interchanges two particles.
Due to the symmetries we have ascribed to our Hamiltonian, this operator commutes with the total Hamiltonian,</p>
<div class="math notranslate nohighlight">
\[
[\hat{H},\hat{P}] = 0,
\]</div>
<p>meaning that <span class="math notranslate nohighlight">\(\Psi_{\lambda}(x_1, x_2, \dots , x_A)\)</span> is an eigenfunction of
<span class="math notranslate nohighlight">\(\hat{P}\)</span> as well, that is</p>
<div class="math notranslate nohighlight">
\[
\hat{P}_{ij}\Psi_{\lambda}(x_1, x_2, \dots,x_i,\dots,x_j,\dots,x_A)=
\beta\Psi_{\lambda}(x_1, x_2, \dots,x_i,\dots,x_j,\dots,x_A),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the eigenvalue of <span class="math notranslate nohighlight">\(\hat{P}\)</span>. We have introduced the suffix <span class="math notranslate nohighlight">\(ij\)</span> in order to indicate that we permute particles <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>.
The Pauli principle tells us that the total wave function for a system of fermions
has to be antisymmetric, resulting in the eigenvalue <span class="math notranslate nohighlight">\(\beta = -1\)</span>.</p>
<p>In our case we assume that  we can approximate the exact eigenfunction with a Slater determinant</p>
<!-- Equation labels as ordinary links -->
<div id="eq:HartreeFockDet"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
   \Phi(x_1, x_2,\dots ,x_A,\alpha,\beta,\dots, \sigma)=\frac{1}{\sqrt{A!}}
\left| \begin{array}{ccccc} \psi_{\alpha}(x_1)&amp; \psi_{\alpha}(x_2)&amp; \dots &amp; \dots &amp; \psi_{\alpha}(x_A)\\
                            \psi_{\beta}(x_1)&amp;\psi_{\beta}(x_2)&amp; \dots &amp; \dots &amp; \psi_{\beta}(x_A)\\  
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                     \psi_{\sigma}(x_1)&amp;\psi_{\sigma}(x_2)&amp; \dots &amp; \dots &amp; \psi_{\sigma}(x_A)\end{array} \right|, \label{eq:HartreeFockDet} \tag{3}
\end{equation}
\end{split}\]</div>
<p>where  <span class="math notranslate nohighlight">\(x_i\)</span>  stand for the coordinates and spin values of a particle <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(\alpha,\beta,\dots, \gamma\)</span>
are quantum numbers needed to describe remaining quantum numbers.</p>
<div class="section" id="brief-reminder-on-some-linear-algebra-properties">
<h3><span class="section-number">1.1.1. </span>Brief reminder on some linear algebra properties<a class="headerlink" href="#brief-reminder-on-some-linear-algebra-properties" title="Permalink to this headline">¶</a></h3>
<p>Before we proceed with a more compact representation of a Slater determinant, we would like to repeat some linear algebra properties which will be useful for our derivations of the energy as function of a Slater determinant, Hartree-Fock theory and later the nuclear shell model.</p>
<p>The inverse of a matrix is defined by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}^{-1} \cdot \mathbf{A} = I
\]</div>
<p>A unitary matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is one whose inverse is its adjoint</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}^{-1}=\mathbf{A}^{\dagger}
\]</div>
<p>A real unitary matrix is called orthogonal and its inverse is equal to its transpose.
A hermitian matrix is its own self-adjoint, that  is</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}=\mathbf{A}^{\dagger}.
\]</div>
<table border="1">
<thead>
<tr><th align="center">              Relations               </th> <th align="center">      Name     </th> <th align="center">                            matrix elements                            </th> </tr>
</thead>
<tbody>
<tr><td align="center">   $A = A^{T}$                               </td> <td align="center">   symmetric          </td> <td align="center">   $a_{ij} = a_{ji}$                                                          </td> </tr>
<tr><td align="center">   $A = \left (A^{T} \right )^{-1}$          </td> <td align="center">   real orthogonal    </td> <td align="center">   $\sum_k a_{ik} a_{jk} = \sum_k a_{ki} a_{kj} = \delta_{ij}$                </td> </tr>
<tr><td align="center">   $A = A^{ * }$                             </td> <td align="center">   real matrix        </td> <td align="center">   $a_{ij} = a_{ij}^{ * }$                                                    </td> </tr>
<tr><td align="center">   $A = A^{\dagger}$                         </td> <td align="center">   hermitian          </td> <td align="center">   $a_{ij} = a_{ji}^{ * }$                                                    </td> </tr>
<tr><td align="center">   $A = \left (A^{\dagger} \right )^{-1}$    </td> <td align="center">   unitary            </td> <td align="center">   $\sum_k a_{ik} a_{jk}^{ * } = \sum_k a_{ki}^{ * } a_{kj} = \delta_{ij}$    </td> </tr>
</tbody>
</table>
<p>Since we will deal with Fermions (identical and indistinguishable particles) we will
form an ansatz for a given state in terms of so-called Slater determinants determined
by a chosen basis of single-particle functions.</p>
<p>For a given <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> we can write its determinant</p>
<div class="math notranslate nohighlight">
\[\begin{split}
det(\mathbf{A})=|\mathbf{A}|=
\left| \begin{array}{ccccc} a_{11}&amp; a_{12}&amp; \dots &amp; \dots &amp; a_{1n}\\
                            a_{21}&amp;a_{22}&amp; \dots &amp; \dots &amp; a_{2n}\\  
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                            a_{n1}&amp; a_{n2}&amp; \dots &amp; \dots &amp; a_{nn}\end{array} \right|,
\end{split}\]</div>
<p>in a more compact form as</p>
<div class="math notranslate nohighlight">
\[
|\mathbf{A}|= \sum_{i=1}^{n!}(-1)^{p_i}\hat{P}_i a_{11}a_{22}\dots a_{nn},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{P}_i\)</span> is a permutation operator which permutes the column indices <span class="math notranslate nohighlight">\(1,2,3,\dots,n\)</span>
and the sum runs over all <span class="math notranslate nohighlight">\(n!\)</span> permutations.  The quantity <span class="math notranslate nohighlight">\(p_i\)</span> represents the number of transpositions of column indices that are needed in order to bring a given permutation back to its initial ordering, in our case given by <span class="math notranslate nohighlight">\(a_{11}a_{22}\dots a_{nn}\)</span> here.</p>
<p>A simple <span class="math notranslate nohighlight">\(2\times 2\)</span> determinant illustrates this. We have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
det(\mathbf{A})=
\left| \begin{array}{cc} a_{11}&amp; a_{12}\\
                            a_{21}&amp;a_{22}\end{array} \right|= (-1)^0a_{11}a_{22}+(-1)^1a_{12}a_{21},
\end{split}\]</div>
<p>where in the last term we have interchanged the column indices <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span>. The natural ordering we have chosen is <span class="math notranslate nohighlight">\(a_{11}a_{22}\)</span>.</p>
</div>
<div class="section" id="back-to-the-derivation-of-the-energy">
<h3><span class="section-number">1.1.2. </span>Back to the derivation of the energy<a class="headerlink" href="#back-to-the-derivation-of-the-energy" title="Permalink to this headline">¶</a></h3>
<p>The single-particle function <span class="math notranslate nohighlight">\(\psi_{\alpha}(x_i)\)</span>  are eigenfunctions of the onebody
Hamiltonian <span class="math notranslate nohighlight">\(h_i\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[
\hat{h}_0(x_i)=\hat{t}(x_i) + \hat{u}_{\mathrm{ext}}(x_i),
\]</div>
<p>with eigenvalues</p>
<div class="math notranslate nohighlight">
\[
\hat{h}_0(x_i) \psi_{\alpha}(x_i)=\left(\hat{t}(x_i) + \hat{u}_{\mathrm{ext}}(x_i)\right)\psi_{\alpha}(x_i)=\varepsilon_{\alpha}\psi_{\alpha}(x_i).
\]</div>
<p>The energies <span class="math notranslate nohighlight">\(\varepsilon_{\alpha}\)</span> are the so-called non-interacting single-particle energies, or unperturbed energies.
The total energy is in this case the sum over all  single-particle energies, if no two-body or more complicated
many-body interactions are present.</p>
<p>Let us denote the ground state energy by <span class="math notranslate nohighlight">\(E_0\)</span>. According to the
variational principle we have</p>
<div class="math notranslate nohighlight">
\[
E_0 \le E[\Phi] = \int \Phi^*\hat{H}\Phi d\mathbf{\tau}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> is a trial function which we assume to be normalized</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\Phi d\mathbf{\tau} = 1,
\]</div>
<p>where we have used the shorthand <span class="math notranslate nohighlight">\(d\mathbf{\tau}=dx_1dr_2\dots dr_A\)</span>.</p>
<p>In the Hartree-Fock method the trial function is the Slater
determinant of Eq. (<a class="reference external" href="#eq:HartreeFockDet">3</a>) which can be rewritten as</p>
<div class="math notranslate nohighlight">
\[
\Phi(x_1,x_2,\dots,x_A,\alpha,\beta,\dots,\nu) = \frac{1}{\sqrt{A!}}\sum_{P} (-)^P\hat{P}\psi_{\alpha}(x_1)
    \psi_{\beta}(x_2)\dots\psi_{\nu}(x_A)=\sqrt{A!}\hat{A}\Phi_H,
\]</div>
<p>where we have introduced the antisymmetrization operator <span class="math notranslate nohighlight">\(\hat{A}\)</span> defined by the
summation over all possible permutations of two particles.</p>
<p>It is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="antiSymmetryOperator"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  \hat{A} = \frac{1}{A!}\sum_{p} (-)^p\hat{P},
\label{antiSymmetryOperator} \tag{4}
\end{equation}
\]</div>
<p>with <span class="math notranslate nohighlight">\(p\)</span> standing for the number of permutations. We have introduced for later use the so-called
Hartree-function, defined by the simple product of all possible single-particle functions</p>
<div class="math notranslate nohighlight">
\[
\Phi_H(x_1,x_2,\dots,x_A,\alpha,\beta,\dots,\nu) =
  \psi_{\alpha}(x_1)
    \psi_{\beta}(x_2)\dots\psi_{\nu}(x_A).
\]</div>
<p>Both <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> and <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> are invariant under all possible permutations of any two particles
and hence commute with <span class="math notranslate nohighlight">\(\hat{A}\)</span></p>
<!-- Equation labels as ordinary links -->
<div id="commutionAntiSym"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  [H_0,\hat{A}] = [H_I,\hat{A}] = 0. \label{commutionAntiSym} \tag{5}
\end{equation}
\]</div>
<p>Furthermore, <span class="math notranslate nohighlight">\(\hat{A}\)</span> satisfies</p>
<!-- Equation labels as ordinary links -->
<div id="AntiSymSquared"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  \hat{A}^2 = \hat{A},  \label{AntiSymSquared} \tag{6}
\end{equation}
\]</div>
<p>since every permutation of the Slater
determinant reproduces it.</p>
<p>The expectation value of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span></p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_0\Phi d\mathbf{\tau} 
  = A! \int \Phi_H^*\hat{A}\hat{H}_0\hat{A}\Phi_H d\mathbf{\tau}
\]</div>
<p>is readily reduced to</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_0\Phi d\mathbf{\tau} 
  = A! \int \Phi_H^*\hat{H}_0\hat{A}\Phi_H d\mathbf{\tau},
\]</div>
<p>where we have used Eqs. (<a class="reference external" href="#commutionAntiSym">5</a>) and
(<a class="reference external" href="#AntiSymSquared">6</a>). The next step is to replace the antisymmetrization
operator by its definition and to
replace <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> with the sum of one-body operators</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_0\Phi  d\mathbf{\tau}
  = \sum_{i=1}^A \sum_{p} (-)^p\int 
  \Phi_H^*\hat{h}_0\hat{P}\Phi_H d\mathbf{\tau}.
\]</div>
<p>The integral vanishes if two or more particles are permuted in only one
of the Hartree-functions <span class="math notranslate nohighlight">\(\Phi_H\)</span> because the individual single-particle wave functions are
orthogonal. We obtain then</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_0\Phi  d\mathbf{\tau}= \sum_{i=1}^A \int \Phi_H^*\hat{h}_0\Phi_H  d\mathbf{\tau}.
\]</div>
<p>Orthogonality of the single-particle functions allows us to further simplify the integral, and we
arrive at the following expression for the expectation values of the
sum of one-body Hamiltonians</p>
<!-- Equation labels as ordinary links -->
<div id="H1Expectation"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  \int \Phi^*\hat{H}_0\Phi  d\mathbf{\tau}
  = \sum_{\mu=1}^A \int \psi_{\mu}^*(x)\hat{h}_0\psi_{\mu}(x)dx
  d\mathbf{r}.
\label{H1Expectation} \tag{7}
\end{equation}
\]</div>
<p>We introduce the following shorthand for the above integral</p>
<div class="math notranslate nohighlight">
\[
\langle \mu | \hat{h}_0 | \mu \rangle = \int \psi_{\mu}^*(x)\hat{h}_0\psi_{\mu}(x)dx,
\]</div>
<p>and rewrite Eq. (<a class="reference external" href="#H1Expectation">7</a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="H1Expectation1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  \int \Phi^*\hat{H}_0\Phi  d\tau
  = \sum_{\mu=1}^A \langle \mu | \hat{h}_0 | \mu \rangle.
\label{H1Expectation1} \tag{8}
\end{equation}
\]</div>
<p>The expectation value of the two-body part of the Hamiltonian is obtained in a
similar manner. We have</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_I\Phi d\mathbf{\tau} 
  = A! \int \Phi_H^*\hat{A}\hat{H}_I\hat{A}\Phi_H d\mathbf{\tau},
\]</div>
<p>which reduces to</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_I\Phi d\mathbf{\tau} 
  = \sum_{i\le j=1}^A \sum_{p} (-)^p\int 
  \Phi_H^*\hat{v}(r_{ij})\hat{P}\Phi_H d\mathbf{\tau},
\]</div>
<p>by following the same arguments as for the one-body
Hamiltonian.</p>
<p>Because of the dependence on the inter-particle distance <span class="math notranslate nohighlight">\(r_{ij}\)</span>,  permutations of
any two particles no longer vanish, and we get</p>
<div class="math notranslate nohighlight">
\[
\int \Phi^*\hat{H}_I\Phi d\mathbf{\tau} 
  = \sum_{i &lt; j=1}^A \int  
  \Phi_H^*\hat{v}(r_{ij})(1-P_{ij})\Phi_H d\mathbf{\tau}.
\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{ij}\)</span> is the permutation operator that interchanges
particle <span class="math notranslate nohighlight">\(i\)</span> and particle <span class="math notranslate nohighlight">\(j\)</span>. Again we use the assumption that the single-particle wave functions
are orthogonal.</p>
<p>We obtain</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  \int \Phi^*\hat{H}_I\Phi d\mathbf{\tau} 
  = \frac{1}{2}\sum_{\mu=1}^A\sum_{\nu=1}^A
    \left[ \int \psi_{\mu}^*(x_i)\psi_{\nu}^*(x_j)\hat{v}(r_{ij})\psi_{\mu}(x_i)\psi_{\nu}(x_j)
    dx_idx_j \right.
\label{_auto1} \tag{9}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="H2Expectation"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
  \left.
  - \int \psi_{\mu}^*(x_i)\psi_{\nu}^*(x_j)
  \hat{v}(r_{ij})\psi_{\nu}(x_i)\psi_{\mu}(x_j)
  dx_idx_j
  \right]. \label{H2Expectation} \tag{10}
\end{equation}
\]</div>
<p>The first term is the so-called direct term. It is frequently also called the  Hartree term,
while the second is due to the Pauli principle and is called
the exchange term or just the Fock term.
The factor  <span class="math notranslate nohighlight">\(1/2\)</span> is introduced because we now run over
all pairs twice.</p>
<p>The last equation allows us to  introduce some further definitions.<br />
The single-particle wave functions <span class="math notranslate nohighlight">\(\psi_{\mu}(x)\)</span>, defined by the quantum numbers <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(x\)</span>
are defined as the overlap</p>
<div class="math notranslate nohighlight">
\[
\psi_{\alpha}(x)  = \langle x | \alpha \rangle .
\]</div>
<p>We introduce the following shorthands for the above two integrals</p>
<div class="math notranslate nohighlight">
\[
\langle \mu\nu|\hat{v}|\mu\nu\rangle =  \int \psi_{\mu}^*(x_i)\psi_{\nu}^*(x_j)\hat{v}(r_{ij})\psi_{\mu}(x_i)\psi_{\nu}(x_j)
    dx_idx_j,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \mu\nu|\hat{v}|\nu\mu\rangle = \int \psi_{\mu}^*(x_i)\psi_{\nu}^*(x_j)
  \hat{v}(r_{ij})\psi_{\nu}(x_i)\psi_{\mu}(x_j)
  dx_idx_j.
\]</div>
</div>
</div>
<div class="section" id="preparing-for-later-studies-varying-the-coefficients-of-a-wave-function-expansion-and-orthogonal-transformations">
<h2><span class="section-number">1.2. </span>Preparing for later studies: varying the coefficients of a wave function expansion and orthogonal transformations<a class="headerlink" href="#preparing-for-later-studies-varying-the-coefficients-of-a-wave-function-expansion-and-orthogonal-transformations" title="Permalink to this headline">¶</a></h2>
<p>It is common to  expand the single-particle functions in a known basis  and vary the coefficients,
that is, the new single-particle wave function is written as a linear expansion
in terms of a fixed chosen orthogonal basis (for example the well-known harmonic oscillator functions or the hydrogen-like functions etc).
We define our new single-particle basis (this is a normal approach for Hartree-Fock theory) by performing a unitary transformation
on our previous basis (labelled with greek indices) as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:newbasis"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\psi_p^{new}  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda}. \label{eq:newbasis} \tag{11}
\end{equation}
\]</div>
<p>In this case we vary the coefficients <span class="math notranslate nohighlight">\(C_{p\lambda}\)</span>. If the basis has infinitely many solutions, we need
to truncate the above sum.  We assume that the basis <span class="math notranslate nohighlight">\(\phi_{\lambda}\)</span> is orthogonal.</p>
<p>It is normal to choose a single-particle basis defined as the eigenfunctions
of parts of the full Hamiltonian. The typical situation consists of the solutions of the one-body part of the Hamiltonian, that is we have</p>
<div class="math notranslate nohighlight">
\[
\hat{h}_0\phi_{\lambda}=\epsilon_{\lambda}\phi_{\lambda}.
\]</div>
<p>The single-particle wave functions <span class="math notranslate nohighlight">\(\phi_{\lambda}(\mathbf{r})\)</span>, defined by the quantum numbers <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}\)</span>
are defined as the overlap</p>
<div class="math notranslate nohighlight">
\[
\phi_{\lambda}(\mathbf{r})  = \langle \mathbf{r} | \lambda \rangle .
\]</div>
<p>In deriving the Hartree-Fock equations, we  will expand the single-particle functions in a known basis  and vary the coefficients,
that is, the new single-particle wave function is written as a linear expansion
in terms of a fixed chosen orthogonal basis (for example the well-known harmonic oscillator functions or the hydrogen-like functions etc).</p>
<p>We stated that a unitary transformation keeps the orthogonality. To see this consider first a basis of vectors <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{v}_i = \begin{bmatrix} v_{i1} \\ \dots \\ \dots \\v_{in} \end{bmatrix}
\end{split}\]</div>
<p>We assume that the basis is orthogonal, that is</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_j^T\mathbf{v}_i = \delta_{ij}.
\]</div>
<p>An orthogonal or unitary transformation</p>
<div class="math notranslate nohighlight">
\[
\mathbf{w}_i=\mathbf{U}\mathbf{v}_i,
\]</div>
<p>preserves the dot product and orthogonality since</p>
<div class="math notranslate nohighlight">
\[
\mathbf{w}_j^T\mathbf{w}_i=(\mathbf{U}\mathbf{v}_j)^T\mathbf{U}\mathbf{v}_i=\mathbf{v}_j^T\mathbf{U}^T\mathbf{U}\mathbf{v}_i= \mathbf{v}_j^T\mathbf{v}_i = \delta_{ij}.
\]</div>
<p>This means that if the coefficients <span class="math notranslate nohighlight">\(C_{p\lambda}\)</span> belong to a unitary or orthogonal trasformation (using the Dirac bra-ket notation)</p>
<div class="math notranslate nohighlight">
\[
\vert p\rangle  = \sum_{\lambda} C_{p\lambda}\vert\lambda\rangle,
\]</div>
<p>orthogonality is preserved, that is <span class="math notranslate nohighlight">\(\langle \alpha \vert \beta\rangle = \delta_{\alpha\beta}\)</span>
and <span class="math notranslate nohighlight">\(\langle p \vert q\rangle = \delta_{pq}\)</span>.</p>
<p>This propertry is extremely useful when we build up a basis of many-body Stater determinant based states.</p>
<p><strong>Note also that although a basis <span class="math notranslate nohighlight">\(\vert \alpha\rangle\)</span> contains an infinity of states, for practical calculations we have always to make some truncations.</strong></p>
<p>Before we develop for example the Hartree-Fock equations, there is another very useful property of determinants that we will use both in connection with Hartree-Fock calculations and later shell-model calculations.</p>
<p>Consider the following determinant</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left| \begin{array}{cc} \alpha_1b_{11}+\alpha_2sb_{12}&amp; a_{12}\\
                         \alpha_1b_{21}+\alpha_2b_{22}&amp;a_{22}\end{array} \right|=\alpha_1\left|\begin{array}{cc} b_{11}&amp; a_{12}\\
                         b_{21}&amp;a_{22}\end{array} \right|+\alpha_2\left| \begin{array}{cc} b_{12}&amp; a_{12}\\b_{22}&amp;a_{22}\end{array} \right|
\end{split}\]</div>
<p>We can generalize this to  an <span class="math notranslate nohighlight">\(n\times n\)</span> matrix and have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left| \begin{array}{cccccc} a_{11}&amp; a_{12} &amp; \dots &amp; \sum_{k=1}^n c_k b_{1k} &amp;\dots &amp; a_{1n}\\
a_{21}&amp; a_{22} &amp; \dots &amp; \sum_{k=1}^n c_k b_{2k} &amp;\dots &amp; a_{2n}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
a_{n1}&amp; a_{n2} &amp; \dots &amp; \sum_{k=1}^n c_k b_{nk} &amp;\dots &amp; a_{nn}\end{array} \right|=
\sum_{k=1}^n c_k\left| \begin{array}{cccccc} a_{11}&amp; a_{12} &amp; \dots &amp;  b_{1k} &amp;\dots &amp; a_{1n}\\
a_{21}&amp; a_{22} &amp; \dots &amp;  b_{2k} &amp;\dots &amp; a_{2n}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots\\
a_{n1}&amp; a_{n2} &amp; \dots &amp;  b_{nk} &amp;\dots &amp; a_{nn}\end{array} \right| .
\end{split}\]</div>
<p>This is a property we will use in our Hartree-Fock discussions.</p>
<p>We can generalize the previous results, now
with all elements <span class="math notranslate nohighlight">\(a_{ij}\)</span>  being given as functions of
linear combinations  of various coefficients <span class="math notranslate nohighlight">\(c\)</span> and elements <span class="math notranslate nohighlight">\(b_{ij}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left| \begin{array}{cccccc} \sum_{k=1}^n b_{1k}c_{k1}&amp; \sum_{k=1}^n b_{1k}c_{k2} &amp; \dots &amp; \sum_{k=1}^n b_{1k}c_{kj}  &amp;\dots &amp; \sum_{k=1}^n b_{1k}c_{kn}\\
\sum_{k=1}^n b_{2k}c_{k1}&amp; \sum_{k=1}^n b_{2k}c_{k2} &amp; \dots &amp; \sum_{k=1}^n b_{2k}c_{kj} &amp;\dots &amp; \sum_{k=1}^n b_{2k}c_{kn}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp;\dots \\
\sum_{k=1}^n b_{nk}c_{k1}&amp; \sum_{k=1}^n b_{nk}c_{k2} &amp; \dots &amp; \sum_{k=1}^n b_{nk}c_{kj} &amp;\dots &amp; \sum_{k=1}^n b_{nk}c_{kn}\end{array} \right|=det(\mathbf{C})det(\mathbf{B}),
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(det(\mathbf{C})\)</span> and <span class="math notranslate nohighlight">\(det(\mathbf{B})\)</span> are the determinants of <span class="math notranslate nohighlight">\(n\times n\)</span> matrices
with elements <span class="math notranslate nohighlight">\(c_{ij}\)</span> and <span class="math notranslate nohighlight">\(b_{ij}\)</span> respectively.<br />
This is a property we will use in our Hartree-Fock discussions. Convince yourself about the correctness of the above expression by setting <span class="math notranslate nohighlight">\(n=2\)</span>.</p>
<p>With our definition of the new basis in terms of an orthogonal basis we have</p>
<div class="math notranslate nohighlight">
\[
\psi_p(x)  = \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x).
\]</div>
<p>If the coefficients <span class="math notranslate nohighlight">\(C_{p\lambda}\)</span> belong to an orthogonal or unitary matrix, the new basis
is also orthogonal.
Our Slater determinant in the new basis <span class="math notranslate nohighlight">\(\psi_p(x)\)</span> is written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{1}{\sqrt{A!}}
\left| \begin{array}{ccccc} \psi_{p}(x_1)&amp; \psi_{p}(x_2)&amp; \dots &amp; \dots &amp; \psi_{p}(x_A)\\
                            \psi_{q}(x_1)&amp;\psi_{q}(x_2)&amp; \dots &amp; \dots &amp; \psi_{q}(x_A)\\  
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                     \psi_{t}(x_1)&amp;\psi_{t}(x_2)&amp; \dots &amp; \dots &amp; \psi_{t}(x_A)\end{array} \right|=\frac{1}{\sqrt{A!}}
\left| \begin{array}{ccccc} \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_1)&amp; \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_2)&amp; \dots &amp; \dots &amp; \sum_{\lambda} C_{p\lambda}\phi_{\lambda}(x_A)\\
                            \sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_1)&amp;\sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_2)&amp; \dots &amp; \dots &amp; \sum_{\lambda} C_{q\lambda}\phi_{\lambda}(x_A)\\  
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                            \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
                     \sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_1)&amp;\sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_2)&amp; \dots &amp; \dots &amp; \sum_{\lambda} C_{t\lambda}\phi_{\lambda}(x_A)\end{array} \right|,
\end{split}\]</div>
<p>which is nothing but <span class="math notranslate nohighlight">\(det(\mathbf{C})det(\Phi)\)</span>, with <span class="math notranslate nohighlight">\(det(\Phi)\)</span> being the determinant given by the basis functions <span class="math notranslate nohighlight">\(\phi_{\lambda}(x)\)</span>.</p>
<p>In our discussions hereafter we will use our definitions of single-particle states above and below the Fermi (<span class="math notranslate nohighlight">\(F\)</span>) level given by the labels
<span class="math notranslate nohighlight">\(ijkl\dots \le F\)</span> for so-called single-hole states and <span class="math notranslate nohighlight">\(abcd\dots &gt; F\)</span> for so-called particle states.
For general single-particle states we employ the labels <span class="math notranslate nohighlight">\(pqrs\dots\)</span>.</p>
<p>The energy functional is</p>
<div class="math notranslate nohighlight">
\[
E[\Phi] 
  = \sum_{\mu=1}^A \langle \mu | h | \mu \rangle +
  \frac{1}{2}\sum_{{\mu}=1}^A\sum_{{\nu}=1}^A \langle \mu\nu|\hat{v}|\mu\nu\rangle_{AS},
\]</div>
<p>we found the expression for the energy functional in terms of the basis function <span class="math notranslate nohighlight">\(\phi_{\lambda}(\mathbf{r})\)</span>. We then  varied the above energy functional with respect to the basis functions <span class="math notranslate nohighlight">\(|\mu \rangle\)</span>.
Now we are interested in defining a new basis defined in terms of
a chosen basis as defined in Eq. (<a class="reference external" href="#eq:newbasis">11</a>). We can then rewrite the energy functional as</p>
<!-- Equation labels as ordinary links -->
<div id="FunctionalEPhi2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  E[\Phi^{New}] 
  = \sum_{i=1}^A \langle i | h | i \rangle +
  \frac{1}{2}\sum_{ij=1}^A\langle ij|\hat{v}|ij\rangle_{AS}, \label{FunctionalEPhi2} \tag{12}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi^{New}\)</span> is the new Slater determinant defined by the new basis of Eq. (<a class="reference external" href="#eq:newbasis">11</a>).</p>
<p>Using Eq. (<a class="reference external" href="#eq:newbasis">11</a>) we can rewrite Eq. (<a class="reference external" href="#FunctionalEPhi2">12</a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="FunctionalEPhi3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  E[\Psi] 
  = \sum_{i=1}^A \sum_{\alpha\beta} C^*_{i\alpha}C_{i\beta}\langle \alpha | h | \beta \rangle +
  \frac{1}{2}\sum_{ij=1}^A\sum_{{\alpha\beta\gamma\delta}} C^*_{i\alpha}C^*_{j\beta}C_{i\gamma}C_{j\delta}\langle \alpha\beta|\hat{v}|\gamma\delta\rangle_{AS}. \label{FunctionalEPhi3} \tag{13}
\end{equation}
\]</div>
</div>
<div class="section" id="second-quantization">
<h2><span class="section-number">1.3. </span>Second quantization<a class="headerlink" href="#second-quantization" title="Permalink to this headline">¶</a></h2>
<p>We introduce the time-independent  operators
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> and <span class="math notranslate nohighlight">\(a_\alpha\)</span>   which create and annihilate, respectively, a particle
in the single-particle state
<span class="math notranslate nohighlight">\(\varphi_\alpha\)</span>.
We define the fermion creation operator
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span></p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-1a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle  \label{eq:2-1a} \tag{14},
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-1b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-1b} \tag{15}
\end{equation}
\]</div>
<p>In Eq. (<a class="reference external" href="#eq:2-1a">14</a>)
the operator  <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span>  acts on the vacuum state
<span class="math notranslate nohighlight">\(|0\rangle\)</span>, which does not contain any particles. Alternatively, we could define  a closed-shell nucleus or atom as our new vacuum, but then
we need to introduce the particle-hole  formalism, see the discussion to come.</p>
<p>In Eq. (<a class="reference external" href="#eq:2-1b">15</a>) <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> acts on an antisymmetric <span class="math notranslate nohighlight">\(n\)</span>-particle state and
creates an antisymmetric <span class="math notranslate nohighlight">\((n+1)\)</span>-particle state, where the one-body state
<span class="math notranslate nohighlight">\(\varphi_\alpha\)</span> is occupied, under the condition that
<span class="math notranslate nohighlight">\(\alpha \ne \alpha_1, \alpha_2, \dots, \alpha_n\)</span>.
It follows that we can express an antisymmetric state as the product of the creation
operators acting on the vacuum state.</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle \label{eq:2-2} \tag{16}
\end{equation}
\]</div>
<p>It is easy to derive the commutation and anticommutation rules  for the fermionic creation operators
<span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span>. Using the antisymmetry of the states
(<a class="reference external" href="#eq:2-2">16</a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-3a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_k\dots \alpha_n\rangle_{\mathrm{AS}} = 
		- |\alpha_1\dots \alpha_k\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-3a} \tag{17}
\end{equation}
\]</div>
<p>we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-3b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	 a_{\alpha_i}^{\dagger}  a_{\alpha_k}^{\dagger} = - a_{\alpha_k}^{\dagger} a_{\alpha_i}^{\dagger} \label{eq:2-3b} \tag{18}
\end{equation}
\]</div>
<p>Using the Pauli principle</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-4a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} = 0 \label{eq:2-4a} \tag{19}
\end{equation}
\]</div>
<p>it follows that</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-4b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha_i}^{\dagger}  a_{\alpha_i}^{\dagger} = 0. \label{eq:2-4b} \tag{20}
\end{equation}
\]</div>
<p>If we combine Eqs. (<a class="reference external" href="#eq:2-3b">18</a>) and (<a class="reference external" href="#eq:2-4b">20</a>), we obtain the well-known anti-commutation rule</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha}^{\dagger}  a_{\beta}^{\dagger} + a_{\beta}^{\dagger}  a_{\alpha}^{\dagger} \equiv 
		\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = 0 \label{eq:2-5} \tag{21}
\end{equation}
\]</div>
<p>The hermitian conjugate  of <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger} \label{eq:2-6} \tag{22}
\end{equation}
\]</div>
<p>If we take the hermitian conjugate of Eq. (<a class="reference external" href="#eq:2-5">21</a>), we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_{\alpha},a_{\beta}\} = 0 \label{eq:2-7} \tag{23}
\end{equation}
\]</div>
<p>What is the physical interpretation of the operator <span class="math notranslate nohighlight">\(a_\alpha\)</span> and what is the effect of
<span class="math notranslate nohighlight">\(a_\alpha\)</span> on a given state <span class="math notranslate nohighlight">\(|\alpha_1\alpha_2\dots\alpha_n\rangle_{\mathrm{AS}}\)</span>?
Consider the following matrix element</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-8} \tag{24}
\end{equation}
\]</div>
<p>where both sides are antisymmetric. We  distinguish between two cases. The first (1) is when
<span class="math notranslate nohighlight">\(\alpha \in \{\alpha_i\}\)</span>. Using the Pauli principle of Eq. (<a class="reference external" href="#eq:2-4a">19</a>) it follows</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-9a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
		\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha = 0 \label{eq:2-9a} \tag{25}
\end{equation}
\]</div>
<p>The second (2) case is when <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i\}\)</span>. It follows that an hermitian conjugation</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-9b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
		\langle \alpha_1\alpha_2 \dots \alpha_n|a_\alpha = \langle\alpha\alpha_1\alpha_2 \dots \alpha_n|  \label{eq:2-9b} \tag{26}
\end{equation}
\]</div>
<p>Eq. (<a class="reference external" href="#eq:2-9b">26</a>) holds for case (1) since the lefthand side is zero due to the Pauli principle. We write
Eq. (<a class="reference external" href="#eq:2-8">24</a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle = 
	\langle \alpha_1\alpha_2 \dots \alpha_n|\alpha\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-10} \tag{27}
\end{equation}
\]</div>
<p>Here we must have <span class="math notranslate nohighlight">\(m = n+1\)</span> if Eq. (<a class="reference external" href="#eq:2-10">27</a>) has to be trivially different from zero.</p>
<p>For the last case, the minus and plus signs apply when the sequence
<span class="math notranslate nohighlight">\(\alpha ,\alpha_1, \alpha_2, \dots, \alpha_n\)</span> and
<span class="math notranslate nohighlight">\(\alpha_1', \alpha_2', \dots, \alpha_{n+1}'\)</span> are related to each other via even and odd permutations.
If we assume that  <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i\}\)</span> we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_{n+1}'\rangle = 0 \label{eq:2-12} \tag{28}
\end{equation}
\]</div>
<p>when <span class="math notranslate nohighlight">\(\alpha \in \{\alpha_i'\}\)</span>. If <span class="math notranslate nohighlight">\(\alpha \notin \{\alpha_i'\}\)</span>, we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-13a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0 \label{eq:2-13a} \tag{29}
\end{equation}
\]</div>
<p>and in particular</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-13b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |0\rangle = 0 \label{eq:2-13b} \tag{30}
\end{equation}
\]</div>
<p>If <span class="math notranslate nohighlight">\(\{\alpha\alpha_i\} = \{\alpha_i'\}\)</span>, performing the right permutations, the sequence
<span class="math notranslate nohighlight">\(\alpha ,\alpha_1, \alpha_2, \dots, \alpha_n\)</span> is identical with the sequence
<span class="math notranslate nohighlight">\(\alpha_1', \alpha_2', \dots, \alpha_{n+1}'\)</span>. This results in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 1 \label{eq:2-14} \tag{31}
\end{equation}
\]</div>
<p>and thus</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-15} \tag{32}
\end{equation}
\]</div>
<p>The action of the operator
<span class="math notranslate nohighlight">\(a_\alpha\)</span> from the left on a state vector  is to to remove  one particle in the state
<span class="math notranslate nohighlight">\(\alpha\)</span>.
If the state vector does not contain the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span>, the outcome of the operation is zero.
The operator  <span class="math notranslate nohighlight">\(a_\alpha\)</span> is normally called for a destruction or annihilation operator.</p>
<p>The next step is to establish the  commutator algebra of <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> and
<span class="math notranslate nohighlight">\(a_\beta\)</span>.</p>
<p>The action of the anti-commutator
<span class="math notranslate nohighlight">\(\{a_\alpha^{\dagger}\)</span>,<span class="math notranslate nohighlight">\(a_\alpha\}\)</span> on a given <span class="math notranslate nohighlight">\(n\)</span>-particle state is</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\alpha \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-16a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\alpha a_\alpha^{\dagger} \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} =
	a_\alpha \underbrace{|\alpha \alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} = 
	\underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} \label{eq:2-16a} \tag{33}
\end{equation}
\]</div>
<p>if the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span> is not contained in the state.</p>
<p>If it is present
we arrive at</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle =
	a_\alpha^{\dagger} a_\alpha (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle =
	|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-16b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\alpha a_\alpha^{\dagger}|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle = 0 \label{eq:2-16b} \tag{34}
\end{equation}
\]</div>
<p>From Eqs. (<a class="reference external" href="#eq:2-16a">33</a>) and  (<a class="reference external" href="#eq:2-16b">34</a>) we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger} , a_\alpha \} = a_\alpha^{\dagger} a_\alpha + a_\alpha a_\alpha^{\dagger} = 1 \label{eq:2-17} \tag{35}
\end{equation}
\]</div>
<p>The action of <span class="math notranslate nohighlight">\(\left\{a_\alpha^{\dagger}, a_\beta\right\}\)</span>, with
<span class="math notranslate nohighlight">\(\alpha \ne \beta\)</span> on a given state yields three possibilities.
The first case is a state vector which contains both <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, then either
<span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span> and finally none of them.</p>
<p>The first case results in</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\beta a_\alpha^{\dagger} |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \label{eq:2-18a} \tag{36}
\end{equation}
\]</div>
<p>while the second case gives</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle = 
	 	|\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq  \alpha}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
a_\beta a_\alpha^{\dagger} |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle =
		a_\beta |\alpha\beta\underbrace{\beta \alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= - |\alpha\underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \label{eq:2-18b} \tag{37}
\end{equation}
\]</div>
<p>Finally if the state vector does not contain <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span></p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger} a_\beta |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-18c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	a_\beta a_\alpha^{\dagger} |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 
		a_\beta |\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 0 \label{eq:2-18c} \tag{38}
\end{equation}
\]</div>
<p>For all three cases we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-19"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = a_\alpha^{\dagger} a_\beta + a_\beta a_\alpha^{\dagger} = 0, \quad \alpha \neq \beta \label{eq:2-19} \tag{39}
\end{equation}
\]</div>
<p>We can summarize  our findings in Eqs. (<a class="reference external" href="#eq:2-17">35</a>) and (<a class="reference external" href="#eq:2-19">39</a>) as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-20"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta} \label{eq:2-20} \tag{40}
\end{equation}
\]</div>
<p>with  <span class="math notranslate nohighlight">\(\delta_{\alpha\beta}\)</span> is the Kroenecker <span class="math notranslate nohighlight">\(\delta\)</span>-symbol.</p>
<p>The properties of the creation and annihilation operators can be summarized as (for fermions)</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}}.
\]</div>
<p>from which follows</p>
<div class="math notranslate nohighlight">
\[
|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>The hermitian conjugate has the folowing properties</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger}.
\]</div>
<p>Finally we found</p>
<div class="math notranslate nohighlight">
\[
a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0, \quad
		\textrm{in particular } a_\alpha |0\rangle = 0,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle,
\]</div>
<p>and the corresponding commutator algebra</p>
<div class="math notranslate nohighlight">
\[
\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = \{a_{\alpha},a_{\beta}\} = 0 \hspace{0.5cm} 
\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta}.
\]</div>
</div>
<div class="section" id="one-body-operators-in-second-quantization">
<h2><span class="section-number">1.4. </span>One-body operators in second quantization<a class="headerlink" href="#one-body-operators-in-second-quantization" title="Permalink to this headline">¶</a></h2>
<p>A very useful operator is the so-called number-operator.  Most physics cases  we will
study in this text conserve the total number of particles.  The number operator is therefore
a useful quantity which allows us to test that our many-body formalism  conserves the number of particles.
In for example <span class="math notranslate nohighlight">\((d,p)\)</span> or <span class="math notranslate nohighlight">\((p,d)\)</span> reactions it is important to be able to describe quantum mechanical states
where particles get added or removed.
A creation operator <span class="math notranslate nohighlight">\(a_\alpha^{\dagger}\)</span> adds one particle to the single-particle state
<span class="math notranslate nohighlight">\(\alpha\)</span> of a give many-body state vector, while an annihilation operator <span class="math notranslate nohighlight">\(a_\alpha\)</span>
removes a particle from a single-particle
state <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Let us consider an operator proportional with <span class="math notranslate nohighlight">\(a_\alpha^{\dagger} a_\beta\)</span> and
<span class="math notranslate nohighlight">\(\alpha=\beta\)</span>. It acts on an <span class="math notranslate nohighlight">\(n\)</span>-particle state
resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	\begin{cases}
		0  &amp;\alpha \notin \{\alpha_i\} \\
		\\
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle &amp; \alpha \in \{\alpha_i\}
	\end{cases}
\label{_auto2} \tag{41}
\end{equation}
\end{split}\]</div>
<p>Summing over all possible one-particle states we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-21"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\left( \sum_\alpha a_\alpha^{\dagger} a_\alpha \right) |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	n |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-21} \tag{42}
\end{equation}
\]</div>
<p>The operator</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-22"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^{\dagger} a_\alpha \label{eq:2-22} \tag{43}
\end{equation}
\]</div>
<p>is called the number operator since it counts the number of particles in a give state vector when it acts
on the different single-particle states.  It acts on one single-particle state at the time and falls
therefore under category one-body operators.
Next we look at another important one-body operator, namely <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> and study its operator form in the
occupation number representation.</p>
<p>We want to obtain an expression for a one-body operator which conserves the number of particles.
Here we study the one-body operator for the kinetic energy plus an eventual external one-body potential.
The action of this operator on a particular <span class="math notranslate nohighlight">\(n\)</span>-body state with its pertinent expectation value has already
been studied in coordinate  space.
In coordinate space the operator reads</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-23"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_0 = \sum_i \hat{h}_0(x_i) \label{eq:2-23} \tag{44}
\end{equation}
\]</div>
<p>and the anti-symmetric <span class="math notranslate nohighlight">\(n\)</span>-particle Slater determinant is defined as</p>
<div class="math notranslate nohighlight">
\[
\Phi(x_1, x_2,\dots ,x_n,\alpha_1,\alpha_2,\dots, \alpha_n)= \frac{1}{\sqrt{n!}} \sum_p (-1)^p\hat{P}\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n).
\]</div>
<p>Defining</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-25"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{h}_0(x_i) \psi_{\alpha_i}(x_i) = \sum_{\alpha_k'} \psi_{\alpha_k'}(x_i) \langle\alpha_k'|\hat{h}_0|\alpha_k\rangle \label{eq:2-25} \tag{45}
\end{equation}
\]</div>
<p>we can easily  evaluate the action of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> on each product of one-particle functions in Slater determinant.
From Eq. (<a class="reference external" href="#eq:2-25">45</a>)  we obtain the following result without  permuting any particle pair</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
=\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle 
		\psi_{\alpha_1'}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2'}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-26"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-26} \tag{46}
\end{equation}
\]</div>
<p>If we interchange particles <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span>  we obtain</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
=\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle 
		\psi_{\alpha_1}(x_2)\psi_{\alpha_2'}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		\psi_{\alpha_1'}(x_2)\psi_{\alpha_2}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-27"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-27} \tag{47}
\end{equation}
\]</div>
<p>We can continue by computing all possible permutations.
We rewrite also our Slater determinant in its second quantized form and skip the dependence on the quantum numbers <span class="math notranslate nohighlight">\(x_i.\)</span>
Summing up all contributions and taking care of all phases
<span class="math notranslate nohighlight">\((-1)^p\)</span> we arrive at</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0|\alpha_1,\alpha_2,\dots, \alpha_n\rangle = \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		|\alpha_1'\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		|\alpha_1\alpha_2' \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-28"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		|\alpha_1\alpha_2 \dots \alpha_{n}'\rangle \label{eq:2-28} \tag{48}
\end{equation}
\]</div>
<p>In Eq. (<a class="reference external" href="#eq:2-28">48</a>)
we have expressed the action of the one-body operator
of Eq. (<a class="reference external" href="#eq:2-23">44</a>) on the  <span class="math notranslate nohighlight">\(n\)</span>-body state in its second quantized form.
This equation can be further manipulated if we use the properties of the creation and annihilation operator
on each primed quantum number, that is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-29"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\alpha_2 \dots \alpha_k' \dots \alpha_{n}\rangle = 
		a_{\alpha_k'}^{\dagger}  a_{\alpha_k} |\alpha_1\alpha_2 \dots \alpha_k \dots \alpha_{n}\rangle \label{eq:2-29} \tag{49}
\end{equation}
\]</div>
<p>Inserting this in the right-hand side of Eq. (<a class="reference external" href="#eq:2-28">48</a>) results in</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0|\alpha_1\alpha_2 \dots \alpha_{n}\rangle = \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		a_{\alpha_1'}^{\dagger}  a_{\alpha_1} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		a_{\alpha_2'}^{\dagger}  a_{\alpha_2} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		a_{\alpha_n'}^{\dagger}  a_{\alpha_n} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha, \beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta 
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-30a} \tag{50}
\end{equation}
\]</div>
<p>In the number occupation representation or second quantization we get the following expression for a one-body
operator which conserves the number of particles</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_0 = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta \label{eq:2-30b} \tag{51}
\end{equation}
\]</div>
<p>Obviously, <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> can be replaced by any other one-body  operator which preserved the number
of particles. The stucture of the operator is therefore not limited to say the kinetic or single-particle energy only.</p>
<p>The opearator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> takes a particle from the single-particle state <span class="math notranslate nohighlight">\(\beta\)</span>  to the single-particle state <span class="math notranslate nohighlight">\(\alpha\)</span>
with a probability for the transition given by the expectation value <span class="math notranslate nohighlight">\(\langle \alpha|\hat{h}_0|\beta\rangle\)</span>.</p>
<p>It is instructive to verify Eq. (<a class="reference external" href="#eq:2-30b">51</a>) by computing the expectation value of <span class="math notranslate nohighlight">\(\hat{H}_0\)</span>
between two single-particle states</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle
		\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle \label{eq:2-30c} \tag{52}
\end{equation}
\]</div>
<p>Using the commutation relations for the creation and annihilation operators we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger} = (\delta_{\alpha \alpha_1} - a_\alpha^{\dagger} a_{\alpha_1} )(\delta_{\beta \alpha_2} - a_{\alpha_2}^{\dagger} a_{\beta} ), \label{eq:2-30d} \tag{53}
\end{equation}
\]</div>
<p>which results in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30e"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle = \delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} \label{eq:2-30e} \tag{54}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-30f"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} = \langle \alpha_1|\hat{h}_0|\alpha_2\rangle \label{eq:2-30f} \tag{55}
\end{equation}
\]</div>
</div>
<div class="section" id="two-body-operators-in-second-quantization">
<h2><span class="section-number">1.5. </span>Two-body operators in second quantization<a class="headerlink" href="#two-body-operators-in-second-quantization" title="Permalink to this headline">¶</a></h2>
<p>Let us now derive the expression for our two-body interaction part, which also conserves the number of particles.
We can proceed in exactly the same way as for the one-body operator. In the coordinate representation our
two-body interaction part takes the following expression</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-31"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \sum_{i &lt; j} V(x_i,x_j) \label{eq:2-31} \tag{56}
\end{equation}
\]</div>
<p>where the summation runs over distinct pairs. The term <span class="math notranslate nohighlight">\(V\)</span> can be an interaction model for the nucleon-nucleon interaction
or the interaction between two electrons. It can also include additional two-body interaction terms.</p>
<p>The action of this operator on a product of
two single-particle functions is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-32"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	V(x_i,x_j) \psi_{\alpha_k}(x_i) \psi_{\alpha_l}(x_j) = \sum_{\alpha_k'\alpha_l'} 
		\psi_{\alpha_k}'(x_i)\psi_{\alpha_l}'(x_j) 
		\langle \alpha_k'\alpha_l'|\hat{v}|\alpha_k\alpha_l\rangle \label{eq:2-32} \tag{57}
\end{equation}
\]</div>
<p>We can now let <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> act on all terms in the linear combination for <span class="math notranslate nohighlight">\(|\alpha_1\alpha_2\dots\alpha_n\rangle\)</span>. Without any permutations we have</p>
<div class="math notranslate nohighlight">
\[
\left( \sum_{i &lt; j} V(x_i,x_j) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_1'\alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_1'\alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2'\alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-33"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	  + \dots \label{eq:2-33} \tag{58}
\end{equation}
\]</div>
<p>where on the rhs we have a term for each distinct pairs.</p>
<p>For the other terms on the rhs we obtain similar expressions  and summing over all terms we obtain</p>
<div class="math notranslate nohighlight">
\[
H_I |\alpha_1\alpha_2\dots\alpha_n\rangle = \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		|\alpha_1'\alpha_2'\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		|\alpha_1'\alpha_2\dots\alpha_n'\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		|\alpha_1\alpha_2'\dots\alpha_n'\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-34"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	 + \dots \label{eq:2-34} \tag{59}
\end{equation}
\]</div>
<p>We introduce second quantization via the relation</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k} 
		|\alpha_1\alpha_2\dots\alpha_k\dots\alpha_l\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^{k-1} (-1)^{l-2} a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k}
		|\alpha_k\alpha_l \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k,\alpha_l}\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (-1)^{k-1} (-1)^{l-2} 
	|\alpha_k'\alpha_l' \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k',\alpha_l'}\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-35"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= |\alpha_1\alpha_2\dots\alpha_k'\dots\alpha_l'\dots\alpha_n\rangle \label{eq:2-35} \tag{60}
\end{equation}
\]</div>
<p>Inserting this in (<a class="reference external" href="#eq:2-34">59</a>) gives</p>
<div class="math notranslate nohighlight">
\[
H_I |\alpha_1\alpha_2\dots\alpha_n\rangle
	= \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_2'}^{\dagger} a_{\alpha_2} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		a_{\alpha_2'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_2}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
+ \dots \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-36"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha, \beta, \gamma, \delta} ' \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma
		|\alpha_1\alpha_2\dots\alpha_n\rangle \label{eq:2-36} \tag{61}
\end{equation}
\]</div>
<p>Here we let <span class="math notranslate nohighlight">\(\sum'\)</span> indicate that the sums running over <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> run over all
single-particle states, while the summations  <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>
run over all pairs of single-particle states. We wish to remove this restriction and since</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-37"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha\beta|\hat{v}|\gamma\delta\rangle = \langle \beta\alpha|\hat{v}|\delta\gamma\rangle \label{eq:2-37} \tag{62}
\end{equation}
\]</div>
<p>we get</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma = 
		\sum_{\alpha\beta} \langle \beta\alpha|\hat{v}|\delta\gamma\rangle 
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-38a} \tag{63} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \sum_{\alpha\beta}\langle \beta\alpha|\hat{v}|\delta\gamma\rangle
		a^{\dagger}_\beta a^{\dagger}_\alpha a_\gamma a_\delta \label{eq:2-38b} \tag{64}
\end{equation}
\]</div>
<p>where we  have used the anti-commutation rules.</p>
<p>Changing the summation indices
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> in (<a class="reference external" href="#eq:2-38b">64</a>) we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-38c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma =
		 \sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\delta\gamma\rangle 
		  a^{\dagger}_\alpha a^{\dagger}_\beta  a_\gamma a_\delta \label{eq:2-38c} \tag{65}
\end{equation}
\]</div>
<p>From this it follows that the restriction on the summation over <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> can be removed if we multiply with a factor <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>, resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-39"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \frac{1}{2} \sum_{\alpha\beta\gamma\delta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-39} \tag{66}
\end{equation}
\]</div>
<p>where we sum freely over all single-particle states <span class="math notranslate nohighlight">\(\alpha\)</span>,
<span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span> og <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<p>With this expression we can now verify that the second quantization form of <span class="math notranslate nohighlight">\(\hat{H}_I\)</span> in Eq. (<a class="reference external" href="#eq:2-39">66</a>)
results in the same matrix between two anti-symmetrized two-particle states as its corresponding coordinate
space representation. We have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-40"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle \alpha_1 \alpha_2|\hat{H}_I|\beta_1 \beta_2\rangle =
		\frac{1}{2} \sum_{\alpha\beta\gamma\delta}
			\langle \alpha\beta|\hat{v}|\gamma\delta\rangle \langle 0|a_{\alpha_2} a_{\alpha_1} 
			 a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
			 a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle. \label{eq:2-40} \tag{67}
\end{equation}
\]</div>
<p>Using the commutation relations we get</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		a_\delta a_\gamma a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		( a_\delta \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} - 
		a_\delta  a_{\beta_1}^{\dagger} a_\gamma a_{\beta_2}^{\dagger} ) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta -
		a_\delta a_{\beta_1}^{\dagger}\delta_{\gamma \beta_2} +
		a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-41"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
		 \qquad - \delta_{\delta \beta_1} \delta_{\gamma \beta_2} + \delta_{\gamma \beta_2} a_{\beta_1}^{\dagger} a_\delta
		+ a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \label{eq:2-41} \tag{68}
\end{equation}
\]</div>
<p>The vacuum expectation value of this product of operators becomes</p>
<div class="math notranslate nohighlight">
\[
\langle 0|a_{\alpha_2} a_{\alpha_1} a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
		a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -
		\delta_{\delta \beta_1} \delta_{\gamma \beta_2} ) 
		\langle 0|a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta|0\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-42b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -\delta_{\delta \beta_1} \delta_{\gamma \beta_2} )
	(\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} -\delta_{\beta \alpha_1} \delta_{\alpha \alpha_2} ) \label{eq:2-42b} \tag{69}
\end{equation}
\]</div>
<p>Insertion of
Eq. (<a class="reference external" href="#eq:2-42b">69</a>) in Eq. (<a class="reference external" href="#eq:2-40">67</a>) results in</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_1\alpha_2|\hat{H}_I|\beta_1\beta_2\rangle = \frac{1}{2} \big[ 
		\langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle- \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
- \langle \alpha_2\alpha_1|\hat{v}|\beta_1\beta_2\rangle + \langle \alpha_2\alpha_1|\hat{v}|\beta_2\beta_1\rangle \big] \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle - \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-43b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle_{\mathrm{AS}}. \label{eq:2-43b} \tag{70}
\end{equation}
\]</div>
<p>The two-body operator can also be expressed in terms of the anti-symmetrized matrix elements we discussed previously as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I = \frac{1}{2} \sum_{\alpha\beta\gamma\delta}  \langle \alpha \beta|\hat{v}|\gamma \delta\rangle
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber
\]</div>
<div class="math notranslate nohighlight">
\[
= \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \left[ \langle \alpha \beta|\hat{v}|\gamma \delta\rangle -
		\langle \alpha \beta|\hat{v}|\delta\gamma \rangle \right] 
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-45"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	= \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \langle \alpha \beta|\hat{v}|\gamma \delta\rangle_{\mathrm{AS}}
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \label{eq:2-45} \tag{71}
\end{equation}
\]</div>
<p>The factors in front of the operator, either  <span class="math notranslate nohighlight">\(\frac{1}{4}\)</span> or
<span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> tells whether we use antisymmetrized matrix elements or not.</p>
<p>We can now express the Hamiltonian operator for a many-fermion system  in the occupation basis representation
as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-46b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	H = \sum_{\alpha, \beta} \langle \alpha|\hat{t}+\hat{u}_{\mathrm{ext}}|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
		\langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma. \label{eq:2-46b} \tag{72}
\end{equation}
\]</div>
<p>This is the form we will use in the rest of these lectures, assuming that we work with anti-symmetrized two-body matrix elements.</p>
</div>
<div class="section" id="particle-hole-formalism">
<h2><span class="section-number">1.6. </span>Particle-hole formalism<a class="headerlink" href="#particle-hole-formalism" title="Permalink to this headline">¶</a></h2>
<p>Second quantization is a useful and elegant formalism  for constructing many-body  states and
quantum mechanical operators. One can express and translate many physical processes
into simple pictures such as Feynman diagrams. Expecation values of many-body states are also easily calculated.
However, although the equations are seemingly easy to set up, from  a practical point of view, that is
the solution of Schroedinger’s equation, there is no particular gain.
The many-body equation is equally hard to solve, irrespective of representation.
The cliche that
there is no free lunch brings us down to earth again.<br />
Note however that a transformation to a particular
basis, for cases where the interaction obeys specific symmetries, can ease the solution of Schroedinger’s equation.</p>
<p>But there is at least one important case where second quantization comes to our rescue.
It is namely easy to introduce another reference state than the pure vacuum <span class="math notranslate nohighlight">\(|0\rangle \)</span>, where all single-particle states are active.
With many particles present it is often useful to introduce another reference state  than the vacuum state<span class="math notranslate nohighlight">\(|0\rangle \)</span>. We will label this state <span class="math notranslate nohighlight">\(|c\rangle\)</span> (<span class="math notranslate nohighlight">\(c\)</span> for core) and as we will see it can reduce
considerably the complexity and thereby the dimensionality of the many-body problem. It allows us to sum up to infinite order specific many-body correlations.  The particle-hole representation is one of these handy representations.</p>
<p>In the original particle representation these states are products of the creation operators  <span class="math notranslate nohighlight">\(a_{\alpha_i}^\dagger\)</span> acting on the true vacuum <span class="math notranslate nohighlight">\(|0\rangle \)</span>.
Following Eq. (<a class="reference external" href="#eq:2-2">16</a>) we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
 |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
					a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-47a} \tag{73} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger
		a_{\alpha_{n+1}}^\dagger |0\rangle  \label{eq:2-47b} \tag{74} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-47c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle = a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
		a_{\alpha_{n-1}}^\dagger |0\rangle  \label{eq:2-47c} \tag{75}
\end{equation}
\]</div>
<p>If we use Eq. (<a class="reference external" href="#eq:2-47a">73</a>) as our new reference state, we can simplify considerably the representation of
this state</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|c\rangle  \equiv |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-48a} \tag{76}
\end{equation}
\]</div>
<p>The new reference states for the <span class="math notranslate nohighlight">\(n+1\)</span> and <span class="math notranslate nohighlight">\(n-1\)</span> states can then be written as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle = (-1)^n a_{\alpha_{n+1}}^\dagger |c\rangle 
		\equiv (-1)^n |\alpha_{n+1}\rangle_c \label{eq:2-48b} \tag{77} 
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-48c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle = (-1)^{n-1} a_{\alpha_n} |c\rangle  
		\equiv (-1)^{n-1} |\alpha_{n-1}\rangle_c \label{eq:2-48c} \tag{78} 
\end{equation}
\]</div>
<p>The first state has one additional particle with respect to the new vacuum state
<span class="math notranslate nohighlight">\(|c\rangle \)</span>  and is normally referred to as a one-particle state or one particle added to the
many-body reference state.
The second state has one particle less than the reference vacuum state  <span class="math notranslate nohighlight">\(|c\rangle \)</span> and is referred to as
a one-hole state.
When dealing with a new reference state it is often convenient to introduce
new creation and annihilation operators since we have
from Eq. (<a class="reference external" href="#eq:2-48c">78</a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-49"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	a_\alpha |c\rangle  \neq 0 \label{eq:2-49} \tag{79}
\end{equation}
\]</div>
<p>since  <span class="math notranslate nohighlight">\(\alpha\)</span> is contained  in <span class="math notranslate nohighlight">\(|c\rangle \)</span>, while for the true vacuum we have
<span class="math notranslate nohighlight">\(a_\alpha |0\rangle  = 0\)</span> for all <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>The new reference state leads to the definition of new creation and annihilation operators
which satisfy the following relations</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-50a"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	b_\alpha |c\rangle  = 0 \label{eq:2-50a} \tag{80} 
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\{b_\alpha^\dagger , b_\beta^\dagger \} = \{b_\alpha , b_\beta \} = 0 \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-50c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	\{b_\alpha^\dagger , b_\beta \} = \delta_{\alpha \beta} \label{eq:2-50c} \tag{81}
\end{equation}
\]</div>
<p>We assume also that the new reference state is properly normalized</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-51"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\langle c | c \rangle = 1 \label{eq:2-51} \tag{82}
\end{equation}
\]</div>
<p>The physical interpretation of these new operators is that of so-called quasiparticle states.
This means that a state defined by the addition of one extra particle to a reference state <span class="math notranslate nohighlight">\(|c\rangle \)</span> may not necesseraly be interpreted as one particle coupled to a core.
We define now new creation operators that act on a state <span class="math notranslate nohighlight">\(\alpha\)</span> creating a new quasiparticle state</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-52"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	b_\alpha^\dagger|c\rangle  = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger |c\rangle  = |\alpha\rangle, &amp; \alpha &gt; F \\
		\\
		a_\alpha |c\rangle  = |\alpha^{-1}\rangle, &amp; \alpha \leq F
	\end{array} \label{eq:2-52} \tag{83}
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the Fermi level representing the last  occupied single-particle orbit
of the new reference state <span class="math notranslate nohighlight">\(|c\rangle \)</span>.</p>
<p>The annihilation is the hermitian conjugate of the creation operator</p>
<div class="math notranslate nohighlight">
\[
b_\alpha = (b_\alpha^\dagger)^\dagger,
\]</div>
<p>resulting in</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-54"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	b_\alpha^\dagger = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger &amp; \alpha &gt; F \\
		\\
		a_\alpha &amp; \alpha \leq F
	\end{array} \qquad 
	b_\alpha = \Bigg\{ \begin{array}{ll}
		a_\alpha &amp; \alpha &gt; F \\
		\\
		 a_\alpha^\dagger &amp; \alpha \leq F
	\end{array} \label{eq:2-54} \tag{84}
\end{equation}
\end{split}\]</div>
<p>With the new creation and annihilation operator  we can now construct
many-body quasiparticle states, with one-particle-one-hole states, two-particle-two-hole
states etc in the same fashion as we previously constructed many-particle states.
We can write a general particle-hole state as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-56"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \equiv
		\underbrace{b_{\beta_1}^\dagger b_{\beta_2}^\dagger \dots b_{\beta_{n_p}}^\dagger}_{&gt;F}
		\underbrace{b_{\gamma_1}^\dagger b_{\gamma_2}^\dagger \dots b_{\gamma_{n_h}}^\dagger}_{\leq F} |c\rangle \label{eq:2-56} \tag{85}
\end{equation}
\]</div>
<p>We can now rewrite our one-body and two-body operators in terms of the new creation and annihilation operators.
The number operator becomes</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-57b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^\dagger a_\alpha= 
\sum_{\alpha &gt; F} b_\alpha^\dagger b_\alpha + n_c - \sum_{\alpha \leq F} b_\alpha^\dagger b_\alpha \label{eq:2-57b} \tag{86}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_c\)</span> is the number of particle in the new vacuum state <span class="math notranslate nohighlight">\(|c\rangle \)</span>.<br />
The action of <span class="math notranslate nohighlight">\(\hat{N}\)</span> on a many-body state results in</p>
<!-- Equation labels as ordinary links -->
<div id="2-59"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle = (n_p + n_c - n_h) |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{2-59} \tag{87}
\end{equation}
\]</div>
<p>Here  <span class="math notranslate nohighlight">\(n=n_p +n_c - n_h\)</span> is the total number of particles in the quasi-particle state of
Eq. (<a class="reference external" href="#eq:2-56">85</a>). Note that  <span class="math notranslate nohighlight">\(\hat{N}\)</span> counts the total number of particles  present</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-60"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N_{qp} = \sum_\alpha b_\alpha^\dagger b_\alpha, \label{eq:2-60} \tag{88}
\end{equation}
\]</div>
<p>gives us the number of quasi-particles as can be seen by computing</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-61"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	N_{qp}= |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle
		= (n_p + n_h)|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{eq:2-61} \tag{89}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_{qp} = n_p + n_h\)</span> is the total number of quasi-particles.</p>
<p>We express the one-body operator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> in terms of the quasi-particle creation and annihilation operators, resulting in</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{\alpha\beta &gt; F} \langle \alpha|\hat{h}_0|\beta\rangle  b_\alpha^\dagger b_\beta +
		\sum_{\alpha &gt; F, \beta \leq F } \left[\langle \alpha|\hat{h}_0|\beta\rangle b_\alpha^\dagger b_\beta^\dagger + \langle \beta|\hat{h}_0|\alpha\rangle b_\beta  b_\alpha \right] \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-63b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{\alpha \leq F} \langle \alpha|\hat{h}_0|\alpha\rangle - \sum_{\alpha\beta \leq F} \langle \beta|\hat{h}_0|\alpha\rangle b_\alpha^\dagger b_\beta \label{eq:2-63b} \tag{90}
\end{equation}
\]</div>
<p>The first term  gives contribution only for particle states, while the last one
contributes only for holestates. The second term can create or destroy a set of
quasi-particles and
the third term is the contribution  from the vacuum state <span class="math notranslate nohighlight">\(|c\rangle\)</span>.</p>
<p>Before we continue with the expressions for the two-body operator, we introduce a nomenclature we will use for the rest of this
text. It is inspired by the notation used in quantum chemistry.
We reserve the labels <span class="math notranslate nohighlight">\(i,j,k,\dots\)</span> for hole states and <span class="math notranslate nohighlight">\(a,b,c,\dots\)</span> for states above <span class="math notranslate nohighlight">\(F\)</span>, viz. particle states.
This means also that we will skip the constraint <span class="math notranslate nohighlight">\(\leq F\)</span> or <span class="math notranslate nohighlight">\(&gt; F\)</span> in the summation symbols.
Our operator <span class="math notranslate nohighlight">\(\hat{H}_0\)</span>  reads now</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{ab} \langle a|\hat{h}|b\rangle b_a^\dagger b_b +
		\sum_{ai} \left[
		\langle a|\hat{h}|i\rangle b_a^\dagger b_i^\dagger + 
		\langle i|\hat{h}|a\rangle b_i  b_a \right] \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-63c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
	+ \sum_{i} \langle i|\hat{h}|i\rangle - 
		\sum_{ij} \langle j|\hat{h}|i\rangle
		b_i^\dagger b_j \label{eq:2-63c} \tag{91}
\end{equation}
\]</div>
<p>The two-particle operator in the particle-hole formalism  is more complicated since we have
to translate four indices <span class="math notranslate nohighlight">\(\alpha\beta\gamma\delta\)</span> to the possible combinations of particle and hole
states.  When performing the commutator algebra we can regroup the operator in five different terms</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-65"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I = \hat{H}_I^{(a)} + \hat{H}_I^{(b)} + \hat{H}_I^{(c)} + \hat{H}_I^{(d)} + \hat{H}_I^{(e)} \label{eq:2-65} \tag{92}
\end{equation}
\]</div>
<p>Using anti-symmetrized  matrix elements,
bthe term  <span class="math notranslate nohighlight">\(\hat{H}_I^{(a)}\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-66"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I^{(a)} = \frac{1}{4}
	\sum_{abcd} \langle ab|\hat{V}|cd\rangle 
		b_a^\dagger b_b^\dagger b_d b_c \label{eq:2-66} \tag{93}
\end{equation}
\]</div>
<p>The next term <span class="math notranslate nohighlight">\(\hat{H}_I^{(b)}\)</span>  reads</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-67b"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	 \hat{H}_I^{(b)} = \frac{1}{4} \sum_{abci}\left(\langle ab|\hat{V}|ci\rangle b_a^\dagger b_b^\dagger b_i^\dagger b_c +\langle ai|\hat{V}|cb\rangle b_a^\dagger b_i b_b b_c\right) \label{eq:2-67b} \tag{94}
\end{equation}
\]</div>
<p>This term conserves the number of quasiparticles but creates or removes a
three-particle-one-hole  state.
For <span class="math notranslate nohighlight">\(\hat{H}_I^{(c)}\)</span>  we have</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I^{(c)} = \frac{1}{4}
		\sum_{abij}\left(\langle ab|\hat{V}|ij\rangle b_a^\dagger b_b^\dagger b_j^\dagger b_i^\dagger +
		\langle ij|\hat{V}|ab\rangle b_a  b_b b_j b_i \right)+  \nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-68c"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
		\frac{1}{2}\sum_{abij}\langle ai|\hat{V}|bj\rangle b_a^\dagger b_j^\dagger b_b b_i + 
		\frac{1}{2}\sum_{abi}\langle ai|\hat{V}|bi\rangle b_a^\dagger b_b. \label{eq:2-68c} \tag{95}
\end{equation}
\]</div>
<p>The first line stands for the creation of a two-particle-two-hole state, while the second line represents
the creation to two one-particle-one-hole pairs
while the last term represents a contribution to the particle single-particle energy
from the hole states, that is an interaction between the particle states and the hole states
within the new vacuum  state.
The fourth term reads</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I^{(d)} = \frac{1}{4} 
	 	\sum_{aijk}\left(\langle ai|\hat{V}|jk\rangle b_a^\dagger b_k^\dagger b_j^\dagger b_i+
\langle ji|\hat{V}|ak\rangle b_k^\dagger b_j b_i b_a\right)+\nonumber
\]</div>
<!-- Equation labels as ordinary links -->
<div id="eq:2-69d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
\frac{1}{4}\sum_{aij}\left(\langle ai|\hat{V}|ji\rangle b_a^\dagger b_j^\dagger+
\langle ji|\hat{V}|ai\rangle - \langle ji|\hat{V}|ia\rangle b_j b_a \right). \label{eq:2-69d} \tag{96} 
\end{equation}
\]</div>
<p>The terms in the first line  stand for the creation of a particle-hole state
interacting with hole states, we will label this as a two-hole-one-particle contribution.
The remaining terms are a particle-hole state interacting with the holes in the vacuum state.
Finally we have</p>
<!-- Equation labels as ordinary links -->
<div id="eq:2-70d"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
	\hat{H}_I^{(e)} = \frac{1}{4}
		 \sum_{ijkl}
		 \langle kl|\hat{V}|ij\rangle b_i^\dagger b_j^\dagger b_l b_k+
	        \frac{1}{2}\sum_{ijk}\langle ij|\hat{V}|kj\rangle b_k^\dagger b_i
	        +\frac{1}{2}\sum_{ij}\langle ij|\hat{V}|ij\rangle \label{eq:2-70d} \tag{97}
\end{equation}
\]</div>
<p>The first terms represents the
interaction between two holes while the second stands for the interaction between a hole and the remaining holes in the vacuum state.
It represents a contribution to single-hole energy  to first order.
The last term collects all contributions to the energy of the ground state of a closed-shell system arising
from hole-hole correlations.</p>
</div>
<div class="section" id="summarizing-and-defining-a-normal-ordered-hamiltonian">
<h2><span class="section-number">1.7. </span>Summarizing and defining a normal-ordered Hamiltonian<a class="headerlink" href="#summarizing-and-defining-a-normal-ordered-hamiltonian" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[
\Phi_{AS}(\alpha_1, \dots, \alpha_A; x_1, \dots x_A)=
            \frac{1}{\sqrt{A}} \sum_{\hat{P}} (-1)^P \hat{P} \prod_{i=1}^A \psi_{\alpha_i}(x_i),
\]</div>
<p>which is equivalent with <span class="math notranslate nohighlight">\(|\alpha_1 \dots \alpha_A\rangle= a_{\alpha_1}^{\dagger} \dots a_{\alpha_A}^{\dagger} |0\rangle\)</span>. We have also</p>
<p>2
0
3</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
\delta_{pq} = \left\{a_p, a_q^\dagger \right\},
\]</div>
<p>and</p>
<p>2
0
5</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
|\Phi_0\rangle = |\alpha_1 \dots \alpha_A\rangle, \quad \alpha_1, \dots, \alpha_A \leq \alpha_F
\]</div>
<p>2
0
7</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
\left\{a_p, a_q^\dagger \right\} = \delta_{pq}, p, q &gt; \alpha_F
\]</div>
<p>with         <span class="math notranslate nohighlight">\(i,j,\ldots \leq \alpha_F, \quad a,b,\ldots &gt; \alpha_F, \quad p,q, \ldots - \textrm{any}\)</span></p>
<div class="math notranslate nohighlight">
\[
a_i|\Phi_0\rangle = |\Phi_i\rangle, \hspace{0.5cm} a_a^\dagger|\Phi_0\rangle = |\Phi^a\rangle
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
a_i^\dagger|\Phi_0\rangle = 0 \hspace{0.5cm}  a_a|\Phi_0\rangle = 0
\]</div>
<p>The one-body operator is defined as</p>
<div class="math notranslate nohighlight">
\[
\hat{F} = \sum_{pq} \langle p|\hat{f}|q\rangle a_p^\dagger a_q
\]</div>
<p>while the two-body opreator is defined as</p>
<div class="math notranslate nohighlight">
\[
\hat{V} = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle_{AS} a_p^\dagger a_q^\dagger a_s a_r
\]</div>
<p>where we have defined the antisymmetric matrix elements</p>
<div class="math notranslate nohighlight">
\[
\langle pq|\hat{v}|rs\rangle_{AS} = \langle pq|\hat{v}|rs\rangle - \langle pq|\hat{v}|sr\rangle.
\]</div>
<p>We can also define a three-body operator</p>
<div class="math notranslate nohighlight">
\[
\hat{V}_3 = \frac{1}{36} \sum_{pqrstu} \langle pqr|\hat{v}_3|stu\rangle_{AS} 
                a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
\]</div>
<p>with the antisymmetrized matrix element</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
            \langle pqr|\hat{v}_3|stu\rangle_{AS} = \langle pqr|\hat{v}_3|stu\rangle + \langle pqr|\hat{v}_3|tus\rangle + \langle pqr|\hat{v}_3|ust\rangle- \langle pqr|\hat{v}_3|sut\rangle - \langle pqr|\hat{v}_3|tsu\rangle - \langle pqr|\hat{v}_3|uts\rangle.
\label{_auto3} \tag{98}
\end{equation}
\]</div>
</div>
<div class="section" id="operators-in-second-quantization">
<h2><span class="section-number">1.8. </span>Operators in second quantization<a class="headerlink" href="#operators-in-second-quantization" title="Permalink to this headline">¶</a></h2>
<p>In the build-up of a shell-model or FCI code that is meant to tackle large dimensionalities
is the action of the Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}\)</span> on a
Slater determinant represented in second quantization as</p>
<div class="math notranslate nohighlight">
\[
|\alpha_1\dots \alpha_n\rangle = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>The time consuming part stems from the action of the Hamiltonian
on the above determinant,</p>
<div class="math notranslate nohighlight">
\[
\left(\sum_{\alpha\beta} \langle \alpha|t+u|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
                \langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma\right)a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
\]</div>
<p>A practically useful way to implement this action is to encode a Slater determinant as a bit pattern.</p>
<p>Assume that we have at our disposal <span class="math notranslate nohighlight">\(n\)</span> different single-particle orbits
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_2,\dots,\alpha_{n-1}\)</span> and that we can distribute  among these orbits <span class="math notranslate nohighlight">\(N\le n\)</span> particles.</p>
<p>A Slater  determinant can then be coded as an integer of <span class="math notranslate nohighlight">\(n\)</span> bits. As an example, if we have <span class="math notranslate nohighlight">\(n=16\)</span> single-particle states
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_1,\dots,\alpha_{15}\)</span> and <span class="math notranslate nohighlight">\(N=4\)</span> fermions occupying the states <span class="math notranslate nohighlight">\(\alpha_3\)</span>, <span class="math notranslate nohighlight">\(\alpha_6\)</span>, <span class="math notranslate nohighlight">\(\alpha_{10}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{13}\)</span>
we could write this Slater determinant as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle.
\]</div>
<p>The unoccupied single-particle states have bit value <span class="math notranslate nohighlight">\(0\)</span> while the occupied ones are represented by bit state <span class="math notranslate nohighlight">\(1\)</span>.
In the binary notation we would write this   16 bits long integer as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cccccccccccccccc}
{\alpha_0}&amp;{\alpha_1}&amp;{\alpha_2}&amp;{\alpha_3}&amp;{\alpha_4}&amp;{\alpha_5}&amp;{\alpha_6}&amp;{\alpha_7} &amp; {\alpha_8} &amp;{\alpha_9} &amp; {\alpha_{10}} &amp;{\alpha_{11}} &amp;{\alpha_{12}} &amp;{\alpha_{13}} &amp;{\alpha_{14}} &amp; {\alpha_{15}} \\
{0} &amp; {0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp;{0} &amp;{1} &amp;{0} &amp; {0} \\
\end{array}
\end{split}\]</div>
<p>which translates into the decimal number</p>
<div class="math notranslate nohighlight">
\[
2^3+2^6+2^{10}+2^{13}=9288.
\]</div>
<p>We can thus encode a Slater determinant as a bit pattern.</p>
<p>With <span class="math notranslate nohighlight">\(N\)</span> particles that can be distributed over <span class="math notranslate nohighlight">\(n\)</span> single-particle states, the total number of Slater determinats (and defining thereby the dimensionality of the system) is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathrm{dim}(\mathcal{H}) = \left(\begin{array}{c} n \\N\end{array}\right).
\end{split}\]</div>
<p>The total number of bit patterns is <span class="math notranslate nohighlight">\(2^n\)</span>.</p>
<p>We assume again that we have at our disposal <span class="math notranslate nohighlight">\(n\)</span> different single-particle orbits
<span class="math notranslate nohighlight">\(\alpha_0,\alpha_2,\dots,\alpha_{n-1}\)</span> and that we can distribute  among these orbits <span class="math notranslate nohighlight">\(N\le n\)</span> particles.
The ordering among these states is important as it defines the order of the creation operators.
We will write the determinant</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>in a more compact way as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{3,6,10,13} = |0001001000100100\rangle.
\]</div>
<p>The action of a creation operator is thus</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_4}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
\]</div>
<p>Similarly</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_6}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_6}|0001001000100100\rangle=a^{\dagger}_{\alpha_6}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a^{\dagger}_{\alpha_4} (a_{\alpha_6}^{\dagger})^ 2 a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=0!
\]</div>
<p>This gives a simple recipe:</p>
<ul class="simple">
<li><p>If one of the bits <span class="math notranslate nohighlight">\(b_j\)</span> is <span class="math notranslate nohighlight">\(1\)</span> and we act with a creation operator on this bit, we return a null vector</p></li>
<li><p>If <span class="math notranslate nohighlight">\(b_j=0\)</span>, we set it to <span class="math notranslate nohighlight">\(1\)</span> and return a sign factor <span class="math notranslate nohighlight">\((-1)^l\)</span>, where <span class="math notranslate nohighlight">\(l\)</span> is the number of bits set before bit <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
<p>Consider the action of <span class="math notranslate nohighlight">\(a^{\dagger}_{\alpha_2}\)</span> on various slater determinants:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ccc}
a^{\dagger}_{\alpha_2}\Phi_{00111}&amp; = a^{\dagger}_{\alpha_2}|00111\rangle&amp;=0\times |00111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01011}&amp; = a^{\dagger}_{\alpha_2}|01011\rangle&amp;=(-1)\times |01111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01101}&amp; = a^{\dagger}_{\alpha_2}|01101\rangle&amp;=0\times |01101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01110}&amp; = a^{\dagger}_{\alpha_2}|01110\rangle&amp;=0\times |01110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10011}&amp; = a^{\dagger}_{\alpha_2}|10011\rangle&amp;=(-1)\times |10111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10101}&amp; = a^{\dagger}_{\alpha_2}|10101\rangle&amp;=0\times |10101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10110}&amp; = a^{\dagger}_{\alpha_2}|10110\rangle&amp;=0\times |10110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11001}&amp; = a^{\dagger}_{\alpha_2}|11001\rangle&amp;=(+1)\times |11101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11010}&amp; = a^{\dagger}_{\alpha_2}|11010\rangle&amp;=(+1)\times |11110\rangle\\
\end{array}
\end{split}\]</div>
<p>What is the simplest way to obtain the phase when we act with one annihilation(creation) operator
on the given Slater determinant representation?</p>
<p>We have an SD representation</p>
<div class="math notranslate nohighlight">
\[
\Phi_{\Lambda} = a_{\alpha_0}^{\dagger} a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>in a more compact way as</p>
<div class="math notranslate nohighlight">
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle.
\]</div>
<p>The action of</p>
<div class="math notranslate nohighlight">
\[
a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
\]</div>
<p>The action</p>
<div class="math notranslate nohighlight">
\[
a_{\alpha_0}\Phi_{0,3,6,10,13} = |0001001000100100\rangle,
\]</div>
<p>can be obtained by subtracting the logical sum (AND operation) of <span class="math notranslate nohighlight">\(\Phi_{0,3,6,10,13}\)</span> and
a word which represents only <span class="math notranslate nohighlight">\(\alpha_0\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[
|1000000000000000\rangle,
\]</div>
<p>from <span class="math notranslate nohighlight">\(\Phi_{0,3,6,10,13}= |1001001000100100\rangle\)</span>.</p>
<p>This operation gives <span class="math notranslate nohighlight">\(|0001001000100100\rangle\)</span>.</p>
<p>Similarly, we can form <span class="math notranslate nohighlight">\(a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13}\)</span>, say, by adding
<span class="math notranslate nohighlight">\(|0000100000000000\rangle\)</span> to <span class="math notranslate nohighlight">\(a_{\alpha_0}\Phi_{0,3,6,10,13}\)</span>, first checking that their logical sum
is zero in order to make sure that orbital <span class="math notranslate nohighlight">\(\alpha_4\)</span> is not already occupied.</p>
<p>It is trickier however to get the phase <span class="math notranslate nohighlight">\((-1)^l\)</span>.
One possibility is as follows</p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(S_1\)</span> be a word that represents the <span class="math notranslate nohighlight">\(1-\)</span>bit to be removed and all others set to zero.</p></li>
</ul>
<p>In the previous example <span class="math notranslate nohighlight">\(S_1=|1000000000000000\rangle\)</span></p>
<ul class="simple">
<li><p>Define <span class="math notranslate nohighlight">\(S_2\)</span> as the similar word that represents the bit to be added, that is in our case</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(S_2=|0000100000000000\rangle\)</span>.</p>
<ul class="simple">
<li><p>Compute then <span class="math notranslate nohighlight">\(S=S_1-S_2\)</span>, which here becomes</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S=|0111000000000000\rangle
\]</div>
<ul class="simple">
<li><p>Perform then the logical AND operation of <span class="math notranslate nohighlight">\(S\)</span> with the word containing</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Phi_{0,3,6,10,13} = |1001001000100100\rangle,
\]</div>
<p>which results in <span class="math notranslate nohighlight">\(|0001000000000000\rangle\)</span>. Counting the number of <span class="math notranslate nohighlight">\(1-\)</span>bits gives the phase.  Here you need however an algorithm for bitcounting. Several efficient ones available.</p>
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-1-relation-between-basis-functions">
<h2><span class="section-number">1.9. </span>Exercise 1: Relation between basis functions<a class="headerlink" href="#exercise-1-relation-between-basis-functions" title="Permalink to this headline">¶</a></h2>
<p>This exercise serves to convince you about the relation between
two different single-particle bases, where one could be our new Hartree-Fock basis and the other a harmonic oscillator basis.</p>
<p>Consider a Slater determinant built up of single-particle orbitals <span class="math notranslate nohighlight">\(\psi_{\lambda}\)</span>,
with <span class="math notranslate nohighlight">\(\lambda = 1,2,\dots,A\)</span>. The unitary transformation</p>
<div class="math notranslate nohighlight">
\[
\psi_a  = \sum_{\lambda} C_{a\lambda}\phi_{\lambda},
\]</div>
<p>brings us into the new basis.<br />
The new basis has quantum numbers <span class="math notranslate nohighlight">\(a=1,2,\dots,A\)</span>.
Show that the new basis is orthonormal.
Show that the new Slater determinant constructed from the new single-particle wave functions can be
written as the determinant based on the previous basis and the determinant of the matrix <span class="math notranslate nohighlight">\(C\)</span>.
Show that the old and the new Slater determinants are equal up to a complex constant with absolute value unity.
(Hint, <span class="math notranslate nohighlight">\(C\)</span> is a unitary matrix).</p>
<p>Starting with the second quantization representation of the Slater determinant</p>
<div class="math notranslate nohighlight">
\[
\Phi_{0}=\prod_{i=1}^{n}a_{\alpha_{i}}^{\dagger}|0\rangle,
\]</div>
<p>use Wick’s theorem to compute the normalization integral
<span class="math notranslate nohighlight">\(\langle\Phi_{0}|\Phi_{0}\rangle\)</span>.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-2-matrix-elements">
<h2><span class="section-number">1.10. </span>Exercise 2: Matrix elements<a class="headerlink" href="#exercise-2-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>Calculate the matrix elements</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_{1}\alpha_{2}|\hat{F}|\alpha_{1}\alpha_{2}\rangle
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha_{1}\alpha_{2}|\hat{G}|\alpha_{1}\alpha_{2}\rangle
\]</div>
<p>with</p>
<p>2
4
1</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>2
4
2</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>2
4
3</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
\hat{G} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle
a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma} ,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle=
\int\int \psi_{\alpha}^{*}(x_{1})\psi_{\beta}^{*}(x_{2})g(x_{1},
x_{2})\psi_{\gamma}(x_{1})\psi_{\delta}(x_{2})dx_{1}dx_{2}
\]</div>
<p>Compare these results with those from exercise 3c).</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-3-normal-ordered-one-body-operator">
<h2><span class="section-number">1.11. </span>Exercise 3: Normal-ordered one-body operator<a class="headerlink" href="#exercise-3-normal-ordered-one-body-operator" title="Permalink to this headline">¶</a></h2>
<p>Show that the onebody part of the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle a^{\dagger}_p a_q,
\]</div>
<p>can be written, using standard annihilation and creation operators, in normal-ordered form as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle \left\{a^\dagger_p a_q\right\} +
             \sum_i \langle i|\hat{h}_0|i\rangle.
\]</div>
<p>Explain the meaning of the various symbols. Which reference
vacuum has been used?</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-4-normal-ordered-two-body-operator">
<h2><span class="section-number">1.12. </span>Exercise 4: Normal-ordered two-body operator<a class="headerlink" href="#exercise-4-normal-ordered-two-body-operator" title="Permalink to this headline">¶</a></h2>
<p>Show that the twobody part of the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle a^\dagger_p a^\dagger_q a_s  a_r,
\]</div>
<p>can be written, using standard annihilation and creation operators, in normal-ordered form as</p>
<div class="math notranslate nohighlight">
\[
\hat{H}_I =\frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle \left\{a^\dagger_p a^\dagger_q a_s  a_r\right\}
            + \sum_{pqi} \langle pi|\hat{v}|qi\rangle \left\{a^\dagger_p a_q\right\} 
            + \frac{1}{2} \sum_{ij}\langle ij|\hat{v}|ij\rangle.
\]</div>
<p>Explain again the meaning of the various symbols.</p>
<p>This exercise is optional: Derive the normal-ordered form of the threebody part of the Hamiltonian.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{H}_3 = \frac{1}{36} \sum_{\substack{pqr \\ stu}}
                 \langle pqr|\hat{v}_3|stu\rangle a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s,
\end{split}\]</div>
<p>and specify the contributions to the twobody, onebody and the scalar part.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-5-matrix-elements-using-the-slater-condon-rule">
<h2><span class="section-number">1.13. </span>Exercise 5: Matrix elements using the Slater-Condon rule<a class="headerlink" href="#exercise-5-matrix-elements-using-the-slater-condon-rule" title="Permalink to this headline">¶</a></h2>
<p>The aim of this exercise is to set up specific matrix elements that will turn useful when we start our discussions of the nuclear shell model. In particular you will notice, depending on the character of the operator, that many matrix elements will actually be zero.</p>
<p>Consider three <span class="math notranslate nohighlight">\(N\)</span>-particle  Slater determinants  <span class="math notranslate nohighlight">\(|\Phi_0\)</span>, <span class="math notranslate nohighlight">\(|\Phi_i^a\rangle\)</span> and <span class="math notranslate nohighlight">\(|\Phi_{ij}^{ab}\rangle\)</span>, where the notation means that
Slater determinant <span class="math notranslate nohighlight">\(|\Phi_i^a\rangle\)</span> differs from <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> by one single-particle state, that is a single-particle
state <span class="math notranslate nohighlight">\(\psi_i\)</span> is replaced by a single-particle state <span class="math notranslate nohighlight">\(\psi_a\)</span>.
It is often interpreted as a so-called one-particle-one-hole excitation.
Similarly, the Slater determinant <span class="math notranslate nohighlight">\(|\Phi_{ij}^{ab}\rangle\)</span>
differs by two single-particle states from <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> and is normally thought of as a two-particle-two-hole excitation.
We assume also that <span class="math notranslate nohighlight">\(|\Phi_0\rangle\)</span> represents our new vacuum reference state
and the labels <span class="math notranslate nohighlight">\(ijk\dots\)</span> represent single-particle states below the Fermi level and <span class="math notranslate nohighlight">\(abc\dots\)</span> represent states above the Fermi level, so-called particle states.
We define thereafter a general onebody normal-ordered (with respect to the new vacuum state) operator
as</p>
<div class="math notranslate nohighlight">
\[
\hat{F}_N=\sum_{pq}\langle p |f |\beta\rangle \left\{a_{p}^{\dagger}a_{q}\right\}  ,
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\langle p |f| q\rangle=\int \psi_{p}^{*}(x)f(x)\psi_{q}(x)dx ,
\]</div>
<p>and a general normal-ordered two-body operator</p>
<div class="math notranslate nohighlight">
\[
\hat{G}_N = \frac{1}{4}\sum_{pqrs}
\langle pq |g| rs\rangle_{AS} \left\{a_{p}^{\dagger}a_{q}^{\dagger}a_{s}a_{r}\right\} ,
\]</div>
<p>with for example the direct matrix element given as</p>
<div class="math notranslate nohighlight">
\[
\langle pq |g| rs\rangle=
\int\int \psi_{p}^{*}(x_{1})\psi_{q}^{*}(x_{2})g(x_{1}, x_{2})\psi_{r}(x_{1})\psi_{s}(x_{2})dx_{1}dx_{2}
\]</div>
<p>with <span class="math notranslate nohighlight">\(g\)</span> being invariant under the interchange of the coordinates of two particles.
The single-particle states <span class="math notranslate nohighlight">\(\psi_i\)</span> are not necessarily eigenstates of <span class="math notranslate nohighlight">\(\hat{f}\)</span>.  The curly brackets mean that the operators are normal-ordered with respect to the new vacuum reference state.</p>
<p>How would you write the above Slater determinants in a second quantization formalism, utilizing the fact that we have defined a new reference state?</p>
<p>Use thereafter Wick’s theorem to find the expectation values of</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 \vert\hat{F}_N\vert\Phi_0\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0\hat{G}_N|\Phi_0\rangle.
\]</div>
<p>Find thereafter</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 |\hat{F}_N|\Phi_i^a\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_i^a\rangle,
\]</div>
<p>Finally, find</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0 |\hat{F}_N|\Phi_{ij}^{ab}\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_{ij}^{ab}\rangle.
\]</div>
<p>What happens with the two-body operator if we have a transition probability  of the type</p>
<div class="math notranslate nohighlight">
\[
\langle \Phi_0|\hat{G}_N|\Phi_{ijk}^{abc}\rangle,
\]</div>
<p>where the Slater determinant to the right of the operator differs by more than two single-particle states?</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-6-program-to-set-up-slater-determinants">
<h2><span class="section-number">1.14. </span>Exercise 6: Program to set up Slater determinants<a class="headerlink" href="#exercise-6-program-to-set-up-slater-determinants" title="Permalink to this headline">¶</a></h2>
<p>Write a program which sets up all possible Slater determinants given <span class="math notranslate nohighlight">\(N=4\)</span> eletrons which can occupy
the atomic single-particle states defined by the <span class="math notranslate nohighlight">\(1s\)</span>, <span class="math notranslate nohighlight">\(2s2p\)</span> and <span class="math notranslate nohighlight">\(3s3p3d\)</span> shells. How many single-particle
states <span class="math notranslate nohighlight">\(n\)</span> are there in total?  Include the spin degrees of freedom as well.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-7-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.15. </span>Exercise 7: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-7-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>Compute the matrix element</p>
<div class="math notranslate nohighlight">
\[
\langle\alpha_{1}\alpha_{2}\alpha_{3}|\hat{G}|\alpha_{1}'\alpha_{2}'\alpha_{3}'\rangle,
\]</div>
<p>using Wick’s theorem and express the two-body operator
<span class="math notranslate nohighlight">\(G\)</span> in the occupation number (second quantization)
representation.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-8-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.16. </span>Exercise 8: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-8-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>The last exercise can be solved using the symbolic Python package called <em>SymPy</em>. SymPy is a Python
package for general purpose symbolic algebra. There is a physics module with several interesting submodules.
Among these, the submodule called <em>secondquant</em>, contains several  functionalities that allow us to test
our algebraic manipulations using Wick’s theorem and operators for second quantization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i,j&#39;</span><span class="p">,</span> <span class="n">below_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a,b&#39;</span><span class="p">,</span> <span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p,q&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">wicks</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-1-576a5ef5362b&gt;&quot;</span><span class="gt">, line </span><span class="mi">7</span>
    <span class="nb">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">wicks</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
          <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<p>The code defines single-particle states above and below the Fermi level, in addition to the genereal symbols
<span class="math notranslate nohighlight">\(pq\)</span> which can refer to any type of state below or above the Fermi level. Wick’s theorem is implemented between
the creation and annihilation operators <em>Fd</em> and <em>F</em>, respectively. Using the simplify option, one can lump together several Kronecker-<span class="math notranslate nohighlight">\(\delta\)</span> functions.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-9-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.17. </span>Exercise 9: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-9-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>We can expand the above Python code by defining one-body and two-body operators using  the following SymPy code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This code sets up a two-body Hamiltonian for fermions</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span>

<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">((</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we have used the <em>AntiSymmetricTensor</em> functionality, together with normal-ordering defined by the <em>NO</em> function.
Using the <em>latex</em> option, this program produces the following output</p>
<div class="math notranslate nohighlight">
\[
f^{p}_{q} \left\{a^\dagger_{p} a_{q}\right\} - \frac{1}{4} v^{qp}_{sr} \left\{a^\dagger_{p} a^\dagger_{q} a_{r} a_{s}\right\}
\]</div>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-10-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.18. </span>Exercise 10: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-10-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>We can now use this code to compute the matrix elements between two two-body Slater determinants using Wick’s theorem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">((</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c, d&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Hamiltonian</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simplify_kronecker_deltas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The result is as expected,</p>
<div class="math notranslate nohighlight">
\[
\delta_{a c} f^{b}_{d} - \delta_{a d} f^{b}_{c} - \delta_{b c} f^{a}_{d} + \delta_{b d} f^{a}_{c} + v^{ab}_{cd}.
\]</div>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-11-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.19. </span>Exercise 11: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-11-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>We can continue along these lines and define a normal-ordered Hamiltonian with respect to a given reference state.
In our first step we just define the Hamiltonian</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="c1">#define the Hamiltonian</span>
<span class="n">Hamiltonian</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="c1">#define indices for states above and below the Fermi level</span>
<span class="n">index_rule</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;below&#39;</span><span class="p">:</span>  <span class="s1">&#39;kl&#39;</span><span class="p">,</span>
     <span class="s1">&#39;above&#39;</span><span class="p">:</span>  <span class="s1">&#39;cd&#39;</span><span class="p">,</span>
     <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="s1">&#39;pqrs&#39;</span>
     <span class="p">}</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">substitute_dummies</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span><span class="n">new_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pretty_indices</span><span class="o">=</span><span class="n">index_rule</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Hamiltonian defined as:&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>which results in</p>
<div class="math notranslate nohighlight">
\[
f^{q}_{p} a^\dagger_{q} a_{p} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{s} a^\dagger_{r} a_{p} a_{q}
\]</div>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-12-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.20. </span>Exercise 12: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-12-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>In our next step we define the reference energy <span class="math notranslate nohighlight">\(E_0\)</span> and redefine the Hamiltonian by subtracting the reference energy and collecting the coefficients for all normal-ordered products (given by the <em>NO</em> function).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,),(</span><span class="n">q</span><span class="p">,))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="c1">#define the Hamiltonian</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">f</span><span class="o">*</span><span class="n">pr</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="c1">#define indices for states above and below the Fermi level</span>
<span class="n">index_rule</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;below&#39;</span><span class="p">:</span>  <span class="s1">&#39;kl&#39;</span><span class="p">,</span>
     <span class="s1">&#39;above&#39;</span><span class="p">:</span>  <span class="s1">&#39;cd&#39;</span><span class="p">,</span>
     <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="s1">&#39;pqrs&#39;</span>
     <span class="p">}</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">substitute_dummies</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span><span class="n">new_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pretty_indices</span><span class="o">=</span><span class="n">index_rule</span><span class="p">)</span>
<span class="n">E0</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">,</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">Hnormal</span><span class="o">-</span><span class="n">E0</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">WildFunction</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">,</span> <span class="n">NO</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="n">Hnormal</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">latex</span><span class="p">(</span><span class="n">Hnormal</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[
- f^{i}_{i} + f^{q}_{p} a^\dagger_{q} a_{p} - \frac{1}{4} v^{ii}_{ii} - \frac{1}{4} v^{ii}_{ii} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{r} a^\dagger_{s} a_{q} a_{p},
\]</div>
<p>again as expected, with the reference energy to be subtracted.</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-13-using-sympy-to-compute-matrix-elements">
<h2><span class="section-number">1.21. </span>Exercise 13: Using sympy to compute matrix elements<a class="headerlink" href="#exercise-13-using-sympy-to-compute-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>We can now go back to exercise 7 and define the Hamiltonian and the second-quantized representation of a  three-body Slater determinant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span> <span class="n">WildFunction</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">simplify</span>
<span class="kn">from</span> <span class="nn">sympy.physics.secondquant</span> <span class="kn">import</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fd</span><span class="p">,</span> <span class="n">wicks</span><span class="p">,</span> <span class="n">AntiSymmetricTensor</span><span class="p">,</span> <span class="n">substitute_dummies</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">evaluate_deltas</span>
<span class="c1"># setup hamiltonian</span>
<span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">AntiSymmetricTensor</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),(</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
<span class="n">pqsr</span> <span class="o">=</span> <span class="n">NO</span><span class="p">(</span><span class="n">Fd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
<span class="n">Hamiltonian</span><span class="o">=</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">pqsr</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a,b, c, d, e, f&#39;</span><span class="p">,</span><span class="n">above_fermi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">wicks</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">Hamiltonian</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Fd</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="n">keep_only_fully_contracted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simplify_kronecker_deltas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">evaluate_deltas</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">latex</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>resulting in nine terms (as expected),</p>
<div class="math notranslate nohighlight">
\[
- \delta_{a d} v^{cb}_{ef} - \delta_{a e} v^{cb}_{fd} + \delta_{a f} v^{cb}_{ed} - \delta_{b d} v^{ac}_{ef} - \delta_{b e} v^{ac}_{fd} + \delta_{b f} v^{ac}_{ed} + \delta_{c d} v^{ab}_{ef} + \delta_{c e} v^{ab}_{fd} - \delta_{c f} v^{ab}_{ed}
\]</div>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-14-diagrammatic-representation-of-hartree-fock-equations">
<h2><span class="section-number">1.22. </span>Exercise 14: Diagrammatic representation of Hartree-Fock equations<a class="headerlink" href="#exercise-14-diagrammatic-representation-of-hartree-fock-equations" title="Permalink to this headline">¶</a></h2>
<p>What is the diagrammatic representation of the HF equation?</p>
<div class="math notranslate nohighlight">
\[
-\langle\alpha_{k}|u^{HF}|\alpha_{i}\rangle+\sum_{j=1}^{n}
\left[\langle\alpha_{k}\alpha_{j}|\hat{v}|\alpha_{i}\alpha_{j}\rangle-
\langle\alpha_{k}\alpha_{j}|v|\alpha_{j}\alpha_{i}\rangle\right]=0
\]</div>
<p>(Represent <span class="math notranslate nohighlight">\((-u^{HF})\)</span> by the symbol <span class="math notranslate nohighlight">\(---\)</span>X .)</p>
<!-- --- end exercise --- -->
<!-- --- begin exercise --- -->
</div>
<div class="section" id="exercise-15-derivation-of-hartree-fock-equations">
<h2><span class="section-number">1.23. </span>Exercise 15: Derivation of Hartree-Fock equations<a class="headerlink" href="#exercise-15-derivation-of-hartree-fock-equations" title="Permalink to this headline">¶</a></h2>
<p>Consider the ground state <span class="math notranslate nohighlight">\(|\Phi\rangle\)</span>
of a bound many-particle system of fermions. Assume that we remove one particle
from the single-particle state <span class="math notranslate nohighlight">\(\lambda\)</span> and that our system ends in a new state
<span class="math notranslate nohighlight">\(|\Phi_{n}\rangle\)</span>.
Define the energy needed to remove this particle as</p>
<div class="math notranslate nohighlight">
\[
E_{\lambda}=\sum_{n}\vert\langle\Phi_{n}|a_{\lambda}|\Phi\rangle\vert^{2}(E_{0}-E_{n}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{0}\)</span> and <span class="math notranslate nohighlight">\(E_{n}\)</span>  are the ground state energies of the states
<span class="math notranslate nohighlight">\(|\Phi\rangle\)</span>  and  <span class="math notranslate nohighlight">\(|\Phi_{n}\rangle\)</span>, respectively.</p>
<ul class="simple">
<li><p>Show that</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
E_{\lambda}=\langle\Phi|a_{\lambda}^{\dagger}\left[
a_{\lambda},H \right]|\Phi\rangle,
\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the Hamiltonian of this system.</p>
<ul class="simple">
<li><p>If we assume that <span class="math notranslate nohighlight">\(\Phi\)</span> is the  Hartree-Fock result, find the</p></li>
</ul>
<p>relation between <span class="math notranslate nohighlight">\(E_{\lambda}\)</span> and the single-particle energy
<span class="math notranslate nohighlight">\(\varepsilon_{\lambda}\)</span>
for states <span class="math notranslate nohighlight">\(\lambda \leq F\)</span> and <span class="math notranslate nohighlight">\(\lambda &gt;F\)</span>, with</p>
<div class="math notranslate nohighlight">
\[
\varepsilon_{\lambda}=\langle\lambda|\hat{t}+\hat{u}|\lambda\rangle,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\langle\lambda|\hat{u}|\lambda\rangle=\sum_{\beta \leq F}
\langle\lambda\beta|\hat{v}|\lambda\beta\rangle.
\]</div>
<p>We have assumed an antisymmetrized matrix element here.
Discuss the result.</p>
<p>The Hamiltonian operator is defined as</p>
<div class="math notranslate nohighlight">
\[
H=\sum_{\alpha\beta}\langle\alpha|\hat{t}|\beta\rangle a_{\alpha}^{\dagger}a_{\beta}+
\frac{1}{2}\sum_{\alpha\beta\gamma\delta}\langle\alpha\beta|\hat{v}|\gamma\delta\rangle a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma}.
\]</div>
<!-- --- end exercise --- --></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="textbooks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Textbooks and practicalities</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="hartreefocktheory.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Hartree-Fock methods</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Morten Hjorth-Jensen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>