
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Harmonic Oscillator &#8212; Classical mechanics</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Two-body Problems" href="chapter6.html" />
    <link rel="prev" title="3. Work, Energy, Momentum and Conservation laws" href="chapter4.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Classical mechanics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY321, Classical Mechanics I, Michigan State University, Spring 2021
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Motion, Forces and Conservation Laws
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html">
   1. Space, Time, Motion, Reference Frames  and Reminder on vectors and other mathematical quantities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3.html">
   2. Basic Steps of Scientific Investigations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4.html">
   3. Work, Energy, Momentum and Conservation laws
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Harmonic Oscillator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter6.html">
   5. Two-body Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter7.html">
   6. Non-inertial Frames, Translation and Rotating Coordinate Systems
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#damped-oscillators">
   4.1. Damped Oscillators
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#underdamped-beta-omega-0">
     4.1.1. Underdamped:
     <span class="math notranslate nohighlight">
      \(\beta&lt;\omega_0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#critical-dampling-beta-omega-0">
     4.1.2. Critical dampling:
     <span class="math notranslate nohighlight">
      \(\beta=\omega_0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overdamped-beta-omega-0">
     4.1.3. Overdamped:
     <span class="math notranslate nohighlight">
      \(\beta&gt;\omega_0\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-sliding-block-code">
   4.2. Our Sliding Block Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sinusoidally-driven-oscillators">
   4.3. Sinusoidally Driven Oscillators
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternative-derivation-for-driven-oscillators">
   4.4. Alternative Derivation for Driven Oscillators
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resonance-widths-the-q-factor">
   4.5. Resonance Widths; the
   <span class="math notranslate nohighlight">
    \(Q\)
   </span>
   factor
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-studies-of-driven-oscillations">
   4.6. Numerical Studies of Driven Oscillations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differential-equations-runge-kutta-methods">
   4.7. Differential Equations, Runge-Kutta methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principle-of-superposition-and-periodic-forces-fourier-transforms">
   4.8. Principle of Superposition and Periodic Forces (Fourier Transforms)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-series">
   4.9. Fourier Series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-differential-equations-with-fouries-series">
   4.10. Solving differential equations with Fouries series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#response-to-transient-force">
   4.11. Response to Transient Force
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-classical-pendulum-and-scaling-the-equations">
   4.12. The classical pendulum and scaling the equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-on-the-pendulum">
   4.13. More on the Pendulum
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="harmonic-oscillator">
<h1><span class="section-number">4. </span>Harmonic Oscillator<a class="headerlink" href="#harmonic-oscillator" title="Permalink to this headline">¶</a></h1>
<p>The harmonic oscillator is omnipresent in physics. Although you may think
of this as being related to springs, it, or an equivalent
mathematical representation, appears in just about any problem where a
mode is sitting near its potential energy minimum. At that point,
<span class="math notranslate nohighlight">\(\partial_x V(x)=0\)</span>, and the first non-zero term (aside from a
constant) in the potential energy is that of a harmonic oscillator. In
a solid, sound modes (phonons) are built on a picture of coupled
harmonic oscillators, and in relativistic field theory the fundamental
interactions are also built on coupled oscillators positioned
infinitesimally close to one another in space. The phenomena of a
resonance of an oscillator driven at a fixed frequency plays out
repeatedly in atomic, nuclear and high-energy physics, when quantum
mechanically the evolution of a state oscillates according to
<span class="math notranslate nohighlight">\(e^{-iEt}\)</span> and exciting discrete quantum states has very similar
mathematics as exciting discrete states of an oscillator.</p>
<p>The potential energy for a single particle as a function of its position <span class="math notranslate nohighlight">\(x\)</span> can be written as a Taylor expansion about some point <span class="math notranslate nohighlight">\(x_0\)</span></p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
V(x)=V(x_0)+(x-x_0)\left.\partial_xV(x)\right|_{x_0}+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0}
+\frac{1}{3!}\left.\partial_x^3V(x)\right|_{x_0}+\cdots
\label{_auto1} \tag{1}
\end{equation}
\]</div>
<p>If the position <span class="math notranslate nohighlight">\(x_0\)</span> is at the minimum of the resonance, the first two non-zero terms of the potential are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
V(x)&amp;\approx&amp; V(x_0)+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
&amp;=&amp;V(x_0)+\frac{1}{2}k(x-x_0)^2,~~~~k\equiv \left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
F&amp;=&amp;-\partial_xV(x)=-k(x-x_0).
\end{eqnarray}
\end{split}\]</div>
<p>Put into Newton’s 2nd law (assuming <span class="math notranslate nohighlight">\(x_0=0\)</span>),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
m\ddot{x}&amp;=&amp;-kx,\\
x&amp;=&amp;A\cos(\omega_0 t-\phi),~~~\omega_0=\sqrt{k/m}.
\end{eqnarray}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> are arbitrary. Equivalently, one could have
written this as <span class="math notranslate nohighlight">\(A\cos(\omega_0 t)+B\sin(\omega_0 t)\)</span>, or as the real
part of <span class="math notranslate nohighlight">\(Ae^{i\omega_0 t}\)</span>. In this last case <span class="math notranslate nohighlight">\(A\)</span> could be an
arbitrary complex constant. Thus, there are 2 arbitrary constants
(either <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> or <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, or the real and imaginary part
of one complex constant. This is the expectation for a second order
differential equation, and also agrees with the physical expectation
that if you know a particle’s initial velocity and position you should
be able to define its future motion, and that those two arbitrary
conditions should translate to two arbitrary constants.</p>
<p>A key feature of harmonic motion is that the system repeats itself
after a time <span class="math notranslate nohighlight">\(T=1/f\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the frequency, and <span class="math notranslate nohighlight">\(\omega=2\pi f\)</span>
is the angular frequency. The period of the motion is independent of
the amplitude. However, this independence is only exact when one can
neglect higher terms of the potential, <span class="math notranslate nohighlight">\(x^3, x^4\cdots\)</span>. Once can
neglect these terms for sufficiently small amplitudes, and for larger
amplitudes the motion is no longer purely sinusoidal, and even though
the motion repeats itself, the time for repeating the motion is no
longer independent of the amplitude.</p>
<p>One can also calculate the velocity and the kinetic energy as a function of time,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{x}&amp;=&amp;-\omega_0A\sin(\omega_0 t-\phi),\\
\nonumber
K&amp;=&amp;\frac{1}{2}m\dot{x}^2=\frac{m\omega_0^2A^2}{2}\sin^2(\omega_0t-\phi),\\
\nonumber
&amp;=&amp;\frac{k}{2}A^2\sin^2(\omega_0t-\phi).
\end{eqnarray}
\end{split}\]</div>
<p>The total energy is then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
E=K+V=\frac{1}{2}m\dot{x}^2+\frac{1}{2}kx^2=\frac{1}{2}kA^2.
\label{_auto2} \tag{2}
\end{equation}
\]</div>
<p>The total energy then goes as the square of the amplitude.</p>
<p>A pendulum is an example of a harmonic oscillator. By expanding the
kinetic and potential energies for small angles find the frequency for
a pendulum of length <span class="math notranslate nohighlight">\(L\)</span> with all the mass <span class="math notranslate nohighlight">\(m\)</span> centered at the end by
writing the eq.s of motion in the form of a harmonic oscillator.</p>
<p>The potential energy and kinetic energies are (for <span class="math notranslate nohighlight">\(x\)</span> being the displacement)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
V&amp;=&amp;mgL(1-\cos\theta)\approx mgL\frac{x^2}{2L^2},\\
K&amp;=&amp;\frac{1}{2}mL^2\dot{\theta}^2\approx \frac{m}{2}\dot{x}^2.
\end{eqnarray*}
\end{split}\]</div>
<p>For small <span class="math notranslate nohighlight">\(x\)</span> Newton’s 2nd law becomes</p>
<div class="math notranslate nohighlight">
\[
m\ddot{x}=-\frac{mg}{L}x,
\]</div>
<p>and the spring constant would appear to be <span class="math notranslate nohighlight">\(k=mg/L\)</span>, which makes the
frequency equal to <span class="math notranslate nohighlight">\(\omega_0=\sqrt{g/L}\)</span>. Note that the frequency is
independent of the mass.</p>
<div class="section" id="damped-oscillators">
<h2><span class="section-number">4.1. </span>Damped Oscillators<a class="headerlink" href="#damped-oscillators" title="Permalink to this headline">¶</a></h2>
<p>We consider only the case where the damping force is proportional to
the velocity. This is counter to dragging friction, where the force is
proportional in strength to the normal force and independent of
velocity, and is also inconsistent with wind resistance, where the
magnitude of the drag force is proportional the square of the
velocity. Rolling resistance does seem to be mainly proportional to
the velocity. However, the main motivation for considering damping
forces proportional to the velocity is that the math is more
friendly. This is because the differential equation is linear,
i.e. each term is of order <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\dot{x}\)</span>, <span class="math notranslate nohighlight">\(\ddot{x}\cdots\)</span>, or even
terms with no mention of <span class="math notranslate nohighlight">\(x\)</span>, and there are no terms such as <span class="math notranslate nohighlight">\(x^2\)</span> or
<span class="math notranslate nohighlight">\(x\ddot{x}\)</span>. The equations of motion for a spring with damping force
<span class="math notranslate nohighlight">\(-b\dot{x}\)</span> are</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
m\ddot{x}+b\dot{x}+kx=0.
\label{_auto3} \tag{3}
\end{equation}
\]</div>
<p>Just to make the solution a bit less messy, we rewrite this equation as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:dampeddiffyq"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:dampeddiffyq} \tag{4}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=0,~~~~\beta\equiv b/2m,~\omega_0\equiv\sqrt{k/m}.
\end{equation}
\]</div>
<p>Both <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> have dimensions of inverse time. To find solutions (see appendix C in the text) you must make an educated guess at the form of the solution. To do this, first realize that the solution will need an arbitrary normalization <span class="math notranslate nohighlight">\(A\)</span> because the equation is linear. Secondly, realize that if the form is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto4"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x=Ae^{rt}
\label{_auto4} \tag{5}
\end{equation}
\]</div>
<p>that each derivative simply brings out an extra power of <span class="math notranslate nohighlight">\(r\)</span>. This
means that the <span class="math notranslate nohighlight">\(Ae^{rt}\)</span> factors out and one can simply solve for an
equation for <span class="math notranslate nohighlight">\(r\)</span>. Plugging this form into Eq. (<a class="reference external" href="#eq:dampeddiffyq">4</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="_auto5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
r^2+2\beta r+\omega_0^2=0.
\label{_auto5} \tag{6}
\end{equation}
\]</div>
<p>Because this is a quadratic equation there will be two solutions,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
r=-\beta\pm\sqrt{\beta^2-\omega_0^2}.
\label{_auto6} \tag{7}
\end{equation}
\]</div>
<p>We refer to the two solutions as <span class="math notranslate nohighlight">\(r_1\)</span> and <span class="math notranslate nohighlight">\(r_2\)</span> corresponding to the
<span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(-\)</span> roots. As expected, there should be two arbitrary
constants involved in the solution,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x=A_1e^{r_1t}+A_2e^{r_2t},
\label{_auto7} \tag{8}
\end{equation}
\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span> are determined by initial
conditions.</p>
<p>The roots listed above, <span class="math notranslate nohighlight">\(\sqrt{\omega_0^2-\beta_0^2}\)</span>, will be
imaginary if the damping is small and <span class="math notranslate nohighlight">\(\beta&lt;\omega_0\)</span>. In that case,
<span class="math notranslate nohighlight">\(r\)</span> is complex and the factor <span class="math notranslate nohighlight">\(e{rt}\)</span> will have some oscillatory
behavior. If the roots are real, there will only be exponentially
decaying solutions. There are three cases:</p>
<div class="section" id="underdamped-beta-omega-0">
<h3><span class="section-number">4.1.1. </span>Underdamped: <span class="math notranslate nohighlight">\(\beta&lt;\omega_0\)</span><a class="headerlink" href="#underdamped-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x&amp;=&amp;A_1e^{-\beta t}e^{i\omega't}+A_2e^{-\beta t}e^{-i\omega't},~~\omega'\equiv\sqrt{\omega_0^2-\beta^2}\\
\nonumber
&amp;=&amp;(A_1+A_2)e^{-\beta t}\cos\omega't+i(A_1-A_2)e^{-\beta t}\sin\omega't.
\end{eqnarray}
\end{split}\]</div>
<p>Here we have made use of the identity
<span class="math notranslate nohighlight">\(e^{i\omega't}=\cos\omega't+i\sin\omega't\)</span>. Because the constants are
arbitrary, and because the real and imaginary parts are both solutions
individually, we can simply consider the real part of the solution
alone:</p>
<!-- Equation labels as ordinary links -->
<div id="eq:homogsolution"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:homogsolution} \tag{9}
x&amp;=&amp;B_1e^{-\beta t}\cos\omega't+B_2e^{-\beta t}\sin\omega't,\\
\nonumber 
\omega'&amp;\equiv&amp;\sqrt{\omega_0^2-\beta^2}.
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="critical-dampling-beta-omega-0">
<h3><span class="section-number">4.1.2. </span>Critical dampling: <span class="math notranslate nohighlight">\(\beta=\omega_0\)</span><a class="headerlink" href="#critical-dampling-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<p>In this case the two terms involving <span class="math notranslate nohighlight">\(r_1\)</span> and <span class="math notranslate nohighlight">\(r_2\)</span> are identical
because <span class="math notranslate nohighlight">\(\omega'=0\)</span>. Because we need to arbitrary constants, there
needs to be another solution. This is found by simply guessing, or by
taking the limit of <span class="math notranslate nohighlight">\(\omega'\rightarrow 0\)</span> from the underdamped
solution. The solution is then</p>
<!-- Equation labels as ordinary links -->
<div id="eq:criticallydamped"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:criticallydamped} \tag{10}
x=Ae^{-\beta t}+Bte^{-\beta t}.
\end{equation}
\]</div>
<p>The critically damped solution is interesting because the solution
approaches zero quickly, but does not oscillate. For a problem with
zero initial velocity, the solution never crosses zero. This is a good
choice for designing shock absorbers or swinging doors.</p>
</div>
<div class="section" id="overdamped-beta-omega-0">
<h3><span class="section-number">4.1.3. </span>Overdamped: <span class="math notranslate nohighlight">\(\beta&gt;\omega_0\)</span><a class="headerlink" href="#overdamped-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
x&amp;=&amp;A_1\exp{-(\beta+\sqrt{\beta^2-\omega_0^2})t}+A_2\exp{-(\beta-\sqrt{\beta^2-\omega_0^2})t}
\end{eqnarray}
\]</div>
<p>This solution will also never pass the origin more than once, and then
only if the initial velocity is strong and initially toward zero.</p>
<p>Given <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(\omega_0\)</span>, find <span class="math notranslate nohighlight">\(x(t)\)</span> for a particle whose
initial position is <span class="math notranslate nohighlight">\(x=0\)</span> and has initial velocity <span class="math notranslate nohighlight">\(v_0\)</span> (assuming an
underdamped solution).</p>
<p>The solution is of the form,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;e^{-\beta t}\left[A_1\cos(\omega' t)+A_2\sin\omega't\right],\\
\dot{x}&amp;=&amp;-\beta x+\omega'e^{-\beta t}\left[-A_1\sin\omega't+A_2\cos\omega't\right].\\
\omega'&amp;\equiv&amp;\sqrt{\omega_0^2-\beta^2},~~~\beta\equiv b/2m.
\end{eqnarray*}
\end{split}\]</div>
<p>From the initial conditions, <span class="math notranslate nohighlight">\(A_1=0\)</span> because <span class="math notranslate nohighlight">\(x(0)=0\)</span> and <span class="math notranslate nohighlight">\(\omega'A_2=v_0\)</span>. So</p>
<div class="math notranslate nohighlight">
\[
x=\frac{v_0}{\omega'}e^{-\beta t}\sin\omega't.
\]</div>
</div>
</div>
<div class="section" id="our-sliding-block-code">
<h2><span class="section-number">4.2. </span>Our Sliding Block Code<a class="headerlink" href="#our-sliding-block-code" title="Permalink to this headline">¶</a></h2>
<p>Here we study first the case without additional friction term and scale our equation
in terms of a dimensionless time <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>Let us remind ourselves about the differential equation we want to solve (the general case with damping due to friction)</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2x}{dt^2} + b\frac{dx}{dt}+kx(t) =0.
\]</div>
<p>We divide by <span class="math notranslate nohighlight">\(m\)</span> and introduce <span class="math notranslate nohighlight">\(\omega_0^2=\sqrt{k/m}\)</span> and obtain</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2} + \frac{b}{m}\frac{dx}{dt}+\omega_0^2x(t) =0.
\]</div>
<p>Thereafter we introduce a dimensionless time <span class="math notranslate nohighlight">\(\tau = t\omega_0\)</span> (check
that the dimensionality is correct) and rewrite our equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =0,
\]</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =0.
\]</div>
<p>We then define <span class="math notranslate nohighlight">\(\gamma = b/(2m\omega_0)\)</span> and rewrite our equations as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + 2\gamma\frac{dx}{d\tau}+x(\tau) =0.
\]</div>
<p>This is the equation we will code below. The first version employs the Euler-Cromer method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions as simple one-dimensional arrays of time</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Start integrating using Euler-Cromer&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update velocity, time and position</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#ax.set_xlim(0, tfinal)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;BlockEulerCromer&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter5_49_0.png" src="_images/chapter5_49_0.png" />
</div>
</div>
<p>When setting up the value of <span class="math notranslate nohighlight">\(\gamma\)</span> we see that for <span class="math notranslate nohighlight">\(\gamma=0\)</span> we get the simple oscillatory motion with no damping.
Choosing <span class="math notranslate nohighlight">\(\gamma &lt; 1\)</span> leads to the classical underdamped case with oscillatory motion, but where the motion comes to an end.</p>
<p>Choosing <span class="math notranslate nohighlight">\(\gamma =1\)</span> leads to what normally is called critical damping and <span class="math notranslate nohighlight">\(\gamma&gt; 1\)</span> leads to critical overdamping.
Try it out and try also to change the initial position and velocity. Setting <span class="math notranslate nohighlight">\(\gamma=1\)</span>
yields a situation, as discussed above, where the solution approaches quickly zero and does not oscillate. With zero initial velocity it will never cross zero.</p>
</div>
<div class="section" id="sinusoidally-driven-oscillators">
<h2><span class="section-number">4.3. </span>Sinusoidally Driven Oscillators<a class="headerlink" href="#sinusoidally-driven-oscillators" title="Permalink to this headline">¶</a></h2>
<p>Here, we consider the force</p>
<!-- Equation labels as ordinary links -->
<div id="_auto8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F=-kx-b\dot{x}+F_0\cos\omega t,
\label{_auto8} \tag{11}
\end{equation}
\]</div>
<p>which leads to the differential equation</p>
<!-- Equation labels as ordinary links -->
<div id="eq:drivenosc"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:drivenosc} \tag{12}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=(F_0/m)\cos\omega t.
\end{equation}
\]</div>
<p>Consider a single solution with no arbitrary constants, which we will
call a {\it particular solution}, <span class="math notranslate nohighlight">\(x_p(t)\)</span>. It should be emphasized
that this is {\bf A} particular solution, because there exists an
infinite number of such solutions because the general solution should
have two arbitrary constants. Now consider solutions to the same
equation without the driving term, which include two arbitrary
constants. These are called either {\it homogenous solutions} or {\it
complementary solutions}, and were given in the previous section,
e.g. Eq. (<a class="reference external" href="#eq:homogsolution">9</a>) for the underdamped case. The
homogenous solution already incorporates the two arbitrary constants,
so any sum of a homogenous solution and a particular solution will
represent the {\it general solution} of the equation. The general
solution incorporates the two arbitrary constants <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> to
accommodate the two initial conditions. One could have picked a
different particular solution, i.e. the original particular solution
plus any homogenous solution with the arbitrary constants <span class="math notranslate nohighlight">\(A_p\)</span> and
<span class="math notranslate nohighlight">\(B_p\)</span> chosen at will. When one adds in the homogenous solution, which
has adjustable constants with arbitrary constants <span class="math notranslate nohighlight">\(A'\)</span> and <span class="math notranslate nohighlight">\(B'\)</span>, to
the new particular solution, one can get the same general solution by
simply adjusting the new constants such that <span class="math notranslate nohighlight">\(A'+A_p=A\)</span> and
<span class="math notranslate nohighlight">\(B'+B_p=B\)</span>. Thus, the choice of <span class="math notranslate nohighlight">\(A_p\)</span> and <span class="math notranslate nohighlight">\(B_p\)</span> are irrelevant, and
when choosing the particular solution it is best to make the simplest
choice possible.</p>
<p>To find a particular solution, one first guesses at the form,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:partform"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:partform} \tag{13}
x_p(t)=D\cos(\omega t-\delta),
\end{equation}
\]</div>
<p>and rewrite the differential equation as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto9"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
D\left\{-\omega^2\cos(\omega t-\delta)-2\beta\omega\sin(\omega t-\delta)+\omega_0^2\cos(\omega t-\delta)\right\}=\frac{F_0}{m}\cos(\omega t).
\label{_auto9} \tag{14}
\end{equation}
\]</div>
<p>One can now use angle addition formulas to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{(-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta)\cos(\omega t)\right.&amp;&amp;\\
\nonumber
\left.+(-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta)\sin(\omega t)\right\}
&amp;=&amp;\frac{F_0}{m}\cos(\omega t).
\end{eqnarray}
\end{split}\]</div>
<p>Both the <span class="math notranslate nohighlight">\(\cos\)</span> and <span class="math notranslate nohighlight">\(\sin\)</span> terms need to equate if the expression is to hold at all times. Thus, this becomes two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta\right\}&amp;=&amp;\frac{F_0}{m}\\
\nonumber
-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>After dividing by <span class="math notranslate nohighlight">\(\cos\delta\)</span>, the lower expression leads to</p>
<!-- Equation labels as ordinary links -->
<div id="_auto10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto10} \tag{15}
\end{equation}
\]</div>
<p>Using the identities <span class="math notranslate nohighlight">\(\tan^2+1=\csc^2\)</span> and <span class="math notranslate nohighlight">\(\sin^2+\cos^2=1\)</span>, one can also express <span class="math notranslate nohighlight">\(\sin\delta\)</span> and <span class="math notranslate nohighlight">\(\cos\delta\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\sin\delta&amp;=&amp;\frac{2\beta\omega}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}},\\
\nonumber
\cos\delta&amp;=&amp;\frac{(\omega_0^2-\omega^2)}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}
\end{eqnarray}
\end{split}\]</div>
<p>Inserting the expressions for <span class="math notranslate nohighlight">\(\cos\delta\)</span> and <span class="math notranslate nohighlight">\(\sin\delta\)</span> into the expression for <span class="math notranslate nohighlight">\(D\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Ddrive"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:Ddrive} \tag{16}
D=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}.
\end{equation}
\]</div>
<p>For a given initial condition, e.g. initial displacement and velocity,
one must add the homogenous solution then solve for the two arbitrary
constants. However, because the homogenous solutions decay with time
as <span class="math notranslate nohighlight">\(e^{-\beta t}\)</span>, the particular solution is all that remains at
large times, and is therefore the steady state solution. Because the
arbitrary constants are all in the homogenous solution, all memory of
the initial conditions are lost at large times, <span class="math notranslate nohighlight">\(t&gt;&gt;1/\beta\)</span>.</p>
<p>The amplitude of the motion, <span class="math notranslate nohighlight">\(D\)</span>, is linearly proportional to the
driving force (<span class="math notranslate nohighlight">\(F_0/m\)</span>), but also depends on the driving frequency
<span class="math notranslate nohighlight">\(\omega\)</span>. For small <span class="math notranslate nohighlight">\(\beta\)</span> the maximum will occur at
<span class="math notranslate nohighlight">\(\omega=\omega_0\)</span>. This is referred to as a resonance. In the limit
<span class="math notranslate nohighlight">\(\beta\rightarrow 0\)</span> the amplitude at resonance approaches infinity.</p>
</div>
<div class="section" id="alternative-derivation-for-driven-oscillators">
<h2><span class="section-number">4.4. </span>Alternative Derivation for Driven Oscillators<a class="headerlink" href="#alternative-derivation-for-driven-oscillators" title="Permalink to this headline">¶</a></h2>
<p>Here, we derive the same expressions as in Equations (<a class="reference external" href="#eq:partform">13</a>) and (<a class="reference external" href="#eq:Ddrive">16</a>) but express the driving forces as</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(t)&amp;=&amp;F_0e^{i\omega t},
\end{eqnarray}
\]</div>
<p>rather than as <span class="math notranslate nohighlight">\(F_0\cos\omega t\)</span>. The real part of <span class="math notranslate nohighlight">\(F\)</span> is the same as before. For the differential equation,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:compdrive"></div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\label{eq:compdrive} \tag{17}
\ddot{x}+2\beta\dot{x}+\omega_0^2x&amp;=&amp;\frac{F_0}{m}e^{i\omega t},
\end{eqnarray}
\]</div>
<p>one can treat <span class="math notranslate nohighlight">\(x(t)\)</span> as an imaginary function. Because the operations
<span class="math notranslate nohighlight">\(d^2/dt^2\)</span> and <span class="math notranslate nohighlight">\(d/dt\)</span> are real and thus do not mix the real and
imaginary parts of <span class="math notranslate nohighlight">\(x(t)\)</span>, Eq. (<a class="reference external" href="#eq:compdrive">17</a>) is effectively 2
equations. Because <span class="math notranslate nohighlight">\(e^{\omega t}=\cos\omega t+i\sin\omega t\)</span>, the real
part of the solution for <span class="math notranslate nohighlight">\(x(t)\)</span> gives the solution for a driving force
<span class="math notranslate nohighlight">\(F_0\cos\omega t\)</span>, and the imaginary part of <span class="math notranslate nohighlight">\(x\)</span> corresponds to the
case where the driving force is <span class="math notranslate nohighlight">\(F_0\sin\omega t\)</span>. It is rather easy
to solve for the complex <span class="math notranslate nohighlight">\(x\)</span> in this case, and by taking the real part
of the solution, one finds the answer for the <span class="math notranslate nohighlight">\(\cos\omega t\)</span> driving
force.</p>
<p>We assume a simple form for the particular solution</p>
<!-- Equation labels as ordinary links -->
<div id="_auto11"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_p=De^{i\omega t},
\label{_auto11} \tag{18}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is a complex constant.</p>
<p>From Eq. (<a class="reference external" href="#eq:compdrive">17</a>) one inserts the form for <span class="math notranslate nohighlight">\(x_p\)</span> above to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{-\omega^2+2i\beta\omega+\omega_0^2\right\}e^{i\omega t}=(F_0/m)e^{i\omega t},\\
\nonumber
D=\frac{F_0/m}{(\omega_0^2-\omega^2)+2i\beta\omega}.
\end{eqnarray}
\end{split}\]</div>
<p>The norm and phase for <span class="math notranslate nohighlight">\(D=|D|e^{-i\delta}\)</span> can be read by inspection,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
|D|=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}},~~~~\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto12} \tag{19}
\end{equation}
\]</div>
<p>This is the same expression for <span class="math notranslate nohighlight">\(\delta\)</span> as before. One then finds <span class="math notranslate nohighlight">\(x_p(t)\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fastdriven1"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fastdriven1} \tag{20}
x_p(t)&amp;=&amp;\Re\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&amp;=&amp;\frac{(F_0/m)\cos(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
\end{split}\]</div>
<p>This is the same answer as before.
If one wished to solve for the case where <span class="math notranslate nohighlight">\(F(t)= F_0\sin\omega t\)</span>, the imaginary part of the solution would work</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fastdriven2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fastdriven2} \tag{21}
x_p(t)&amp;=&amp;\Im\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&amp;=&amp;\frac{(F_0/m)\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
\end{split}\]</div>
<p>Consider the damped and driven harmonic oscillator worked out above. Given <span class="math notranslate nohighlight">\(F_0, m,\beta\)</span> and <span class="math notranslate nohighlight">\(\omega_0\)</span>, solve for the complete solution <span class="math notranslate nohighlight">\(x(t)\)</span> for the case where <span class="math notranslate nohighlight">\(F=F_0\sin\omega t\)</span> with initial conditions <span class="math notranslate nohighlight">\(x(t=0)=0\)</span> and <span class="math notranslate nohighlight">\(v(t=0)=0\)</span>. Assume the underdamped case.</p>
<p>The general solution including the arbitrary constants includes both the homogenous and particular solutions,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
x(t)&amp;=&amp;\frac{F_0}{m}\frac{\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}
+A\cos\omega't e^{-\beta t}+B\sin\omega't e^{-\beta t}.
\end{eqnarray*}
\]</div>
<p>The quantities <span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\omega'\)</span> are given earlier in the
section, <span class="math notranslate nohighlight">\(\omega'=\sqrt{\omega_0^2-\beta^2},
\delta=\tan^{-1}(2\beta\omega/(\omega_0^2-\omega^2)\)</span>. Here, solving
the problem means finding the arbitrary constants <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span>. Satisfying the initial conditions for the initial position and
velocity:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x(t=0)=0&amp;=&amp;-\eta\sin\delta+A,\\
v(t=0)=0&amp;=&amp;\omega\eta\cos\delta-\beta A+\omega'B,\\
\eta&amp;\equiv&amp;\frac{F_0}{m}\frac{1}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray*}
\end{split}\]</div>
<p>The problem is now reduced to 2 equations and 2 unknowns, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. The solution is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
A&amp;=&amp; \eta\sin\delta ,~~~B=\frac{-\omega\eta\cos\delta+\beta\eta\sin\delta}{\omega'}.
\end{eqnarray}
\]</div>
</div>
<div class="section" id="resonance-widths-the-q-factor">
<h2><span class="section-number">4.5. </span>Resonance Widths; the <span class="math notranslate nohighlight">\(Q\)</span> factor<a class="headerlink" href="#resonance-widths-the-q-factor" title="Permalink to this headline">¶</a></h2>
<p>From the previous two sections, the particular solution for a driving force, <span class="math notranslate nohighlight">\(F=F_0\cos\omega t\)</span>, is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_p(t)&amp;=&amp;\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}\cos(\omega_t-\delta),\\
\nonumber
\delta&amp;=&amp;\tan^{-1}\left(\frac{2\beta\omega}{\omega_0^2-\omega^2}\right).
\end{eqnarray}
\end{split}\]</div>
<p>If one fixes the driving frequency <span class="math notranslate nohighlight">\(\omega\)</span> and adjusts the
fundamental frequency <span class="math notranslate nohighlight">\(\omega_0=\sqrt{k/m}\)</span>, the maximum amplitude
occurs when <span class="math notranslate nohighlight">\(\omega_0=\omega\)</span> because that is when the term from the
denominator <span class="math notranslate nohighlight">\((\omega_0^2-\omega^2)^2+4\omega^2\beta^2\)</span> is at a
minimum. This is akin to dialing into a radio station. However, if one
fixes <span class="math notranslate nohighlight">\(\omega_0\)</span> and adjusts the driving frequency one minimize with
respect to <span class="math notranslate nohighlight">\(\omega\)</span>, e.g. set</p>
<!-- Equation labels as ordinary links -->
<div id="_auto13"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{d\omega}\left[(\omega_0^2-\omega^2)^2+4\omega^2\beta^2\right]=0,
\label{_auto13} \tag{22}
\end{equation}
\]</div>
<p>and one finds that the maximum amplitude occurs when
<span class="math notranslate nohighlight">\(\omega=\sqrt{\omega_0^2-2\beta^2}\)</span>. If <span class="math notranslate nohighlight">\(\beta\)</span> is small relative to
<span class="math notranslate nohighlight">\(\omega_0\)</span>, one can simply state that the maximum amplitude is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_{\rm max}\approx\frac{F_0}{2m\beta \omega_0}.
\label{_auto14} \tag{23}
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{4\omega^2\beta^2}{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}=\frac{1}{2}.
\end{eqnarray}
\]</div>
<p>For small damping this occurs when <span class="math notranslate nohighlight">\(\omega=\omega_0\pm \beta\)</span>, so the <span class="math notranslate nohighlight">\(FWHM\approx 2\beta\)</span>. For the purposes of tuning to a specific frequency, one wants the width to be as small as possible. The ratio of <span class="math notranslate nohighlight">\(\omega_0\)</span> to <span class="math notranslate nohighlight">\(FWHM\)</span> is known as the {\it quality} factor, or <span class="math notranslate nohighlight">\(Q\)</span> factor,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
Q\equiv \frac{\omega_0}{2\beta}.
\label{_auto15} \tag{24}
\end{equation}
\]</div>
</div>
<div class="section" id="numerical-studies-of-driven-oscillations">
<h2><span class="section-number">4.6. </span>Numerical Studies of Driven Oscillations<a class="headerlink" href="#numerical-studies-of-driven-oscillations" title="Permalink to this headline">¶</a></h2>
<p>Solving the problem of driven oscillations numerically gives us much
more flexibility to study different types of driving forces. We can
reuse our earlier code by simply adding a driving force. If we stay in
the <span class="math notranslate nohighlight">\(x\)</span>-direction only this can be easily done by adding a term
<span class="math notranslate nohighlight">\(F_{\mathrm{ext}}(x,t)\)</span>. Note that we have kept it rather general
here, allowing for both a spatial and a temporal dependence.</p>
<p>Before we dive into the code, we need to briefly remind ourselves
about the equations we started with for the case with damping, namely</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2x}{dt^2} + b\frac{dx}{dt}+kx(t) =0,
\]</div>
<p>with no external force applied to the system.</p>
<p>Let us now for simplicty assume that our external force is given by</p>
<div class="math notranslate nohighlight">
\[
F_{\mathrm{ext}}(t) = F_0\cos{(\omega t)},
\]</div>
<p>where <span class="math notranslate nohighlight">\(F_0\)</span> is a constant (what is its dimension?) and <span class="math notranslate nohighlight">\(\omega\)</span> is the frequency of the applied external driving force.
<strong>Small question:</strong> would you expect energy to be conserved now?</p>
<p>Introducing the external force into our lovely differential equation
and dividing by <span class="math notranslate nohighlight">\(m\)</span> and introducing <span class="math notranslate nohighlight">\(\omega_0^2=\sqrt{k/m}\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2} + \frac{b}{m}\frac{dx}{dt}+\omega_0^2x(t) =\frac{F_0}{m}\cos{(\omega t)},
\]</div>
<p>Thereafter we introduce a dimensionless time <span class="math notranslate nohighlight">\(\tau = t\omega_0\)</span>
and a dimensionless frequency <span class="math notranslate nohighlight">\(\tilde{\omega}=\omega/\omega_0\)</span>. We have then</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =\frac{F_0}{m\omega_0^2}\cos{(\tilde{\omega}\tau)},
\]</div>
<p>Introducing a new amplitude <span class="math notranslate nohighlight">\(\tilde{F} =F_0/(m\omega_0^2)\)</span> (check dimensionality again) we have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =\tilde{F}\cos{(\tilde{\omega}\tau)}.
\]</div>
<p>Our final step, as we did in the case of various types of damping, is
to define <span class="math notranslate nohighlight">\(\gamma = b/(2m\omega_0)\)</span> and rewrite our equations as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + 2\gamma\frac{dx}{d\tau}+x(\tau) =\tilde{F}\cos{(\tilde{\omega}\tau)}.
\]</div>
<p>This is the equation we will code below using the Euler-Cromer method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions as one-dimensional arrays of time</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Omegatilde</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Ftilde</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Start integrating using Euler-Cromer&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">Ftilde</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Omegatilde</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;ForcedBlockEulerCromer&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter5_110_0.png" src="_images/chapter5_110_0.png" />
</div>
</div>
<p>In the above example we have focused on the Euler-Cromer method. This
method has a local truncation error which is proportional to <span class="math notranslate nohighlight">\(\Delta t^2\)</span>
and thereby a global error which is proportional to <span class="math notranslate nohighlight">\(\Delta t\)</span>.
We can improve this by using the Runge-Kutta family of
methods. The widely popular Runge-Kutta to fourth order or just <strong>RK4</strong>
has indeed a much better truncation error. The RK4 method has a global
error which is proportional to <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>Let us revisit this method and see how we can implement it for the above example.</p>
</div>
<div class="section" id="differential-equations-runge-kutta-methods">
<h2><span class="section-number">4.7. </span>Differential Equations, Runge-Kutta methods<a class="headerlink" href="#differential-equations-runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<p>Runge-Kutta (RK) methods are based on Taylor expansion formulae, but yield
in general better algorithms for solutions of an ordinary differential equation.
The basic philosophy is that it provides an intermediate step in the computation of <span class="math notranslate nohighlight">\(y_{i+1}\)</span>.</p>
<p>To see this, consider first the following definitions</p>
<!-- Equation labels as ordinary links -->
<div id="_auto16"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dy}{dt}=f(t,y),  
\label{_auto16} \tag{25}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y(t)=\int f(t,y) dt,  
\label{_auto17} \tag{26}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto18"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{i+1}=y_i+ \int_{t_i}^{t_{i+1}} f(t,y) dt.
\label{_auto18} \tag{27}
\end{equation}
\]</div>
<p>To demonstrate the philosophy behind RK methods, let us consider
the second-order RK method, RK2.
The first approximation consists in Taylor expanding <span class="math notranslate nohighlight">\(f(t,y)\)</span>
around the center of the integration interval <span class="math notranslate nohighlight">\(t_i\)</span> to <span class="math notranslate nohighlight">\(t_{i+1}\)</span>,
that is, at <span class="math notranslate nohighlight">\(t_i+h/2\)</span>, <span class="math notranslate nohighlight">\(h\)</span> being the step.
Using the midpoint formula for an integral,
defining <span class="math notranslate nohighlight">\(y(t_i+h/2) = y_{i+1/2}\)</span> and<br />
<span class="math notranslate nohighlight">\(t_i+h/2 = t_{i+1/2}\)</span>, we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="_auto19"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\int_{t_i}^{t_{i+1}} f(t,y) dt \approx hf(t_{i+1/2},y_{i+1/2}) +O(h^3).
\label{_auto19} \tag{28}
\end{equation}
\]</div>
<p>This means in turn that we have</p>
<!-- Equation labels as ordinary links -->
<div id="_auto20"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{i+1}=y_i + hf(t_{i+1/2},y_{i+1/2}) +O(h^3).
\label{_auto20} \tag{29}
\end{equation}
\]</div>
<p>However, we do not know the value of   <span class="math notranslate nohighlight">\(y_{i+1/2}\)</span>. Here comes thus the next approximation, namely, we use Euler’s
method to approximate <span class="math notranslate nohighlight">\(y_{i+1/2}\)</span>. We have then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto21"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{(i+1/2)}=y_i + \frac{h}{2}\frac{dy}{dt}=y(t_i) + \frac{h}{2}f(t_i,y_i).
\label{_auto21} \tag{30}
\end{equation}
\]</div>
<p>This means that we can define the following algorithm for
the second-order Runge-Kutta method, RK2.</p>
<p>6
0</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<!-- Equation labels as ordinary links -->
<div id="_auto23"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
k_2=hf(t_{i+1/2},y_i+k_1/2),
\label{_auto23} \tag{32}
\end{equation}
\]</div>
<p>with the final value</p>
<!-- Equation labels as ordinary links -->
<div id="_auto24"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
y_{i+i}\approx y_i + k_2 +O(h^3). 
\label{_auto24} \tag{33}
\end{equation}
\]</div>
<p>The difference between the previous one-step methods
is that we now need an intermediate step in our evaluation,
namely <span class="math notranslate nohighlight">\(t_i+h/2 = t_{(i+1/2)}\)</span> where we evaluate the derivative <span class="math notranslate nohighlight">\(f\)</span>.
This involves more operations, but the gain is a better stability
in the solution.</p>
<p>The fourth-order Runge-Kutta, RK4, has the following algorithm</p>
<p>6
3</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
k_3=hf(t_i+h/2,y_i+k_2/2)\hspace{0.5cm}   k_4=hf(t_i+h,y_i+k_3)
\]</div>
<p>with the final result</p>
<div class="math notranslate nohighlight">
\[
y_{i+1}=y_i +\frac{1}{6}\left( k_1 +2k_2+2k_3+k_4\right).
\]</div>
<p>Thus, the algorithm consists in first calculating <span class="math notranslate nohighlight">\(k_1\)</span>
with <span class="math notranslate nohighlight">\(t_i\)</span>, <span class="math notranslate nohighlight">\(y_1\)</span> and <span class="math notranslate nohighlight">\(f\)</span> as inputs. Thereafter, we increase the step
size by <span class="math notranslate nohighlight">\(h/2\)</span> and calculate <span class="math notranslate nohighlight">\(k_2\)</span>, then <span class="math notranslate nohighlight">\(k_3\)</span> and finally <span class="math notranslate nohighlight">\(k_4\)</span>. The global error goes as <span class="math notranslate nohighlight">\(O(h^4)\)</span>.</p>
<p>However, at this stage, if we keep adding different methods in our
main program, the code will quickly become messy and ugly. Before we
proceed thus, we will now introduce functions that enbody the various
methods for solving differential equations. This means that we can
separate out these methods in own functions and files (and later as classes and more
generic functions) and simply call them when needed. Similarly, we
could easily encapsulate various forces or other quantities of
interest in terms of functions. To see this, let us bring up the code
we developed above for the simple sliding block, but now only with the simple forward Euler method. We introduce
two functions, one for the simple Euler method and one for the
force.</p>
<p>Note that here the forward Euler method does not know the specific force function to be called.
It receives just an input the name. We can easily change the force by adding another function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ForwardEuler</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SpringForce</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
<span class="c1">#   note here that we have divided by mass and we return the acceleration</span>
    <span class="k">return</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">Ftilde</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">Omegatilde</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It is easy to add a new method like the Euler-Cromer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ForwardEulerCromer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>and the Velocity Verlet method (be careful with time-dependence here, it is not an ideal method for non-conservative forces))</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">VelocityVerlet</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">a</span>
        <span class="n">anew</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can now add the Runge-Kutta2 method via a new function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RK2</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1"># Setting up k1</span>
        <span class="n">k1x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">k1v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># Setting up k2</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k2x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k2v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Final result</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2x</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2v</span>
	<span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-7-ffedbda27704&gt;&quot;</span><span class="gt">, line </span><span class="mi">14</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span>
                        <span class="o">^</span>
<span class="ne">TabError</span>: inconsistent use of tabs and spaces in indentation
</pre></div>
</div>
</div>
</div>
<p>Finally, we can now add the Runge-Kutta2 method via a new function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1"># Setting up k1</span>
        <span class="n">k1x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">k1v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># Setting up k2</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k2x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k2v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Setting up k3</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k3x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k3v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Setting up k4</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k3v</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k3x</span>
        <span class="n">k4x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k4v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># Final result</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k1x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k2x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k3x</span><span class="o">+</span><span class="n">k4x</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k1v</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k2v</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k3v</span><span class="o">+</span><span class="n">k4v</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>The Runge-Kutta family of methods are particularly useful when we have a time-dependent acceleration.
If we have forces which depend only the spatial degrees of freedom (no velocity and/or time-dependence), then energy conserving methods like the Velocity Verlet or the Euler-Cromer method are preferred. As soon as we introduce an explicit time-dependence and/or add dissipitave forces like friction or air resistance, then methods like the family of Runge-Kutta methods are well suited for this.
The code below uses the Runge-Kutta4 methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions (can change to more than one dim)</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Omegatilde</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Ftilde</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="c1"># Note that we define the force function as a SpringForce</span>
<span class="n">RK4</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">SpringForce</span><span class="p">)</span>

<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;ForcedBlockRK4&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="principle-of-superposition-and-periodic-forces-fourier-transforms">
<h2><span class="section-number">4.8. </span>Principle of Superposition and Periodic Forces (Fourier Transforms)<a class="headerlink" href="#principle-of-superposition-and-periodic-forces-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>If one has several driving forces, <span class="math notranslate nohighlight">\(F(t)=\sum_n F_n(t)\)</span>, one can find
the particular solution to each <span class="math notranslate nohighlight">\(F_n\)</span>, <span class="math notranslate nohighlight">\(x_{pn}(t)\)</span>, and the particular
solution for the entire driving force is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto25"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_p(t)=\sum_nx_{pn}(t).
\label{_auto25} \tag{34}
\end{equation}
\]</div>
<p>This is known as the principal of superposition. It only applies when
the homogenous equation is linear. If there were an anharmonic term
such as <span class="math notranslate nohighlight">\(x^3\)</span> in the homogenous equation, then when one summed various
solutions, <span class="math notranslate nohighlight">\(x=(\sum_n x_n)^2\)</span>, one would get cross
terms. Superposition is especially useful when <span class="math notranslate nohighlight">\(F(t)\)</span> can be written
as a sum of sinusoidal terms, because the solutions for each
sinusoidal (sine or cosine)  term is analytic, as we saw above.</p>
<p>Driving forces are often periodic, even when they are not
sinusoidal. Periodicity implies that for some time <span class="math notranslate nohighlight">\(\tau\)</span></p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(t+\tau)=F(t). 
\end{eqnarray}
\]</div>
<p>One example of a non-sinusoidal periodic force is a square wave. Many
components in electric circuits are non-linear, e.g. diodes, which
makes many wave forms non-sinusoidal even when the circuits are being
driven by purely sinusoidal sources.</p>
<p>The code here shows a typical example of such a square wave generated using the functionality included in the <strong>scipy</strong> Python package. We have used a period of <span class="math notranslate nohighlight">\(\tau=0.2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># number of points                                                                                       </span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># start and final times                                                                                  </span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tn</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Period                                                                                                 </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">+</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SqrSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For the sinusoidal example studied in the previous subsections the
period is <span class="math notranslate nohighlight">\(\tau=2\pi/\omega\)</span>. However, higher harmonics can also
satisfy the periodicity requirement. In general, any force that
satisfies the periodicity requirement can be expressed as a sum over
harmonics,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto26"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F(t)=\frac{f_0}{2}+\sum_{n&gt;0} f_n\cos(2n\pi t/\tau)+g_n\sin(2n\pi t/\tau).
\label{_auto26} \tag{35}
\end{equation}
\]</div>
<p>From the previous subsection, one can write down the answer for
<span class="math notranslate nohighlight">\(x_{pn}(t)\)</span>, by substituting <span class="math notranslate nohighlight">\(f_n/m\)</span> or <span class="math notranslate nohighlight">\(g_n/m\)</span> for <span class="math notranslate nohighlight">\(F_0/m\)</span> into Eq.s
(<a class="reference external" href="#eq:fastdriven1">20</a>) or (<a class="reference external" href="#eq:fastdriven2">21</a>) respectively. By
writing each factor <span class="math notranslate nohighlight">\(2n\pi t/\tau\)</span> as <span class="math notranslate nohighlight">\(n\omega t\)</span>, with <span class="math notranslate nohighlight">\(\omega\equiv
2\pi/\tau\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fourierdef1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:fourierdef1} \tag{36}
F(t)=\frac{f_0}{2}+\sum_{n&gt;0}f_n\cos(n\omega t)+g_n\sin(n\omega t).
\end{equation}
\]</div>
<p>The solutions for <span class="math notranslate nohighlight">\(x(t)\)</span> then come from replacing <span class="math notranslate nohighlight">\(\omega\)</span> with
<span class="math notranslate nohighlight">\(n\omega\)</span> for each term in the particular solution in Equations
(<a class="reference external" href="#eq:partform">13</a>) and (<a class="reference external" href="#eq:Ddrive">16</a>),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_p(t)&amp;=&amp;\frac{f_0}{2k}+\sum_{n&gt;0} \alpha_n\cos(n\omega t-\delta_n)+\beta_n\sin(n\omega t-\delta_n),\\
\nonumber
\alpha_n&amp;=&amp;\frac{f_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\beta_n&amp;=&amp;\frac{g_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\delta_n&amp;=&amp;\tan^{-1}\left(\frac{2\beta n\omega}{\omega_0^2-n^2\omega^2}\right).
\end{eqnarray}
\end{split}\]</div>
<p>Because the forces have been applied for a long time, any non-zero
damping eliminates the homogenous parts of the solution, so one need
only consider the particular solution for each <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The problem will considered solved if one can find expressions for the
coefficients <span class="math notranslate nohighlight">\(f_n\)</span> and <span class="math notranslate nohighlight">\(g_n\)</span>, even though the solutions are expressed
as an infinite sum. The coefficients can be extracted from the
function <span class="math notranslate nohighlight">\(F(t)\)</span> by</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fourierdef2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fourierdef2} \tag{37}
f_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\cos(2n\pi t/\tau),\\
\nonumber
g_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\sin(2n\pi t/\tau).
\end{eqnarray}
\end{split}\]</div>
<p>To check the consistency of these expressions and to verify
Eq. (<a class="reference external" href="#eq:fourierdef2">37</a>), one can insert the expansion of <span class="math notranslate nohighlight">\(F(t)\)</span> in
Eq. (<a class="reference external" href="#eq:fourierdef1">36</a>) into the expression for the coefficients in
Eq. (<a class="reference external" href="#eq:fourierdef2">37</a>) and see whether</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
f_n&amp;=?&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~\left\{
\frac{f_0}{2}+\sum_{m&gt;0}f_m\cos(m\omega t)+g_m\sin(m\omega t)
\right\}\cos(n\omega t).
\end{eqnarray}
\]</div>
<p>Immediately, one can throw away all the terms with <span class="math notranslate nohighlight">\(g_m\)</span> because they
convolute an even and an odd function. The term with <span class="math notranslate nohighlight">\(f_0/2\)</span>
disappears because <span class="math notranslate nohighlight">\(\cos(n\omega t)\)</span> is equally positive and negative
over the interval and will integrate to zero. For all the terms
<span class="math notranslate nohighlight">\(f_m\cos(m\omega t)\)</span> appearing in the sum, one can use angle addition
formulas to see that <span class="math notranslate nohighlight">\(\cos(m\omega t)\cos(n\omega
t)=(1/2)(\cos[(m+n)\omega t]+\cos[(m-n)\omega t]\)</span>. This will integrate
to zero unless <span class="math notranslate nohighlight">\(m=n\)</span>. In that case the <span class="math notranslate nohighlight">\(m=n\)</span> term gives</p>
<!-- Equation labels as ordinary links -->
<div id="_auto27"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\int_{-\tau/2}^{\tau/2}dt~\cos^2(m\omega t)=\frac{\tau}{2},
\label{_auto27} \tag{38}
\end{equation}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
f_n&amp;=?&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~f_n/2\\
\nonumber
&amp;=&amp;f_n~\checkmark.
\end{eqnarray}
\end{split}\]</div>
<p>The same method can be used to check for the consistency of <span class="math notranslate nohighlight">\(g_n\)</span>.</p>
<p>Consider the driving force:</p>
<!-- Equation labels as ordinary links -->
<div id="_auto28"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F(t)=At/\tau,~~-\tau/2&lt;t&lt;\tau/2,~~~F(t+\tau)=F(t).
\label{_auto28} \tag{39}
\end{equation}
\]</div>
<p>Find the Fourier coefficients <span class="math notranslate nohighlight">\(f_n\)</span> and <span class="math notranslate nohighlight">\(g_n\)</span> for all <span class="math notranslate nohighlight">\(n\)</span> using Eq. (<a class="reference external" href="#eq:fourierdef2">37</a>).</p>
<p>Only the odd coefficients enter by symmetry, i.e. <span class="math notranslate nohighlight">\(f_n=0\)</span>. One can find <span class="math notranslate nohighlight">\(g_n\)</span> integrating by parts,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fouriersolution"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fouriersolution} \tag{40}
g_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2}dt~\sin(n\omega t) \frac{At}{\tau}\\
\nonumber
u&amp;=&amp;t,~dv=\sin(n\omega t)dt,~v=-\cos(n\omega t)/(n\omega),\\
\nonumber
g_n&amp;=&amp;\frac{-2A}{n\omega \tau^2}\int_{-\tau/2}^{\tau/2}dt~\cos(n\omega t)
+\left.2A\frac{-t\cos(n\omega t)}{n\omega\tau^2}\right|_{-\tau/2}^{\tau/2}.
\end{eqnarray}
\end{split}\]</div>
<p>The first term is zero because <span class="math notranslate nohighlight">\(\cos(n\omega t)\)</span> will be equally
positive and negative over the interval. Using the fact that
<span class="math notranslate nohighlight">\(\omega\tau=2\pi\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
g_n&amp;=&amp;-\frac{2A}{2n\pi}\cos(n\omega\tau/2)\\
\nonumber
&amp;=&amp;-\frac{A}{n\pi}\cos(n\pi)\\
\nonumber
&amp;=&amp;\frac{A}{n\pi}(-1)^{n+1}.
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="fourier-series">
<h2><span class="section-number">4.9. </span>Fourier Series<a class="headerlink" href="#fourier-series" title="Permalink to this headline">¶</a></h2>
<p>More text will come here, chpater 5.7-5.8 of Taylor are discussed
during the lectures. The code here uses the Fourier series discussed
in chapter 5.7 for a square wave signal. The equations for the
coefficients are are discussed in Taylor section 5.7, see Example
5.4. The code here visualizes the various approximations given by
Fourier series compared with a square wave with period <span class="math notranslate nohighlight">\(T=0.2\)</span>, witth
<span class="math notranslate nohighlight">\(0.1\)</span> and max value <span class="math notranslate nohighlight">\(F=2\)</span>. We see that when we increase the number of
components in the Fourier series, the Fourier series approximation gets closes and closes to the square wave signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># number of points                                                                                       </span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># start and final times                                                                                  </span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tn</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Period                                                                                                 </span>
<span class="n">T</span> <span class="o">=</span><span class="mf">0.2</span>
<span class="c1"># Max value of square signal                                                                             </span>
<span class="n">Fmax</span><span class="o">=</span> <span class="mf">2.0</span>
<span class="c1"># Width of signal                                                                                        </span>
<span class="n">Width</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">FourierSeriesSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">+</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">Fmax</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span>
<span class="n">FourierSeriesSignal</span> <span class="o">=</span> <span class="n">a0</span>
<span class="n">Factor</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">Fmax</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">FourierSeriesSignal</span> <span class="o">+=</span> <span class="n">Factor</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SqrSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">FourierSeriesSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-differential-equations-with-fouries-series">
<h2><span class="section-number">4.10. </span>Solving differential equations with Fouries series<a class="headerlink" href="#solving-differential-equations-with-fouries-series" title="Permalink to this headline">¶</a></h2>
<p>The material here was discussed during the lecture of February 19 and 21.
It is also covered by Taylor in section 5.8.</p>
</div>
<div class="section" id="response-to-transient-force">
<h2><span class="section-number">4.11. </span>Response to Transient Force<a class="headerlink" href="#response-to-transient-force" title="Permalink to this headline">¶</a></h2>
<p>Consider a particle at rest in the bottom of an underdamped harmonic
oscillator, that then feels a sudden impulse, or change in momentum,
<span class="math notranslate nohighlight">\(I=F\Delta t\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>. This increases the velocity immediately by an
amount <span class="math notranslate nohighlight">\(v_0=I/m\)</span> while not changing the position. One can then solve
the trajectory by solving Eq. (<a class="reference external" href="#eq:homogsolution">9</a>) with initial
conditions <span class="math notranslate nohighlight">\(v_0=I/m\)</span> and <span class="math notranslate nohighlight">\(x_0=0\)</span>. This gives</p>
<!-- Equation labels as ordinary links -->
<div id="_auto29"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\frac{I}{m\omega'}e^{-\beta t}\sin\omega't, ~~t&gt;0.
\label{_auto29} \tag{41}
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\omega'=\sqrt{\omega_0^2-\beta^2}\)</span>. For an impulse <span class="math notranslate nohighlight">\(I_i\)</span> that
occurs at time <span class="math notranslate nohighlight">\(t_i\)</span> the trajectory would be</p>
<!-- Equation labels as ordinary links -->
<div id="_auto30"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\frac{I_i}{m\omega'}e^{-\beta (t-t_i)}\sin[\omega'(t-t_i)] \Theta(t-t_i),
\label{_auto30} \tag{42}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Theta(t-t_i)\)</span> is a step function, i.e. <span class="math notranslate nohighlight">\(\Theta(x)\)</span> is zero for
<span class="math notranslate nohighlight">\(x&lt;0\)</span> and unity for <span class="math notranslate nohighlight">\(x&gt;0\)</span>. If there were several impulses linear
superposition tells us that we can sum over each contribution,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto31"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\sum_i\frac{I_i}{m\omega'}e^{-\beta(t-t_i)}\sin[\omega'(t-t_i)]\Theta(t-t_i)
\label{_auto31} \tag{43}
\end{equation}
\]</div>
<p>Now one can consider a series of impulses at times separated by
<span class="math notranslate nohighlight">\(\Delta t\)</span>, where each impulse is given by <span class="math notranslate nohighlight">\(F_i\Delta t\)</span>. The sum
above now becomes an integral,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Greeny"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}\label{eq:Greeny} \tag{44}
x(t)&amp;=&amp;\int_{-\infty}^\infty dt'~F(t')\frac{e^{-\beta(t-t')}\sin[\omega'(t-t')]}{m\omega'}\Theta(t-t')\\
\nonumber
&amp;=&amp;\int_{-\infty}^\infty dt'~F(t')G(t-t'),\\
\nonumber
G(\Delta t)&amp;=&amp;\frac{e^{-\beta\Delta t}\sin[\omega' \Delta t]}{m\omega'}\Theta(\Delta t)
\end{eqnarray}
\end{split}\]</div>
<p>The quantity
<span class="math notranslate nohighlight">\(e^{-\beta(t-t')}\sin[\omega'(t-t')]/m\omega'\Theta(t-t')\)</span> is called a
Green’s function, <span class="math notranslate nohighlight">\(G(t-t')\)</span>. It describes the response at <span class="math notranslate nohighlight">\(t\)</span> due to a
force applied at a time <span class="math notranslate nohighlight">\(t'\)</span>, and is a function of <span class="math notranslate nohighlight">\(t-t'\)</span>. The step
function ensures that the response does not occur before the force is
applied. One should remember that the form for <span class="math notranslate nohighlight">\(G\)</span> would change if the
oscillator were either critically- or over-damped.</p>
<p>When performing the integral in Eq. (<a class="reference external" href="#eq:Greeny">44</a>) one can use
angle addition formulas to factor out the part with the <span class="math notranslate nohighlight">\(t'\)</span>
dependence in the integrand,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Greeny2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:Greeny2} \tag{45}
x(t)&amp;=&amp;\frac{1}{m\omega'}e^{-\beta t}\left[I_c(t)\sin(\omega't)-I_s(t)\cos(\omega't)\right],\\
\nonumber
I_c(t)&amp;\equiv&amp;\int_{-\infty}^t dt'~F(t')e^{\beta t'}\cos(\omega't'),\\
\nonumber
I_s(t)&amp;\equiv&amp;\int_{-\infty}^t dt'~F(t')e^{\beta t'}\sin(\omega't').
\end{eqnarray}
\end{split}\]</div>
<p>If the time <span class="math notranslate nohighlight">\(t\)</span> is beyond any time at which the force acts,
<span class="math notranslate nohighlight">\(F(t'&gt;t)=0\)</span>, the coefficients <span class="math notranslate nohighlight">\(I_c\)</span> and <span class="math notranslate nohighlight">\(I_s\)</span> become independent of
<span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Consider an undamped oscillator (<span class="math notranslate nohighlight">\(\beta\rightarrow 0\)</span>), with
characteristic frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> and mass <span class="math notranslate nohighlight">\(m\)</span>, that is at rest
until it feels a force described by a Gaussian form,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
F(t)&amp;=&amp;F_0 \exp\left\{\frac{-t^2}{2\tau^2}\right\}.
\end{eqnarray*}
\]</div>
<p>For large times (<span class="math notranslate nohighlight">\(t&gt;&gt;\tau\)</span>), where the force has died off, find
<span class="math notranslate nohighlight">\(x(t)\)</span>.\ Solve for the coefficients <span class="math notranslate nohighlight">\(I_c\)</span> and <span class="math notranslate nohighlight">\(I_s\)</span> in
Eq. (<a class="reference external" href="#eq:Greeny2">45</a>). Because the Gaussian is an even function,
<span class="math notranslate nohighlight">\(I_s=0\)</span>, and one need only solve for <span class="math notranslate nohighlight">\(I_c\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
I_c&amp;=&amp;F_0\int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}\cos(\omega_0 t')\\
&amp;=&amp;\Re F_0 \int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}e^{i\omega_0 t'}\\
&amp;=&amp;\Re F_0 \int_{-\infty}^\infty dt'~e^{-(t'-i\omega_0\tau^2)^2/(2\tau^2)}e^{-\omega_0^2\tau^2/2}\\
&amp;=&amp;F_0\tau \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}.
\end{eqnarray*}
\end{split}\]</div>
<p>The third step involved completing the square, and the final step used the fact that the integral</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\int_{-\infty}^\infty dx~e^{-x^2/2}&amp;=&amp;\sqrt{2\pi}.
\end{eqnarray*}
\]</div>
<p>To see that this integral is true, consider the square of the integral, which you can change to polar coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
I&amp;=&amp;\int_{-\infty}^\infty dx~e^{-x^2/2}\\
I^2&amp;=&amp;\int_{-\infty}^\infty dxdy~e^{-(x^2+y^2)/2}\\
&amp;=&amp;2\pi\int_0^\infty rdr~e^{-r^2/2}\\
&amp;=&amp;2\pi.
\end{eqnarray*}
\end{split}\]</div>
<p>Finally, the expression for <span class="math notranslate nohighlight">\(x\)</span> from Eq. (<a class="reference external" href="#eq:Greeny2">45</a>) is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
x(t&gt;&gt;\tau)&amp;=&amp;\frac{F_0\tau}{m\omega_0} \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}\sin(\omega_0t).
\end{eqnarray*}
\]</div>
</div>
<div class="section" id="the-classical-pendulum-and-scaling-the-equations">
<h2><span class="section-number">4.12. </span>The classical pendulum and scaling the equations<a class="headerlink" href="#the-classical-pendulum-and-scaling-the-equations" title="Permalink to this headline">¶</a></h2>
<p>Let us end our discussion of oscillations with another classical case, the pendulum.</p>
<p>The angular equation of motion of the pendulum is given by
Newton’s equation and with no external force it reads</p>
<!-- Equation labels as ordinary links -->
<div id="_auto32"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  ml\frac{d^2\theta}{dt^2}+mgsin(\theta)=0,
\label{_auto32} \tag{46}
\end{equation}
\]</div>
<p>with an angular velocity and acceleration given by</p>
<!-- Equation labels as ordinary links -->
<div id="_auto33"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     v=l\frac{d\theta}{dt},
\label{_auto33} \tag{47}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto34"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     a=l\frac{d^2\theta}{dt^2}.
\label{_auto34} \tag{48}
\end{equation}
\]</div>
<p>We do however expect that the motion will gradually come to an end due a viscous drag torque acting on the pendulum.
In the presence of the drag, the above equation becomes</p>
<!-- Equation labels as ordinary links -->
<div id="eq:pend1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=0, \label{eq:pend1} \tag{49}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is now a positive constant parameterizing the viscosity
of the medium in question. In order to maintain the motion against
viscosity, it is necessary to add some external driving force.
We choose here a periodic driving force. The last equation becomes then</p>
<!-- Equation labels as ordinary links -->
<div id="eq:pend2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Asin(\omega t), \label{eq:pend2} \tag{50}
\end{equation}
\]</div>
<p>with <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> two constants representing the amplitude and
the angular frequency respectively. The latter is called the driving frequency.</p>
<p>We define</p>
<div class="math notranslate nohighlight">
\[
\omega_0=\sqrt{g/l},
\]</div>
<p>the so-called natural frequency and the new dimensionless quantities</p>
<div class="math notranslate nohighlight">
\[
\hat{t}=\omega_0t,
\]</div>
<p>with the dimensionless driving frequency</p>
<div class="math notranslate nohighlight">
\[
\hat{\omega}=\frac{\omega}{\omega_0},
\]</div>
<p>and introducing the quantity <span class="math notranslate nohighlight">\(Q\)</span>, called the <em>quality factor</em>,</p>
<div class="math notranslate nohighlight">
\[
Q=\frac{mg}{\omega_0\nu},
\]</div>
<p>and the dimensionless amplitude</p>
<div class="math notranslate nohighlight">
\[
\hat{A}=\frac{A}{mg}
\]</div>
</div>
<div class="section" id="more-on-the-pendulum">
<h2><span class="section-number">4.13. </span>More on the Pendulum<a class="headerlink" href="#more-on-the-pendulum" title="Permalink to this headline">¶</a></h2>
<p>We have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2\theta}{d\hat{t}^2}+\frac{1}{Q}\frac{d\theta}{d\hat{t}}  
     +sin(\theta)=\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>This equation can in turn be recast in terms of two coupled first-order differential equations as follows</p>
<div class="math notranslate nohighlight">
\[
\frac{d\theta}{d\hat{t}}=\hat{v},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d\hat{v}}{d\hat{t}}=-\frac{\hat{v}}{Q}-sin(\theta)+\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>These are the equations to be solved.  The factor <span class="math notranslate nohighlight">\(Q\)</span> represents the
number of oscillations of the undriven system that must occur before
its energy is significantly reduced due to the viscous drag. The
amplitude <span class="math notranslate nohighlight">\(\hat{A}\)</span> is measured in units of the maximum possible
gravitational torque while <span class="math notranslate nohighlight">\(\hat{\omega}\)</span> is the angular frequency of
the external torque measured in units of the pendulum’s natural
frequency.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="chapter4.html" title="previous page"><span class="section-number">3. </span>Work, Energy, Momentum and Conservation laws</a>
    <a class='right-next' id="next-link" href="chapter6.html" title="next page"><span class="section-number">5. </span>Two-body Problems</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Morten Hjorth-Jensen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>