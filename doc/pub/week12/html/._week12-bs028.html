<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week12.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week12-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Boltzmann machines and deep learning and discussions of project 2">
<title>Boltzmann machines and deep learning and discussions of project 2</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week12.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week12-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Plans for the week of April 8-12, 2024',
               2,
               None,
               'plans-for-the-week-of-april-8-12-2024'),
              ('Energy models', 2, None, 'energy-models'),
              ('Probability model', 2, None, 'probability-model'),
              ('Marginal and conditional probabilities',
               2,
               None,
               'marginal-and-conditional-probabilities'),
              ('Change of notation', 2, None, 'change-of-notation'),
              ('Optimization problem', 2, None, 'optimization-problem'),
              ('Further simplifications', 2, None, 'further-simplifications'),
              ('Optimizing the logarithm instead',
               2,
               None,
               'optimizing-the-logarithm-instead'),
              ('Expression for the gradients',
               2,
               None,
               'expression-for-the-gradients'),
              ('The derivative of the partition function',
               2,
               None,
               'the-derivative-of-the-partition-function'),
              ('Explicit expression for the derivative',
               2,
               None,
               'explicit-expression-for-the-derivative'),
              ('Final expression', 2, None, 'final-expression'),
              ('Introducing the energy model',
               2,
               None,
               'introducing-the-energy-model'),
              ('More compact notation', 2, None, 'more-compact-notation'),
              ('Anticipating results to be derived',
               2,
               None,
               'anticipating-results-to-be-derived'),
              ('Boltzmann Machines, marginal and conditional probabilities',
               2,
               None,
               'boltzmann-machines-marginal-and-conditional-probabilities'),
              ('Generative and discriminative models',
               2,
               None,
               'generative-and-discriminative-models'),
              ('Basics of the Boltzmann machine',
               2,
               None,
               'basics-of-the-boltzmann-machine'),
              ('More about the basics', 2, None, 'more-about-the-basics'),
              ('Difficult to train', 2, None, 'difficult-to-train'),
              ('The network layers', 2, None, 'the-network-layers'),
              ('Goal of hidden layer', 2, None, 'goal-of-hidden-layer'),
              ('The parameters', 2, None, 'the-parameters'),
              ('Joint distribution', 2, None, 'joint-distribution'),
              ('Network Elements, the energy function',
               2,
               None,
               'network-elements-the-energy-function'),
              ('Defining different types of RBMs',
               2,
               None,
               'defining-different-types-of-rbms'),
              ('Gaussian-binary RBM', 2, None, 'gaussian-binary-rbm'),
              ('Cost function', 2, None, 'cost-function'),
              ('Optimization / Training', 2, None, 'optimization-training'),
              ('Gradients', 2, None, 'gradients'),
              ('Simplifications', 2, None, 'simplifications'),
              ('Positive and negative phases',
               2,
               None,
               'positive-and-negative-phases'),
              ('Gradient examples', 2, None, 'gradient-examples'),
              ('Kullback-Leibler relative entropy',
               2,
               None,
               'kullback-leibler-relative-entropy'),
              ('Kullback-Leibler divergence',
               2,
               None,
               'kullback-leibler-divergence'),
              ('Maximizing log-likelihood',
               2,
               None,
               'maximizing-log-likelihood'),
              ('More on the partition function',
               2,
               None,
               'more-on-the-partition-function'),
              ('Setting up for gradient descent calculations',
               2,
               None,
               'setting-up-for-gradient-descent-calculations'),
              ('Difference of moments', 2, None, 'difference-of-moments'),
              ('More observations', 2, None, 'more-observations'),
              ('Adding hyperparameters', 2, None, 'adding-hyperparameters'),
              ('Mathematical details', 2, None, 'mathematical-details'),
              ('Binary-binary (BB) RBMs', 2, None, 'binary-binary-bb-rbms'),
              ('Marginal probability', 2, None, 'marginal-probability'),
              ('Marginal Probability Density Function for the visible units',
               2,
               None,
               'marginal-probability-density-function-for-the-visible-units'),
              ('Marginal probability for hidden units',
               2,
               None,
               'marginal-probability-for-hidden-units'),
              ('Conditional Probability Density Functions',
               2,
               None,
               'conditional-probability-density-functions'),
              ('On and off probabilities', 2, None, 'on-and-off-probabilities'),
              ('Conditional probability for visible units',
               2,
               None,
               'conditional-probability-for-visible-units'),
              ('Gaussian-Binary Restricted Boltzmann Machines',
               2,
               None,
               'gaussian-binary-restricted-boltzmann-machines'),
              ('Joint Probability Density Function',
               2,
               None,
               'joint-probability-density-function'),
              ('Partition function', 2, None, 'partition-function'),
              ('Marginal Probability Density Functions',
               2,
               None,
               'marginal-probability-density-functions'),
              ('Then the visible units', 2, None, 'then-the-visible-units'),
              ('Conditional Probability Density Functions',
               2,
               None,
               'conditional-probability-density-functions'),
              ('Hidden units', 2, None, 'hidden-units'),
              ('Visible units', 2, None, 'visible-units'),
              ('Comments', 2, None, 'comments'),
              ('Neural Quantum States', 2, None, 'neural-quantum-states'),
              ('Model for the trial wave function',
               2,
               None,
               'model-for-the-trial-wave-function'),
              ('Allowing for complex valued functions',
               2,
               None,
               'allowing-for-complex-valued-functions'),
              ('Squared wave function', 2, None, 'squared-wave-function'),
              ('Cost function', 2, None, 'cost-function'),
              ('And the gradient', 2, None, 'and-the-gradient'),
              ('Additional details', 2, None, 'additional-details'),
              ('Final equation', 2, None, 'final-equation'),
              ('Code example', 2, None, 'code-example')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week12-bs.html">Boltzmann machines and deep learning and discussions of project 2</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._week12-bs001.html#plans-for-the-week-of-april-8-12-2024" style="font-size: 80%;">Plans for the week of April 8-12, 2024</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs002.html#energy-models" style="font-size: 80%;">Energy models</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs003.html#probability-model" style="font-size: 80%;">Probability model</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs004.html#marginal-and-conditional-probabilities" style="font-size: 80%;">Marginal and conditional probabilities</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs005.html#change-of-notation" style="font-size: 80%;">Change of notation</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs006.html#optimization-problem" style="font-size: 80%;">Optimization problem</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs007.html#further-simplifications" style="font-size: 80%;">Further simplifications</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs008.html#optimizing-the-logarithm-instead" style="font-size: 80%;">Optimizing the logarithm instead</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs009.html#expression-for-the-gradients" style="font-size: 80%;">Expression for the gradients</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs010.html#the-derivative-of-the-partition-function" style="font-size: 80%;">The derivative of the partition function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs011.html#explicit-expression-for-the-derivative" style="font-size: 80%;">Explicit expression for the derivative</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs012.html#final-expression" style="font-size: 80%;">Final expression</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs013.html#introducing-the-energy-model" style="font-size: 80%;">Introducing the energy model</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs014.html#more-compact-notation" style="font-size: 80%;">More compact notation</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs015.html#anticipating-results-to-be-derived" style="font-size: 80%;">Anticipating results to be derived</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs016.html#boltzmann-machines-marginal-and-conditional-probabilities" style="font-size: 80%;">Boltzmann Machines, marginal and conditional probabilities</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs017.html#generative-and-discriminative-models" style="font-size: 80%;">Generative and discriminative models</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs018.html#basics-of-the-boltzmann-machine" style="font-size: 80%;">Basics of the Boltzmann machine</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs019.html#more-about-the-basics" style="font-size: 80%;">More about the basics</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs020.html#difficult-to-train" style="font-size: 80%;">Difficult to train</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs021.html#the-network-layers" style="font-size: 80%;">The network layers</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs022.html#goal-of-hidden-layer" style="font-size: 80%;">Goal of hidden layer</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs023.html#the-parameters" style="font-size: 80%;">The parameters</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs024.html#joint-distribution" style="font-size: 80%;">Joint distribution</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs025.html#network-elements-the-energy-function" style="font-size: 80%;">Network Elements, the energy function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs026.html#defining-different-types-of-rbms" style="font-size: 80%;">Defining different types of RBMs</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs027.html#gaussian-binary-rbm" style="font-size: 80%;">Gaussian-binary RBM</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs063.html#cost-function" style="font-size: 80%;">Cost function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs029.html#optimization-training" style="font-size: 80%;">Optimization / Training</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs030.html#gradients" style="font-size: 80%;">Gradients</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs031.html#simplifications" style="font-size: 80%;">Simplifications</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs032.html#positive-and-negative-phases" style="font-size: 80%;">Positive and negative phases</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs033.html#gradient-examples" style="font-size: 80%;">Gradient examples</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs034.html#kullback-leibler-relative-entropy" style="font-size: 80%;">Kullback-Leibler relative entropy</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs035.html#kullback-leibler-divergence" style="font-size: 80%;">Kullback-Leibler divergence</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs036.html#maximizing-log-likelihood" style="font-size: 80%;">Maximizing log-likelihood</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs037.html#more-on-the-partition-function" style="font-size: 80%;">More on the partition function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs038.html#setting-up-for-gradient-descent-calculations" style="font-size: 80%;">Setting up for gradient descent calculations</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs039.html#difference-of-moments" style="font-size: 80%;">Difference of moments</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs040.html#more-observations" style="font-size: 80%;">More observations</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs041.html#adding-hyperparameters" style="font-size: 80%;">Adding hyperparameters</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs042.html#mathematical-details" style="font-size: 80%;">Mathematical details</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs043.html#binary-binary-bb-rbms" style="font-size: 80%;">Binary-binary (BB) RBMs</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs044.html#marginal-probability" style="font-size: 80%;">Marginal probability</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs045.html#marginal-probability-density-function-for-the-visible-units" style="font-size: 80%;">Marginal Probability Density Function for the visible units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs046.html#marginal-probability-for-hidden-units" style="font-size: 80%;">Marginal probability for hidden units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs055.html#conditional-probability-density-functions" style="font-size: 80%;">Conditional Probability Density Functions</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs048.html#on-and-off-probabilities" style="font-size: 80%;">On and off probabilities</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs049.html#conditional-probability-for-visible-units" style="font-size: 80%;">Conditional probability for visible units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs050.html#gaussian-binary-restricted-boltzmann-machines" style="font-size: 80%;">Gaussian-Binary Restricted Boltzmann Machines</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs051.html#joint-probability-density-function" style="font-size: 80%;">Joint Probability Density Function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs052.html#partition-function" style="font-size: 80%;">Partition function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs053.html#marginal-probability-density-functions" style="font-size: 80%;">Marginal Probability Density Functions</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs054.html#then-the-visible-units" style="font-size: 80%;">Then the visible units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs055.html#conditional-probability-density-functions" style="font-size: 80%;">Conditional Probability Density Functions</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs056.html#hidden-units" style="font-size: 80%;">Hidden units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs057.html#visible-units" style="font-size: 80%;">Visible units</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs058.html#comments" style="font-size: 80%;">Comments</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs059.html#neural-quantum-states" style="font-size: 80%;">Neural Quantum States</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs060.html#model-for-the-trial-wave-function" style="font-size: 80%;">Model for the trial wave function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs061.html#allowing-for-complex-valued-functions" style="font-size: 80%;">Allowing for complex valued functions</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs062.html#squared-wave-function" style="font-size: 80%;">Squared wave function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs063.html#cost-function" style="font-size: 80%;">Cost function</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs064.html#and-the-gradient" style="font-size: 80%;">And the gradient</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs065.html#additional-details" style="font-size: 80%;">Additional details</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs066.html#final-equation" style="font-size: 80%;">Final equation</a></li>
     <!-- navigation toc: --> <li><a href="._week12-bs067.html#code-example" style="font-size: 80%;">Code example</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0028"></a>
<!-- !split -->
<h2 id="cost-function" class="anchor">Cost function </h2>

<p>When working with a training dataset, the most common training
approach is maximizing the log-likelihood of the training data. The
log likelihood characterizes the log-probability of generating the
observed data using our generative model. Using this method our cost
function is chosen as the negative log-likelihood. The learning then
consists of trying to find parameters that maximize the probability of
the dataset, and is known as Maximum Likelihood Estimation (MLE).
</p>

<p>Denoting the parameters as \( \boldsymbol{\Theta} = a_1,...,a_M,b_1,...,b_N,w_{11},...,w_{MN} \), the log-likelihood is given by</p>
$$
\begin{align*}
	\mathcal{L}(\{ \Theta_i \}) &= \langle \text{log} P_\theta(\boldsymbol{x}) \rangle_{data} \\
	&= - \langle E(\boldsymbol{x}; \{ \Theta_i\}) \rangle_{data} - \text{log} Z(\{ \Theta_i\}),
\end{align*}
$$

<p>where we used that the normalization constant does not depend on the data, \( \langle \text{log} Z(\{ \Theta_i\}) \rangle = \text{log} Z(\{ \Theta_i\}) \)
Our cost function is the negative log-likelihood, \( \mathcal{C}(\{ \Theta_i \}) = - \mathcal{L}(\{ \Theta_i \}) \)
</p>

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._week12-bs027.html">&laquo;</a></li>
  <li><a href="._week12-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._week12-bs020.html">21</a></li>
  <li><a href="._week12-bs021.html">22</a></li>
  <li><a href="._week12-bs022.html">23</a></li>
  <li><a href="._week12-bs023.html">24</a></li>
  <li><a href="._week12-bs024.html">25</a></li>
  <li><a href="._week12-bs025.html">26</a></li>
  <li><a href="._week12-bs026.html">27</a></li>
  <li><a href="._week12-bs027.html">28</a></li>
  <li class="active"><a href="._week12-bs028.html">29</a></li>
  <li><a href="._week12-bs029.html">30</a></li>
  <li><a href="._week12-bs030.html">31</a></li>
  <li><a href="._week12-bs031.html">32</a></li>
  <li><a href="._week12-bs032.html">33</a></li>
  <li><a href="._week12-bs033.html">34</a></li>
  <li><a href="._week12-bs034.html">35</a></li>
  <li><a href="._week12-bs035.html">36</a></li>
  <li><a href="._week12-bs036.html">37</a></li>
  <li><a href="._week12-bs037.html">38</a></li>
  <li><a href="">...</a></li>
  <li><a href="._week12-bs067.html">68</a></li>
  <li><a href="._week12-bs029.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>
</body>
</html>

