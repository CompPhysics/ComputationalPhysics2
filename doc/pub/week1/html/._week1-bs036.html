<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week1.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week1-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Introduction to the course and start Variational Monte Carlo">
<title>Introduction to the course and start Variational Monte Carlo</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week1.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week1-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Overview of first week January 20-24, 2025',
               2,
               None,
               'overview-of-first-week-january-20-24-2025'),
              ('Material this week', 2, None, 'material-this-week'),
              ('Link to code material and examples',
               2,
               None,
               'link-to-code-material-and-examples'),
              ('Teaching team', 2, None, 'teaching-team'),
              ('Textbooks', 2, None, 'textbooks'),
              ('Lectures and ComputerLab', 2, None, 'lectures-and-computerlab'),
              ('Course Format', 2, None, 'course-format'),
              ('Aims', 2, None, 'aims'),
              ('More aims', 2, None, 'more-aims'),
              ('Topics covered in this course',
               2,
               None,
               'topics-covered-in-this-course'),
              ('More on topics covered in this course',
               2,
               None,
               'more-on-topics-covered-in-this-course'),
              ('Other topics covered in this course',
               2,
               None,
               'other-topics-covered-in-this-course'),
              ('Last (?) word on  topics covered in this course',
               2,
               None,
               'last-word-on-topics-covered-in-this-course'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Various many-body methods',
               2,
               None,
               'various-many-body-methods'),
              ('Pros and Cons of Monte Carlo',
               2,
               None,
               'pros-and-cons-of-monte-carlo'),
              ('More on Pros and Cons of Monte Carlo',
               2,
               None,
               'more-on-pros-and-cons-of-monte-carlo'),
              ('Where and why do we use Monte Carlo Methods in Quantum Physics',
               2,
               None,
               'where-and-why-do-we-use-monte-carlo-methods-in-quantum-physics'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo Motivation',
               2,
               None,
               'quantum-monte-carlo-motivation'),
              ('Quantum Monte Carlo, ingredients and basic steps',
               2,
               None,
               'quantum-monte-carlo-ingredients-and-basic-steps'),
              ('Quantum Monte Carlo, basic steps, the probability distribution '
               'function (PDF)',
               2,
               None,
               'quantum-monte-carlo-basic-steps-the-probability-distribution-function-pdf'),
              ('Quantum Monte Carlo ingredients, the local energy',
               2,
               None,
               'quantum-monte-carlo-ingredients-the-local-energy'),
              ('Quantum Monte Carlo algorithm',
               2,
               None,
               'quantum-monte-carlo-algorithm'),
              ('Quantum Monte Carlo: hydrogen atom',
               2,
               None,
               'quantum-monte-carlo-hydrogen-atom'),
              ('Introducing the variational parameters',
               2,
               None,
               'introducing-the-variational-parameters'),
              ('Quantum Monte Carlo: results for the hydrogen atom',
               2,
               None,
               'quantum-monte-carlo-results-for-the-hydrogen-atom'),
              ('Quantum Monte Carlo: interpreting the hydrogen atom results',
               2,
               None,
               'quantum-monte-carlo-interpreting-the-hydrogen-atom-results'),
              ('"Quantum Monte Carlo for '
               'bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"',
               2,
               None,
               'quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411'),
              ('"Quantum Monte Carlo for '
               'bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"',
               2,
               None,
               'quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411'),
              ('"Quantum Monte Carlo for '
               'bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"',
               2,
               None,
               'quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411'),
              ('"Quantum Monte Carlo for '
               'bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"',
               2,
               None,
               'quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411'),
              ('Simple example, the hydrogen atom',
               3,
               None,
               'simple-example-the-hydrogen-atom'),
              ('Second example, the harmonic oscillator in one dimension',
               3,
               None,
               'second-example-the-harmonic-oscillator-in-one-dimension')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week1-bs.html">Introduction to the course and start Variational Monte Carlo</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._week1-bs001.html#overview-of-first-week-january-20-24-2025" style="font-size: 80%;"><b>Overview of first week January 20-24, 2025</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs002.html#material-this-week" style="font-size: 80%;"><b>Material this week</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs003.html#link-to-code-material-and-examples" style="font-size: 80%;"><b>Link to code material and examples</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs004.html#teaching-team" style="font-size: 80%;"><b>Teaching team</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs005.html#textbooks" style="font-size: 80%;"><b>Textbooks</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs006.html#lectures-and-computerlab" style="font-size: 80%;"><b>Lectures and ComputerLab</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs007.html#course-format" style="font-size: 80%;"><b>Course Format</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs008.html#aims" style="font-size: 80%;"><b>Aims</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs009.html#more-aims" style="font-size: 80%;"><b>More aims</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs010.html#topics-covered-in-this-course" style="font-size: 80%;"><b>Topics covered in this course</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs011.html#more-on-topics-covered-in-this-course" style="font-size: 80%;"><b>More on topics covered in this course</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs012.html#other-topics-covered-in-this-course" style="font-size: 80%;"><b>Other topics covered in this course</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs013.html#last-word-on-topics-covered-in-this-course" style="font-size: 80%;"><b>Last (?) word on  topics covered in this course</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs017.html#various-many-body-methods" style="font-size: 80%;"><b>Various many-body methods</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs018.html#pros-and-cons-of-monte-carlo" style="font-size: 80%;"><b>Pros and Cons of Monte Carlo</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs019.html#more-on-pros-and-cons-of-monte-carlo" style="font-size: 80%;"><b>More on Pros and Cons of Monte Carlo</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs020.html#where-and-why-do-we-use-monte-carlo-methods-in-quantum-physics" style="font-size: 80%;"><b>Where and why do we use Monte Carlo Methods in Quantum Physics</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs024.html#quantum-monte-carlo-motivation" style="font-size: 80%;"><b>Quantum Monte Carlo Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs025.html#quantum-monte-carlo-ingredients-and-basic-steps" style="font-size: 80%;"><b>Quantum Monte Carlo, ingredients and basic steps</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs026.html#quantum-monte-carlo-basic-steps-the-probability-distribution-function-pdf" style="font-size: 80%;"><b>Quantum Monte Carlo, basic steps, the probability distribution function (PDF)</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs027.html#quantum-monte-carlo-ingredients-the-local-energy" style="font-size: 80%;"><b>Quantum Monte Carlo ingredients, the local energy</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs028.html#quantum-monte-carlo-algorithm" style="font-size: 80%;"><b>Quantum Monte Carlo algorithm</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs029.html#quantum-monte-carlo-hydrogen-atom" style="font-size: 80%;"><b>Quantum Monte Carlo: hydrogen atom</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs030.html#introducing-the-variational-parameters" style="font-size: 80%;"><b>Introducing the variational parameters</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs031.html#quantum-monte-carlo-results-for-the-hydrogen-atom" style="font-size: 80%;"><b>Quantum Monte Carlo: results for the hydrogen atom</b></a></li>
     <!-- navigation toc: --> <li><a href="._week1-bs032.html#quantum-monte-carlo-interpreting-the-hydrogen-atom-results" style="font-size: 80%;"><b>Quantum Monte Carlo: interpreting the hydrogen atom results</b></a></li>
     <!-- navigation toc: --> <li><a href="#quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411" style="font-size: 80%;"><b>"Quantum Monte Carlo for bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"</b></a></li>
     <!-- navigation toc: --> <li><a href="#quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411" style="font-size: 80%;"><b>"Quantum Monte Carlo for bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"</b></a></li>
     <!-- navigation toc: --> <li><a href="#quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411" style="font-size: 80%;"><b>"Quantum Monte Carlo for bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"</b></a></li>
     <!-- navigation toc: --> <li><a href="#quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411" style="font-size: 80%;"><b>"Quantum Monte Carlo for bosons":"https://github.com/mortele/variational-monte-carlo-fys4411"</b></a></li>
     <!-- navigation toc: --> <li><a href="#simple-example-the-hydrogen-atom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Simple example, the hydrogen atom</a></li>
     <!-- navigation toc: --> <li><a href="#second-example-the-harmonic-oscillator-in-one-dimension" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Second example, the harmonic oscillator in one dimension</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0036"></a>
<!-- !split -->
<h2 id="quantum-monte-carlo-for-bosons-https-github-com-mortele-variational-monte-carlo-fys4411" class="anchor"><a href="https://github.com/mortele/variational-monte-carlo-fys4411" target="_self">Quantum Monte Carlo for bosons</a> </h2>

<p>The rest of this material is best read using the jupyter-notebook</p>

<p>For spherical traps we have \( \beta = 1 \) and for non-interacting
bosons (\( a=0 \)) we have \( \alpha = 1/2a_{ho}^2 \).  The correlation wave
 function is
</p>
$$
 \begin{equation}
    f(a,|\mathbf{r}_i-\mathbf{r}_j|)=\Bigg\{
 \begin{array}{ll}
	 0 & {|\mathbf{r}_i-\mathbf{r}_j|} \leq {a}\\
	 (1-\frac{a}{|\mathbf{r}_i-\mathbf{r}_j|}) & {|\mathbf{r}_i-\mathbf{r}_j|} > {a}.
 \end{array}
\tag{9}
\end{equation}  
$$
<h3 id="simple-example-the-hydrogen-atom" class="anchor">Simple example, the hydrogen atom </h3>

<p>The radial Schroedinger equation for the hydrogen atom can be
written as (when we have gotten rid of the first derivative term in the kinetic energy and used \( rR(r)=u(r) \))
</p>
$$
-\frac{\hbar^2}{2m}\frac{d^2 u(r)}{d r^2}-
\left(\frac{ke^2}{r}-\frac{\hbar^2l(l+1)}{2mr^2}\right)u(r)=Eu(r).
$$

<p>We will specialize to the case with \( l=0 \) and end up with </p>
$$
-\frac{\hbar^2}{2m}\frac{d^2 u(r)}{d r^2}-
\left(\frac{ke^2}{r}\right)u(r)=Eu(r).
$$

<p>Then we introduce a dimensionless variable \( \rho=r/a \) where \( a \) is a constant with dimension length.
Multiplying with \( ma^2/\hbar^2 \) we can rewrite our equations as
</p>
$$
-\frac{1}{2}\frac{d^2 u(\rho)}{d \rho^2}-
\frac{ke^2ma}{\hbar^2}\frac{u(\rho)}{\rho}-\lambda u(\rho)=0.
$$

<p>Since \( a \) is just a parameter we choose to set</p>
$$
\frac{ke^2ma}{\hbar^2}=1,
$$

<p>which leads to \( a=\hbar^2/mke^2 \), better known as the Bohr radius with value \( 0.053 \) nm. Scaling the equations this way does not only render our numerical treatment simpler since we avoid carrying with us all physical parameters, but we obtain also a <b>natural</b> length scale. We will see this again and again. In our discussions below with a harmonic oscillator trap, the <b>natural</b> lentgh scale with be determined by the oscillator frequency, the mass of the particle and \( \hbar \). We have also defined a dimensionless 'energy' \( \lambda = Ema^2/\hbar^2 \). 
With the rescaled quantities, the ground state energy of the hydrogen atom is \( 1/2 \). 
The equation we want to solve is now defined by the Hamiltonian
</p>
$$
H=-\frac{1}{2}\frac{d^2 }{d \rho^2}-\frac{1}{\rho}.
$$

<p>As trial wave function we peep now into the analytical solution for
the hydrogen atom and use (with \( \alpha \) as a variational parameter)
</p>

$$
   u_T^{\alpha}(\rho)=\alpha\rho \exp{-(\alpha\rho)}. 
$$

<p>Inserting this wave function into the expression for the
local energy \( E_L \) gives
</p>
$$
   E_L(\rho)=-\frac{1}{\rho}-
              \frac{\alpha}{2}\left(\alpha-\frac{2}{\rho}\right).
$$

<p>To have analytical local energies saves us from computing numerically
the second derivative, a feature which often increases our numerical
expenditure with a factor of three or more. Integratng up the local energy (recall to bring back the PDF in the integration) gives  \( \overline{E}[\boldsymbol{\alpha}]=\alpha(\alpha/2-1) \). 
</p>
<h3 id="second-example-the-harmonic-oscillator-in-one-dimension" class="anchor">Second example, the harmonic oscillator in one dimension </h3>

<p>We present here another well-known example, the harmonic oscillator in
one dimension for one particle. This will also serve the aim of
introducing our next model, namely that of interacting electrons in a
harmonic oscillator trap.
</p>

<p>Here as well, we do have analytical solutions and the energy of the
ground state, with \( \hbar=1 \), is \( 1/2\omega \), with \( \omega \) being the
oscillator frequency. We use the following trial wave function
</p>

$$
\psi_T(x;\alpha) = \exp{-(\frac{1}{2}\alpha^2x^2)},
$$

<p>which results in a local energy </p>
$$
\frac{1}{2}\left(\alpha^2+x^2(1-\alpha^4)\right).
$$

<p>We can compare our numerically calculated energies with the exact energy as function of \( \alpha \)</p>
$$
\overline{E}[\alpha] = \frac{1}{4}\left(\alpha^2+\frac{1}{\alpha^2}\right).
$$

<p>Similarly, with the above ansatz, we can also compute the exact variance which reads</p>
$$
\sigma^2[\alpha]=\frac{1}{4}\left(1+(1-\alpha^4)^2\frac{3}{4\alpha^4}\right)-\overline{E}^2.
$$

<p>Our code for computing the energy of the ground state of the harmonic oscillator follows here. We start by defining directories where we store various outputs.</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #408080; font-style: italic"># Common imports</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>

<span style="color: #408080; font-style: italic"># Where to save the figures and data files</span>
PROJECT_ROOT_DIR <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results&quot;</span>
FIGURE_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results/FigureFiles&quot;</span>
DATA_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results/VMCHarmonic&quot;</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(PROJECT_ROOT_DIR):
    os<span style="color: #666666">.</span>mkdir(PROJECT_ROOT_DIR)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(FIGURE_ID):
    os<span style="color: #666666">.</span>makedirs(FIGURE_ID)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(DATA_ID):
    os<span style="color: #666666">.</span>makedirs(DATA_ID)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">image_path</span>(fig_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(FIGURE_ID, fig_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data_path</span>(dat_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(DATA_ID, dat_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">save_fig</span>(fig_id):
    plt<span style="color: #666666">.</span>savefig(image_path(fig_id) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;.png&quot;</span>, <span style="color: #008000">format</span><span style="color: #666666">=</span><span style="color: #BA2121">&#39;png&#39;</span>)

outfile <span style="color: #666666">=</span> <span style="color: #008000">open</span>(data_path(<span style="color: #BA2121">&quot;VMCHarmonic.dat&quot;</span>),<span style="color: #BA2121">&#39;w&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>We proceed with the implementation of the Monte Carlo algorithm but list first the ansatz for the wave function and the expression for the local energy</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #408080; font-style: italic"># VMC for the one-dimensional harmonic oscillator</span>
<span style="color: #408080; font-style: italic"># Brute force Metropolis, no importance sampling and no energy minimization</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp, sqrt
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">random</span> <span style="color: #008000; font-weight: bold">import</span> random, seed
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">decimal</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #408080; font-style: italic"># Trial wave function for the Harmonic oscillator in one dimension</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">WaveFunction</span>(r,alpha):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-0.5*</span>alpha<span style="color: #666666">*</span>alpha<span style="color: #666666">*</span>r<span style="color: #666666">*</span>r)

<span style="color: #408080; font-style: italic"># Local energy  for the Harmonic oscillator in one dimension</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">LocalEnergy</span>(r,alpha):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.5*</span>r<span style="color: #666666">*</span>r<span style="color: #666666">*</span>(<span style="color: #666666">1-</span>alpha<span style="color: #666666">**4</span>) <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>alpha<span style="color: #666666">*</span>alpha
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that in the Metropolis algorithm there is no need to compute the
trial wave function, mainly since we are just taking the ratio of two
exponentials. It is then from a computational point view, more
convenient to compute the argument from the ratio and then calculate
the exponential. Here we have refrained from this purely of
pedagogical reasons.
</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #408080; font-style: italic"># The Monte Carlo sampling with the Metropolis algo</span>
<span style="color: #408080; font-style: italic"># The jit decorator tells Numba to compile this function.</span>
<span style="color: #408080; font-style: italic"># The argument types will be inferred by Numba when the function is called.</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">MonteCarloSampling</span>():

    NumberMCcycles<span style="color: #666666">=</span> <span style="color: #666666">100000</span>
    StepSize <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    <span style="color: #408080; font-style: italic"># positions</span>
    PositionOld <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    PositionNew <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>

    <span style="color: #408080; font-style: italic"># seed for rng generator</span>
    seed()
    <span style="color: #408080; font-style: italic"># start variational parameter</span>
    alpha <span style="color: #666666">=</span> <span style="color: #666666">0.4</span>
    <span style="color: #008000; font-weight: bold">for</span> ia <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(MaxVariations):
        alpha <span style="color: #666666">+=</span> <span style="color: #666666">.05</span>
        AlphaValues[ia] <span style="color: #666666">=</span> alpha
        energy <span style="color: #666666">=</span> energy2 <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
        <span style="color: #408080; font-style: italic">#Initial position</span>
        PositionOld <span style="color: #666666">=</span> StepSize <span style="color: #666666">*</span> (random() <span style="color: #666666">-</span> <span style="color: #666666">.5</span>)
        wfold <span style="color: #666666">=</span> WaveFunction(PositionOld,alpha)
        <span style="color: #408080; font-style: italic">#Loop over MC MCcycles</span>
        <span style="color: #008000; font-weight: bold">for</span> MCcycle <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(NumberMCcycles):
            <span style="color: #408080; font-style: italic">#Trial position </span>
            PositionNew <span style="color: #666666">=</span> PositionOld <span style="color: #666666">+</span> StepSize<span style="color: #666666">*</span>(random() <span style="color: #666666">-</span> <span style="color: #666666">.5</span>)
            wfnew <span style="color: #666666">=</span> WaveFunction(PositionNew,alpha)
            <span style="color: #408080; font-style: italic">#Metropolis test to see whether we accept the move</span>
            <span style="color: #008000; font-weight: bold">if</span> random() <span style="color: #666666">&lt;=</span> wfnew<span style="color: #666666">**2</span> <span style="color: #666666">/</span> wfold<span style="color: #666666">**2</span>:
                PositionOld <span style="color: #666666">=</span> PositionNew
                wfold <span style="color: #666666">=</span> wfnew
            DeltaE <span style="color: #666666">=</span> LocalEnergy(PositionOld,alpha)
            energy <span style="color: #666666">+=</span> DeltaE
            energy2 <span style="color: #666666">+=</span> DeltaE<span style="color: #666666">**2</span>
        <span style="color: #408080; font-style: italic">#We calculate mean, variance and error</span>
        energy <span style="color: #666666">/=</span> NumberMCcycles
        energy2 <span style="color: #666666">/=</span> NumberMCcycles
        variance <span style="color: #666666">=</span> energy2 <span style="color: #666666">-</span> energy<span style="color: #666666">**2</span>
        error <span style="color: #666666">=</span> sqrt(variance<span style="color: #666666">/</span>NumberMCcycles)
        Energies[ia] <span style="color: #666666">=</span> energy    
        Variances[ia] <span style="color: #666666">=</span> variance    
        outfile<span style="color: #666666">.</span>write(<span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121"> </span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span>(alpha,energy,variance,error))
    <span style="color: #008000; font-weight: bold">return</span> Energies, AlphaValues, Variances
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Finally, the results are presented here with the exact energies and variances as well.</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #408080; font-style: italic">#Here starts the main program with variable declarations</span>
MaxVariations <span style="color: #666666">=</span> <span style="color: #666666">20</span>
Energies <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((MaxVariations))
ExactEnergies <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((MaxVariations))
ExactVariance <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((MaxVariations))
Variances <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((MaxVariations))
AlphaValues <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(MaxVariations)
(Energies, AlphaValues, Variances) <span style="color: #666666">=</span> MonteCarloSampling()
outfile<span style="color: #666666">.</span>close()
ExactEnergies <span style="color: #666666">=</span> <span style="color: #666666">0.25*</span>(AlphaValues<span style="color: #666666">*</span>AlphaValues<span style="color: #666666">+1.0/</span>(AlphaValues<span style="color: #666666">*</span>AlphaValues))
ExactVariance <span style="color: #666666">=</span> <span style="color: #666666">0.25*</span>(<span style="color: #666666">1.0+</span>((<span style="color: #666666">1.0-</span>AlphaValues<span style="color: #666666">**4</span>)<span style="color: #666666">**2</span>)<span style="color: #666666">*3.0/</span>(<span style="color: #666666">4*</span>(AlphaValues<span style="color: #666666">**4</span>)))<span style="color: #666666">-</span>ExactEnergies<span style="color: #666666">*</span>ExactEnergies

<span style="color: #408080; font-style: italic">#simple subplot</span>
plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1</span>)
plt<span style="color: #666666">.</span>plot(AlphaValues, Energies, <span style="color: #BA2121">&#39;o-&#39;</span>,AlphaValues, ExactEnergies,<span style="color: #BA2121">&#39;r-&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&#39;Energy and variance&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;Dimensionless energy&#39;</span>)
plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>)
plt<span style="color: #666666">.</span>plot(AlphaValues, Variances, <span style="color: #BA2121">&#39;.-&#39;</span>,AlphaValues, ExactVariance,<span style="color: #BA2121">&#39;r-&#39;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">r&#39;$\alpha$&#39;</span>, fontsize<span style="color: #666666">=15</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;Variance&#39;</span>)
save_fig(<span style="color: #BA2121">&quot;VMCHarmonic&quot;</span>)
plt<span style="color: #666666">.</span>show()
<span style="color: #408080; font-style: italic">#nice printout with Pandas</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">import</span> DataFrame
data <span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;Alpha&#39;</span>:AlphaValues, <span style="color: #BA2121">&#39;Energy&#39;</span>:Energies,<span style="color: #BA2121">&#39;Exact Energy&#39;</span>:ExactEnergies,<span style="color: #BA2121">&#39;Variance&#39;</span>:Variances,<span style="color: #BA2121">&#39;Exact Variance&#39;</span>:ExactVariance,}
frame <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>DataFrame(data)
<span style="color: #008000">print</span>(frame)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>For \( \alpha=1 \) we have the exact eigenpairs, as can be deduced from the
table here. With \( \omega=1 \), the exact energy is \( 1/2 \) a.u. with zero
variance, as it should. We see also that our computed variance follows rather well the exact variance.
Increasing the number of Monte Carlo cycles will improve our statistics (try to increase the number of Monte Carlo cycles).
</p>

<p>The fact that the variance is exactly equal to zero when \( \alpha=1 \) is that 
we then have the exact wave function, and the action of the hamiltionan
on the wave function
</p>
$$
   H\psi = \mathrm{constant}\times \psi,
$$

<p>yields just a constant. The integral which defines various 
expectation values involving moments of the hamiltonian becomes then
</p>
$$
   \langle H^n \rangle =
   \frac{\int d\boldsymbol{R}\Psi^{\ast}_T(\boldsymbol{R})H^n(\boldsymbol{R})\Psi_T(\boldsymbol{R})}
        {\int d\boldsymbol{R}\Psi^{\ast}_T(\boldsymbol{R})\Psi_T(\boldsymbol{R})}=
\mathrm{constant}\times\frac{\int d\boldsymbol{R}\Psi^{\ast}_T(\boldsymbol{R})\Psi_T(\boldsymbol{R})}
        {\int d\boldsymbol{R}\Psi^{\ast}_T(\boldsymbol{R})\Psi_T(\boldsymbol{R})}=\mathrm{constant}.
$$

<b>This gives an important information: the exact wave function leads to zero variance!</b>
<p>As we will see later, many practitioners perform a minimization on both the energy and the variance.</p>

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._week1-bs035.html">&laquo;</a></li>
  <li><a href="._week1-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._week1-bs028.html">29</a></li>
  <li><a href="._week1-bs029.html">30</a></li>
  <li><a href="._week1-bs030.html">31</a></li>
  <li><a href="._week1-bs031.html">32</a></li>
  <li><a href="._week1-bs032.html">33</a></li>
  <li><a href="._week1-bs033.html">34</a></li>
  <li><a href="._week1-bs034.html">35</a></li>
  <li><a href="._week1-bs035.html">36</a></li>
  <li class="active"><a href="._week1-bs036.html">37</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>
</body>
</html>

