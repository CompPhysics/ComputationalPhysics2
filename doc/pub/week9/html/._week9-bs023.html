<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week9.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week9-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Week 11, March 11-15: Resampling Techniques, Bootstrap and Blocking">
<title>Week 11, March 11-15: Resampling Techniques, Bootstrap and Blocking</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week9.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week9-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Overview of week 11, March 11-15',
               2,
               None,
               'overview-of-week-11-march-11-15'),
              ('Why resampling methods ?', 2, None, 'why-resampling-methods'),
              ('Statistical analysis', 2, None, 'statistical-analysis'),
              ('Statistics, wrapping up from last week',
               2,
               None,
               'statistics-wrapping-up-from-last-week'),
              ('Statistics, final expression',
               2,
               None,
               'statistics-final-expression'),
              ('Statistics, effective number of correlations',
               2,
               None,
               'statistics-effective-number-of-correlations'),
              ('Can we understand this? Time Auto-correlation Function',
               2,
               None,
               'can-we-understand-this-time-auto-correlation-function'),
              ('Time Auto-correlation Function',
               2,
               None,
               'time-auto-correlation-function'),
              ('Time Auto-correlation Function',
               2,
               None,
               'time-auto-correlation-function'),
              ('Time Auto-correlation Function',
               2,
               None,
               'time-auto-correlation-function'),
              ('Time Auto-correlation Function',
               2,
               None,
               'time-auto-correlation-function'),
              ('Time Auto-correlation Function',
               2,
               None,
               'time-auto-correlation-function'),
              ('Correlation Time', 2, None, 'correlation-time'),
              ('Resampling methods: Jackknife and Bootstrap',
               2,
               None,
               'resampling-methods-jackknife-and-bootstrap'),
              ('Resampling methods: Jackknife',
               2,
               None,
               'resampling-methods-jackknife'),
              ('Resampling methods: Jackknife estimator',
               2,
               None,
               'resampling-methods-jackknife-estimator'),
              ('Jackknife code example', 2, None, 'jackknife-code-example'),
              ('Resampling methods: Bootstrap',
               2,
               None,
               'resampling-methods-bootstrap'),
              ('Resampling methods: Bootstrap background',
               2,
               None,
               'resampling-methods-bootstrap-background'),
              ('Resampling methods: More Bootstrap background',
               2,
               None,
               'resampling-methods-more-bootstrap-background'),
              ('Resampling methods: Bootstrap approach',
               2,
               None,
               'resampling-methods-bootstrap-approach'),
              ('Resampling methods: Bootstrap steps',
               2,
               None,
               'resampling-methods-bootstrap-steps'),
              ('Code example for the Bootstrap method',
               2,
               None,
               'code-example-for-the-bootstrap-method'),
              ('Resampling methods: Blocking',
               2,
               None,
               'resampling-methods-blocking'),
              ('Blocking Transformations', 2, None, 'blocking-transformations'),
              ('Blocking Transformations', 2, None, 'blocking-transformations'),
              ('Blocking Transformations, getting there',
               2,
               None,
               'blocking-transformations-getting-there'),
              ('Blocking Transformations, final expressions',
               2,
               None,
               'blocking-transformations-final-expressions'),
              ('How do we proceed?', 2, None, 'how-do-we-proceed'),
              ('Resampling analysis', 2, None, 'resampling-analysis')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week9-bs.html">Week 11, March 11-15: Resampling Techniques, Bootstrap and Blocking</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._week9-bs001.html#overview-of-week-11-march-11-15" style="font-size: 80%;">Overview of week 11, March 11-15</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs002.html#why-resampling-methods" style="font-size: 80%;">Why resampling methods ?</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs003.html#statistical-analysis" style="font-size: 80%;">Statistical analysis</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs004.html#statistics-wrapping-up-from-last-week" style="font-size: 80%;">Statistics, wrapping up from last week</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs005.html#statistics-final-expression" style="font-size: 80%;">Statistics, final expression</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs006.html#statistics-effective-number-of-correlations" style="font-size: 80%;">Statistics, effective number of correlations</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs007.html#can-we-understand-this-time-auto-correlation-function" style="font-size: 80%;">Can we understand this? Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs012.html#time-auto-correlation-function" style="font-size: 80%;">Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs012.html#time-auto-correlation-function" style="font-size: 80%;">Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs012.html#time-auto-correlation-function" style="font-size: 80%;">Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs012.html#time-auto-correlation-function" style="font-size: 80%;">Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs012.html#time-auto-correlation-function" style="font-size: 80%;">Time Auto-correlation Function</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs013.html#correlation-time" style="font-size: 80%;">Correlation Time</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs014.html#resampling-methods-jackknife-and-bootstrap" style="font-size: 80%;">Resampling methods: Jackknife and Bootstrap</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs015.html#resampling-methods-jackknife" style="font-size: 80%;">Resampling methods: Jackknife</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs016.html#resampling-methods-jackknife-estimator" style="font-size: 80%;">Resampling methods: Jackknife estimator</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs017.html#jackknife-code-example" style="font-size: 80%;">Jackknife code example</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs018.html#resampling-methods-bootstrap" style="font-size: 80%;">Resampling methods: Bootstrap</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs019.html#resampling-methods-bootstrap-background" style="font-size: 80%;">Resampling methods: Bootstrap background</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs020.html#resampling-methods-more-bootstrap-background" style="font-size: 80%;">Resampling methods: More Bootstrap background</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs021.html#resampling-methods-bootstrap-approach" style="font-size: 80%;">Resampling methods: Bootstrap approach</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs022.html#resampling-methods-bootstrap-steps" style="font-size: 80%;">Resampling methods: Bootstrap steps</a></li>
     <!-- navigation toc: --> <li><a href="#code-example-for-the-bootstrap-method" style="font-size: 80%;">Code example for the Bootstrap method</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs024.html#resampling-methods-blocking" style="font-size: 80%;">Resampling methods: Blocking</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs026.html#blocking-transformations" style="font-size: 80%;">Blocking Transformations</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs026.html#blocking-transformations" style="font-size: 80%;">Blocking Transformations</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs027.html#blocking-transformations-getting-there" style="font-size: 80%;">Blocking Transformations, getting there</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs028.html#blocking-transformations-final-expressions" style="font-size: 80%;">Blocking Transformations, final expressions</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs028.html#how-do-we-proceed" style="font-size: 80%;">How do we proceed?</a></li>
     <!-- navigation toc: --> <li><a href="._week9-bs028.html#resampling-analysis" style="font-size: 80%;">Resampling analysis</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0023"></a>
<!-- !split -->
<h2 id="code-example-for-the-bootstrap-method" class="anchor">Code example for the Bootstrap method </h2>

<p>The following code starts with a Gaussian distribution with mean value \( \mu =100 \) and variance \( \sigma=15 \). We use this to generate the data used in the bootstrap analysis. The bootstrap analysis returns a data set after a given number of bootstrap operations (as many as we have data points). This data set consists of estimated mean values for each bootstrap operation. The histogram generated by the bootstrap method shows that the distribution for these mean values is also a Gaussian, centered around the mean value \( \mu=100 \) but with standard deviation \( \sigma/\sqrt{n} \), where \( n \) is the number of bootstrap samples (in this case the same as the number of original data points). The value of the standard deviation is what we expect from the central limit theorem. </p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #666666">%</span>matplotlib inline

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy.random</span> <span style="color: #008000; font-weight: bold">import</span> randint, randn
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">time</span> <span style="color: #008000; font-weight: bold">import</span> time
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scipy.stats</span> <span style="color: #008000; font-weight: bold">import</span> norm
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>

<span style="color: #408080; font-style: italic"># Returns mean of bootstrap samples                                                                                                                                                </span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">stat</span>(data):
    <span style="color: #008000; font-weight: bold">return</span> mean(data)

<span style="color: #408080; font-style: italic"># Bootstrap algorithm                                                                                                                                                              </span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bootstrap</span>(data, statistic, R):
    t <span style="color: #666666">=</span> zeros(R); n <span style="color: #666666">=</span> <span style="color: #008000">len</span>(data); inds <span style="color: #666666">=</span> arange(n); t0 <span style="color: #666666">=</span> time()

    <span style="color: #408080; font-style: italic"># non-parametric bootstrap                                                                                                                                                     </span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(R):
        t[i] <span style="color: #666666">=</span> statistic(data[randint(<span style="color: #666666">0</span>,n,n)])

    <span style="color: #408080; font-style: italic"># analysis                                                                                                                                                                     </span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Runtime: </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121"> sec&quot;</span> <span style="color: #666666">%</span> (time()<span style="color: #666666">-</span>t0)); <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Bootstrap Statistics :&quot;</span>)
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;original           bias      std. error&quot;</span>)
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">%8g</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%8g</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%14g</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15g</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (statistic(data), std(data),\
                             mean(t), \
                             std(t)))
    <span style="color: #008000; font-weight: bold">return</span> t


mu, sigma <span style="color: #666666">=</span> <span style="color: #666666">100</span>, <span style="color: #666666">15</span>
datapoints <span style="color: #666666">=</span> <span style="color: #666666">10000</span>
x <span style="color: #666666">=</span> mu <span style="color: #666666">+</span> sigma<span style="color: #666666">*</span>random<span style="color: #666666">.</span>randn(datapoints)
<span style="color: #408080; font-style: italic"># bootstrap returns the data sample                                                                                                          t = bootstrap(x, stat, datapoints)</span>
<span style="color: #408080; font-style: italic"># the histogram of the bootstrapped  data  </span>
t <span style="color: #666666">=</span> bootstrap(x, stat, datapoints)
<span style="color: #408080; font-style: italic"># the histogram of the bootstrapped  data                                            </span>
n, binsboot, patches <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>hist(t, bins<span style="color: #666666">=50</span>, density<span style="color: #666666">=</span><span style="color: #BA2121">&#39;true&#39;</span>,histtype<span style="color: #666666">=</span><span style="color: #BA2121">&#39;bar&#39;</span>, color<span style="color: #666666">=</span><span style="color: #BA2121">&#39;red&#39;</span>, alpha<span style="color: #666666">=0.75</span>)

<span style="color: #408080; font-style: italic"># add a &#39;best fit&#39; line                                                                                                                                                          </span>
y <span style="color: #666666">=</span> norm<span style="color: #666666">.</span>pdf( binsboot, mean(t), std(t))
lt <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>plot(binsboot, y, <span style="color: #BA2121">&#39;r--&#39;</span>, linewidth<span style="color: #666666">=1</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;Smarts&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;Probability&#39;</span>)
plt<span style="color: #666666">.</span>axis([<span style="color: #666666">99.5</span>, <span style="color: #666666">100.6</span>, <span style="color: #666666">0</span>, <span style="color: #666666">3.0</span>])
plt<span style="color: #666666">.</span>grid(<span style="color: #008000; font-weight: bold">True</span>)

plt<span style="color: #666666">.</span>show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._week9-bs022.html">&laquo;</a></li>
  <li><a href="._week9-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._week9-bs015.html">16</a></li>
  <li><a href="._week9-bs016.html">17</a></li>
  <li><a href="._week9-bs017.html">18</a></li>
  <li><a href="._week9-bs018.html">19</a></li>
  <li><a href="._week9-bs019.html">20</a></li>
  <li><a href="._week9-bs020.html">21</a></li>
  <li><a href="._week9-bs021.html">22</a></li>
  <li><a href="._week9-bs022.html">23</a></li>
  <li class="active"><a href="._week9-bs023.html">24</a></li>
  <li><a href="._week9-bs024.html">25</a></li>
  <li><a href="._week9-bs025.html">26</a></li>
  <li><a href="._week9-bs026.html">27</a></li>
  <li><a href="._week9-bs027.html">28</a></li>
  <li><a href="._week9-bs028.html">29</a></li>
  <li><a href="._week9-bs024.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>
</body>
</html>

